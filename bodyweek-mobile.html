<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>BodyWeek - Трекер заботы о себе</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF7DC2',
                        accent: '#D14E9E',
                        background: '#FAFAFB',
                        text: '#1C1C1E',
                    },
                    fontFamily: {
                        'manrope': ['Manrope', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    
    <!-- Стильные шрифты -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0' stop-color='%23FF7DC2'/%3E%3Cstop offset='1' stop-color='%23D14E9E'/%3E%3C/linearGradient%3E%3C/defs%3E%3Ccircle cx='32' cy='32' r='28' fill='url(%23g)'/%3E%3C/svg%3E" />
    
    <style>
        body {
            font-family: 'Manrope', 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior: none;
            background: linear-gradient(135deg, #FAFAFB 0%, #F8F9FF 50%, #F0F4FF 100%);
            position: relative;
            z-index: 0;
        }
        
        .section {
            display: none;
            position: relative;
            z-index: 1;
        }
        
        .section.active {
            display: block;
        }
        
        /* Анимация появления секций */
        .section.active {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        /* Main контейнер */
        main {
            position: relative;
            z-index: 1;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* Анимация падающих сердечек */
        .heart {
            position: fixed;
            font-size: 2rem;
            pointer-events: none;
            z-index: 10000;
            transition: top 2s ease-in;
        }


        
        .day-card {
            background: linear-gradient(135deg, #FFFFFF 0%, #FEFEFE 100%);
            border-radius: 0.875rem;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.9);
            padding: 0.375rem;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(8px);
            position: relative;
            z-index: 1;
        }
        
        /* Убираем hover-анимацию у плашек дней */
        /* (hover эффекты отключены явно в HTML классах) */
        
        .btn-primary {
            background: linear-gradient(135deg, #E7B8D6 0%, #D86CB3 100%);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(216, 108, 179, 0.3);
            border: none;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(216, 108, 179, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #F8F9FA 0%, #F1F3F4 100%);
            color: #1C1C1E;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            border-radius: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #F1F3F4 0%, #E8EAED 100%);
            transform: translateY(-1px);
        }
        
        .chart-bar {
            background: linear-gradient(to top, #FF7DC2, #D14E9E);
            border-radius: 0.5rem 0.5rem 0 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(216, 108, 179, 0.2);
        }
        
        .chart-bar:hover {
            transform: scaleY(1.05);
            box-shadow: 0 4px 12px rgba(216, 108, 179, 0.3);
        }
        
        

        /* Навигация внизу */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            z-index: 50;
            padding: 0.5rem 0;
        }
        
        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem 0.75rem;
            border-radius: 0.75rem;
            transition: all 0.2s ease;
            cursor: pointer;
            min-width: 4rem;
        }
        
        .nav-btn.active {
            background: linear-gradient(135deg, #FF7DC2 0%, #D14E9E 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(216, 108, 179, 0.3);
        }
        
        .nav-btn.active span {
            color: white;
            font-weight: 600;
        }
        
        .nav-btn.active .nav-icon {
            background: linear-gradient(135deg, #FFFFFF 0%, #F8F9FF 100%);
            transform: scale(1.1);
        }
        
        .nav-btn:not(.active):hover {
            background: rgba(231, 184, 214, 0.1);
            transform: translateY(-1px);
        }
        
        .nav-icon {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.25rem;
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #FFFFFF 0%, #FFE6F2 100%);
            border: 1px solid #FAD3E6;
            box-shadow: 0 2px 6px rgba(209, 78, 158, 0.15);
            color: #D14E9E;
        }
        
        /* Мобильная оптимизация */
        @media (max-width: 640px) {
            .day-card {
                padding: 0.75rem;
            }
            
            .bottom-nav {
                padding-bottom: max(0.5rem, env(safe-area-inset-bottom));
            }
        }
        
        /* Безопасная зона для iPhone */
        @supports (padding: max(0px)) {
            .bottom-nav {
                padding-bottom: max(0.5rem, env(safe-area-inset-bottom));
            }
        }
        
        /* Компактные размеры для плашек */
        .activity-plate, .time-plate {
            min-height: 64px !important;
            height: auto !important;
        }
        
        .time-plate {
            min-width: 72px !important;
        }
        
        @media (min-width: 640px) {
            .activity-plate, .time-plate {
                min-height: 72px !important;
                height: auto !important;
            }
            
            .time-plate {
                min-width: 84px !important;
            }
        }

        /* Неделя: навигация стрелками и метка диапазона */
        .week-nav { display:flex; align-items:center; justify-content:center; gap:8px; }
        .week-btn { width:32px; height:32px; border-radius:999px; border:0; background:#fff; box-shadow:0 1px 4px rgba(0,0,0,.08); font-size:20px; line-height:32px; }
        .week-btn:active { transform:scale(.96); }
        .week-label { font-weight:700; font-size:22px; }

        /* Подсказка фазы: крупнее и кликабельная */
        .cycle-hint { display:flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; background:rgba(255,255,255,.7); cursor:pointer; justify-content:center; }
        .cycle-text { font-size:16px; font-weight:600; text-decoration:none; }
        .cycle-hint:hover .cycle-text { text-decoration:underline; }

        /* Больше внутренних отступов у плашки активностей */
        .activity-plate {
            padding: 0.75rem 1rem !important;
        }

        /* Активности: перенос по строкам внутри плашки */
        [id$="-activities"] {
            display: flex !important;
            flex-wrap: wrap !important;
            align-items: center !important;
            gap: 0.25rem 0.75rem !important;
        }
        .activity-item { white-space: nowrap !important; font-size: 0.875rem !important; }
        
        /* Позиционирование для выпадающих меню */
        .flex-1.relative {
            position: relative !important;
            z-index: 1 !important;
        }
        
        /* Подсказки автодополнения поверх всего */
        [id$="-suggestions"] {
            position: fixed !important;
            z-index: 100000 !important;
            background: #fff !important;
            border: 1px solid #E5E7EB !important;
            border-radius: 8px !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
            max-height: 280px !important;
            overflow-y: auto !important;
            transform: translateZ(0) !important;
            will-change: transform !important;
            isolation: isolate !important;
            padding: 4px 0 !important;
        }

        /* Портал для подсказок: рендерим в <body> поверх всех элементов */
        #activity-suggestions-portal {
            position: fixed !important;
            z-index: 100000 !important;
            background: #fff !important;
            border: 1px solid #E5E7EB !important;
            border-radius: 8px !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
            max-height: 280px !important;
            overflow-y: auto !important;
            padding: 4px 0 !important;
        }
        
        
        
        /* Footer и другие элементы не должны перекрывать меню */
        footer, .space-y-3 > div:last-child {
            position: relative;
            z-index: 1;
        }
        

        
        
        /* Компактные кнопки плюс/минус */
        button[onclick*="removeTime"], button[onclick*="addTime"] {
            width: 1.25rem !important;
            height: 1.25rem !important;
            border-radius: 50% !important;
            min-width: 1.25rem !important;
            min-height: 1.25rem !important;
            max-width: 1.25rem !important;
            max-height: 1.25rem !important;
        }
        
        @media (min-width: 640px) {
            button[onclick*="removeTime"], button[onclick*="addTime"] {
                width: 1.5rem !important;
                height: 1.5rem !important;
                min-width: 1.5rem !important;
                min-height: 1.5rem !important;
                max-width: 1.5rem !important;
                max-height: 1.5rem !important;
            }
        }
        
        
        
        /* Компактные заголовки дней */
            .day-card h3 {
                font-size: 1.5rem !important;
                line-height: 2rem !important;
        }
        
        @media (min-width: 640px) {
            .day-card h3 {
                font-size: 1.75rem !important;
                line-height: 2.25rem !important;
            }
        }
        
        
        
        /* Принудительно круглые кнопки */
        button[onclick*="removeTime"], button[onclick*="addTime"] {
            aspect-ratio: 1 / 1 !important;
            flex-shrink: 0 !important;
            flex-grow: 0 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }
        
        /* Убираем любые дополнительные стили, которые могут влиять на форму */
        button[onclick*="removeTime"] *, button[onclick*="addTime"] * {
            border-radius: 0 !important;
        }
        
        /* Стили для кнопок периода графика */
        .chart-period-btn {
            transition: all 0.2s ease;
        }
        
        .chart-period-btn.active {
            background: linear-gradient(135deg, #FF7DC2 0%, #D14E9E 100%);
            color: white;
            font-weight: 600;
        }

        /* ===== О ПРИЛОЖЕНИИ ===== */
        .about-hero {
            position: relative;
            background: linear-gradient(135deg, rgba(255,125,194,0.18), rgba(209,78,158,0.12));
            border-radius: 24px;
            overflow: hidden;
            padding-top: 40px !important;
            padding-bottom: 40px !important;
        }
        /* Убираем фон-арт-слово в hero */
        .about-hero::before { content: none !important; }
        /* Декоративные мягкие блобы в hero (без JS) */
        .about-blob { position:absolute; border-radius:9999px; filter: blur(30px); opacity:.5; pointer-events:none; }
        .about-blob-1 { width:240px; height:240px; top:-40px; left:-20px; background: radial-gradient(circle at 30% 30%, rgba(255,125,194,.45), rgba(209,78,158,.25)); }
        .about-blob-2 { width:280px; height:280px; right:-30px; bottom:-50px; background: radial-gradient(circle at 70% 50%, rgba(209,78,158,.35), rgba(255,125,194,.25)); }

        /* Карусель фактов: простой и надёжный scroll-snap */
        .about-carousel { display:flex; gap:12px; overflow-x:auto; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; padding:6px 2px; }
        .about-carousel::-webkit-scrollbar { display:none; }
        .about-carousel { scrollbar-width:none; }
        .about-science-item { flex:0 0 86%; scroll-snap-align:center; background:#fff; border:1px solid rgba(209,78,158,0.12); border-radius:20px; box-shadow:0 8px 18px rgba(0,0,0,0.08); padding:18px; font-size:15px; font-weight:600; line-height:1.35; }
        @media (min-width: 640px){ .about-science-item { flex-basis:70%; font-size:16px; } }

        /* Единый hover для принципов */
        .about-principle-card { background:#fff; border:1px solid rgba(209,78,158,0.12); box-shadow:0 6px 16px rgba(0,0,0,0.06); transition: transform .15s ease, box-shadow .15s ease; }
        .about-principle-card:hover { transform: translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,0.09); }
        .about-arrow {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #D14E9E;
            font-weight: 600;
            cursor: pointer;
        }
        .about-card {
            background: #fff;
            border: 1px solid rgba(209,78,158,0.12);
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.06);
            padding: 20px;
        }
        /* Заголовок раздела под hero */
        .about-caption { text-transform: uppercase; font-size: 12px; letter-spacing: .04em; color: #6B7280; }

        /* Принципы: квадратные карточки */
        .about-principle-card { aspect-ratio: 1 / 1; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; border-radius:20px; padding:16px; }

        /* Инфографика 3 шага */
        .about-steps { display: grid; grid-template-columns: 1fr; gap: 20px; }
        @media (min-width: 640px){ .about-steps { grid-template-columns: 1fr 1fr 1fr; } }
        .about-step { display:flex; align-items:center; gap:12px; background:#fff; border-radius:16px; border:1px solid rgba(209,78,158,0.12); box-shadow:0 6px 16px rgba(0,0,0,0.06); padding:16px; }
        .about-step-icon { width:40px; height:40px; border-radius:999px; display:flex; align-items:center; justify-content:center; background:rgba(255,125,194,0.18); color:#D14E9E; font-size:18px; font-weight:700; }
        .about-step-text { font-size:14px; line-height:1.35; font-weight:600; }

        /* Наука: одна карточка с кликом */
        .about-science-card { background:#fff; border:1px solid rgba(209,78,158,0.12); border-radius:20px; box-shadow:0 8px 18px rgba(0,0,0,0.08); padding:20px; cursor:pointer; transition:opacity 0.18s ease, transform 0.15s ease; display:flex; align-items:center; justify-content:center; text-align:center; font-size:16px; font-weight:600; min-height: 260px; aspect-ratio: 1 / 1; }
        .about-science-card:hover { transform: translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,0.09); }
        .about-science-card.fade { opacity:0.15; }

        /* Глобальная кнопка профиля (видна на всех экранах) */
        .profile-fab { position: fixed; top: 12px; right: 12px; z-index: 60; width: 40px; height: 40px; border-radius: 999px; display:flex; align-items:center; justify-content:center; background: linear-gradient(135deg, #FF7DC2, #D14E9E); color:#fff; box-shadow: 0 6px 16px rgba(209,78,158,0.35); }

        /* Объёмная круглая кнопка-сюрприз */
        .wish-btn {
            background: radial-gradient(120% 120% at 20% 20%, #FF7DC2 0%, #E15CA8 45%, #D14E9E 100%);
            box-shadow: 0 12px 24px rgba(209, 78, 158, 0.35), inset 0 2px 6px rgba(255,255,255,0.4);
            border: none;
        }

        /* Тост с пожеланием */
        .wish-toast {
            position: fixed;
            left: 50%;
            bottom: 20px;
            transform: translateX(-50%);
            z-index: 100000;
            background: rgba(255, 255, 255, 0.98);
            color: #1C1C1E;
            border: 1px solid #F3E0EE;
            border-radius: 14px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            padding: 10px 12px;
            max-width: min(92vw, 420px);
            font-size: 13px;
        }

        /* Крупный блок пожелания для скриншота */
        .wish-inline-card {
            background: #fff;
            color: #1C1C1E;
            border: 1px solid #F3E0EE;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.10);
            padding: 16px 18px;
            margin: 0 auto;
            max-width: 92%;
            font-size: 18px;
            line-height: 1.5;
            text-align: center;
        }
        @media (min-width: 640px) {
            .wish-inline-card {
                font-size: 20px;
                padding: 18px 22px;
                max-width: 560px;
            }
        }

        /* Design system tokens */
        :root { --radius-card:16px; --radius-button:16px; --icon-size:20px; --chip-padding:8px 12px; }
        .rounded-card { border-radius: var(--radius-card); }
        .rounded-button { border-radius: var(--radius-button); }
        .icon-md { width: var(--icon-size); height: var(--icon-size); }
        .chip { padding: var(--chip-padding); border-radius: 999px; border:1px solid #E5E7EB; background:#F9FAFB; font-size: 14px; line-height:1.2; }
        .chip.active { border-color: #FAD3E6; box-shadow: 0 2px 8px rgba(209, 78, 158, 0.15); background:#FFF; }
        .btn-primary { border-radius: var(--radius-button); }
        .about-card, .about-principle-card, .about-science-item { border-radius: var(--radius-card); }
        .nav-icon svg { width: var(--icon-size); height: var(--icon-size); }
        .nav-icon { color:#D14E9E; }
        .bottom-nav .nav-btn span { font-size: 12px; }
        /* Equal height for principle tiles */
        #about-facts .about-principle-card { min-height: 160px; }
        /* Carousel padding */
        .about-carousel { padding-left: 12px; padding-right: 12px; }
        #about-dots span { width:8px !important; height:8px !important; border-radius:999px; }
        /* Chart labels */
        #chart-container { padding-top: 6px; }
        /* Activity items wrap */
        [id$="-activities"] { overflow-x: visible !important; white-space: normal !important; }
        /* Larger touch targets for plus/minus */
        button[onclick*="removeTime"], button[onclick*="addTime"] { width: 40px !important; height: 40px !important; }
        /* FAB safe-area */
        .profile-fab { top: max(12px, env(safe-area-inset-top)); right: max(12px, env(safe-area-inset-right)); }
    </style>
</head>
<body class="bg-background text-text min-h-screen">


    <!-- Main Content -->
    <main class="pt-4 pb-20">
        <!-- Floating Profile Button visible everywhere -->
        <button id="profile-fab" class="profile-fab" aria-label="Профиль">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="#FFFFFF" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-3.31 0-8 1.66-8 5v1h16v-1c0-3.34-4.69-5-8-5z"/>
            </svg>
        </button>
        
        <!-- О приложении Section -->
        <section id="about-section" class="section p-3 sm:p-4 space-y-8">
            <!-- Hero -->
            <div class="about-hero p-6 sm:p-8 relative">
                <div class="about-blob about-blob-1"></div>
                <div class="about-blob about-blob-2"></div>
                <div class="max-w-xl mx-auto text-left">
                    <p class="text-2xl sm:text-3xl font-extrabold text-text leading-[1.35] mb-4">ты задумывалась, сколько часов уделяешь работе, а сколько своему телу?</p>
                    <p class="text-base sm:text-lg text-text leading-[1.35]">Планируй часы телесности, и наблюдай, сколько времени ты подарила себе</p>
                </div>
            </div>

            <!-- Факты -->
            <div class="max-w-xl mx-auto text-left">
                <h2 class="text-xl sm:text-2xl font-extrabold text-text mt-2">Меняем подход</h2>
            </div>
            
            <div id="about-facts" class="grid grid-cols-2 sm:grid-cols-2 gap-4">
                <div class="about-card about-principle-card">
                    <h3 class="font-semibold text-text mb-2 text-[18px]">Главное — двигаться</h3>
                    <p class="text-[14px] text-gray-700">Каждое действие важнее цифр. Даже 30 минут активности — это уже твои 30 минут.</p>
                </div>
                <div class="about-card about-principle-card">
                    <h3 class="font-semibold text-text mb-2 text-[18px]">Рост и спад — это нормально</h3>
                    <p class="text-[14px] text-gray-700">Ты не обязана расти по экспоненте. Главное — продолжать.</p>
                </div>
                <div class="about-card about-principle-card">
                    <h3 class="font-semibold text-text mb-2 text-[18px]">Цифры отвлекают</h3>
                    <p class="text-[14px] text-gray-700">Главное не цифры, а твоё самочувствие и устойчивость.</p>
                </div>
                <div class="about-card about-principle-card">
                    <h3 class="font-semibold text-text mb-2 text-[18px]">Фаза цикла — часть игры</h3>
                    <p class="text-[14px] text-gray-700">Используем ритм цикла, а не подчиняемся его правилам.</p>
                </div>
            </div>

            <!-- Что делать здесь -->
            

            <!-- Наука: простая карусель -->
            <div class="space-y-3">
                <h2 class="text-xl sm:text-2xl font-extrabold text-text mt-2">Что говорит наука?</h2>
                <div class="about-carousel" id="about-carousel">
                    <!-- items will be injected from aboutFacts on DOMContentLoaded -->
                </div>
                <div id="about-dots" class="flex justify-center gap-2 mt-1"></div>
            </div>

            <!-- Завершение -->
            <div class="text-center">
                <button id="about-cta" class="wish-btn inline-flex items-center justify-center rounded-full px-7 py-4 text-white font-bold text-base shadow-lg transition-all duration-150 active:scale-95">Спланировать первую неделю</button>
            </div>
        </section>
        <!-- Твоя неделя Section -->
        <section id="week-section" class="section active p-3 sm:p-4 space-y-3">
            <!-- Header -->
            <header class="text-center space-y-2 relative">
                <div class="week-nav">
                    <button class="week-btn prev" aria-label="Предыдущая неделя">‹</button>
                    <span id="weekLabel" class="week-label">19 – 25 авг</span>
                    <button class="week-btn next" aria-label="Следующая неделя">›</button>
                </div>
                
                
                <!-- Phase Hint -->
                <div id="cycleHint" class="cycle-hint">
                    <span class="cycle-emoji">🩸</span>
                    <span class="cycle-text">Забота. Отдых. Плавность</span>
                </div>
            </header>

            <!-- Day Cards -->
            <div class="space-y-2 sm:space-y-3">
                <!-- ПН -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <!-- Слева: День недели -->
                        <div class="flex-shrink-0">
                            <h3 class="text-xl sm:text-2xl font-bold text-text">ПН</h3>
                        </div>
                        
                        <!-- По центру: Плашка с активностями -->
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-1.5 sm:p-2 border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <!-- Плюс для добавления активности -->
                                    <button id="monday-plus-btn" onclick="toggleActivityInput('monday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">
                                        +
                                    </button>
                                    
                                    <!-- Выбранные активности -->
                                    <div id="monday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide">
                                        <!-- Активности будут добавляться сюда -->
                                    </div>
                                </div>
                                
                                <!-- Поле ввода с автодополнением -->
                                <div id="monday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="monday-activity-field" 
                                           placeholder="Начните писать активность..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('monday', this.value)"
                                           onkeydown="handleActivityKeydown('monday', event)">
                                    <div id="monday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- Подсказки будут добавляться динамически -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Справа: Плашка с временем -->
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="monday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">ч</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('monday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">
                                        −
                                    </button>
                                    <button onclick="addTime('monday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">
                                        +
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ВТ -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">ВТ</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="tuesday-plus-btn" onclick="toggleActivityInput('tuesday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">
                                        +
                                    </button>
                                    <div id="tuesday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- Поле ввода с автодополнением -->
                                <div id="tuesday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="tuesday-activity-field" 
                                           placeholder="Начните писать активность..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('tuesday', this.value)"
                                           onkeydown="handleActivityKeydown('tuesday', event)">
                                    <div id="tuesday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- Подсказки будут добавляться динамически -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="tuesday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">ч</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('tuesday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">−</button>
                                    <button onclick="addTime('tuesday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- СР -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">СР</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="wednesday-plus-btn" onclick="toggleActivityInput('wednesday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="wednesday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- Поле ввода с автодополнением -->
                                <div id="wednesday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="wednesday-activity-field" 
                                           placeholder="Начните писать активность..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('wednesday', this.value)"
                                           onkeydown="handleActivityKeydown('wednesday', event)">
                                    <div id="wednesday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- Подсказки будут добавляться динамически -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="wednesday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">ч</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('wednesday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">−</button>
                                    <button onclick="addTime('wednesday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ЧТ -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">ЧТ</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="thursday-plus-btn" onclick="toggleActivityInput('thursday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="thursday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- Поле ввода с автодополнением -->
                                <div id="thursday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="thursday-activity-field" 
                                           placeholder="Начните писать активность..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('thursday', this.value)"
                                           onkeydown="handleActivityKeydown('thursday', event)">
                                    <div id="thursday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- Подсказки будут добавляться динамически -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="thursday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">ч</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('thursday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">−</button>
                                    <button onclick="addTime('thursday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ПТ -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">ПТ</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="friday-plus-btn" onclick="toggleActivityInput('friday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="friday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- Поле ввода с автодополнением -->
                                <div id="friday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="friday-activity-field" 
                                           placeholder="Начните писать активность..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('friday', this.value)"
                                           onkeydown="handleActivityKeydown('friday', event)">
                                    <div id="friday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- Подсказки будут добавляться динамически -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="friday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">ч</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('friday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">−</button>
                                    <button onclick="addTime('friday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- СБ -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">СБ</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="saturday-plus-btn" onclick="toggleActivityInput('saturday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="saturday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- Поле ввода с автодополнением -->
                                <div id="saturday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="saturday-activity-field" 
                                           placeholder="Начните писать активность..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('saturday', this.value)"
                                           onkeydown="handleActivityKeydown('saturday', event)">
                                    <div id="saturday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- Подсказки будут добавляться динамически -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="saturday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">ч</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('saturday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">−</button>
                                    <button onclick="addTime('saturday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ВС -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">ВС</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="sunday-plus-btn" onclick="toggleActivityInput('sunday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="sunday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- Поле ввода с автодополнением -->
                                <div id="sunday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="sunday-activity-field" 
                                           placeholder="Начните писать активность..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('sunday', this.value)"
                                           onkeydown="handleActivityKeydown('sunday', event)">
                                    <div id="sunday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- Подсказки будут добавляться динамически -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="sunday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">ч</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('sunday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">−</button>
                                    <button onclick="addTime('sunday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="space-y-3">
                            <!-- Итого -->
                            <div class="bg-gradient-to-r from-pink-50 to-purple-50 rounded-2xl shadow-lg border border-pink-100 p-4 text-center">
                <h3 class="text-xl font-bold text-accent" id="total-display">
                    Итого: 0 ч для себя!
                </h3>
            </div>

                <!-- Настроение -->
                <div class="bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-lg border border-blue-100 p-4">
                    <h3 class="text-lg font-semibold text-text mb-3 text-center">Как ты сегодня?</h3>
                    <div class="flex justify-center space-x-3">
                        <button onclick="startTodayFlow('excellent', event)" class="flex-1 chip">
                            😀 Отлично
                        </button>
                        <button onclick="startTodayFlow('ok', event)" class="flex-1 chip">
                            🙂 Нормально
                        </button>
                        <button onclick="startTodayFlow('bad', event)" class="flex-1 chip">
                            🙁 Не очень
                        </button>
                    </div>
                    <div id="today-questions" class="mt-4 hidden"></div>
                    <div id="today-reco" class="mt-3 hidden"></div>
                </div>


            </div>
        </section>

        <!-- Цикл Section -->
        <section id="cycle-section" class="section p-3 sm:p-4 space-y-4">
            <header class="text-center space-y-2">
                <h1 class="text-xl sm:text-2xl font-bold text-text">Цикл</h1>
            </header>
            <div class="bg-gradient-to-br from-white to-pink-50 rounded-2xl p-6 border border-pink-100 shadow-lg max-w-xl mx-auto space-y-5">
                <div class="text-left space-y-1">
                    <div class="text-sm uppercase tracking-wide text-gray-500">твоя фаза цикла</div>
                    <div id="cycle-phase-name" class="text-2xl font-extrabold text-accent">–</div>
                    <div id="cycle-phase-key" class="text-base font-semibold text-text">Перейди в Профиль и заполни информацию о себе, чтобы видеть свою фазу цикла.</div>
                </div>
                <div class="text-left space-y-3">
                    <h3 class="text-lg font-bold text-text">Что происходит в теле?</h3>
                    <div id="cycle-body" class="text-sm text-gray-800 leading-relaxed">–</div>
                </div>
                <div class="text-left space-y-3">
                    <h3 class="text-lg font-bold text-text">Как это влияет на тебя?</h3>
                    <div id="cycle-impact" class="text-sm text-gray-800 leading-relaxed">–</div>
                </div>
                <div class="text-left space-y-3">
                    <h3 class="text-lg font-bold text-text">Что с этим делать</h3>
                    <div id="cycle-actions" class="grid grid-cols-2 gap-2"></div>
                </div>
            </div>
        </section>

        <!-- Трекер заботы Section -->
        <section id="tracker-section" class="section p-3 sm:p-4 space-y-4">
            <!-- Header -->
            <header class="text-center space-y-3 mt-2">
                <h1 class="text-2xl sm:text-3xl font-extrabold text-text leading-tight">
                    Сколько времени ты<br>подарила себе
                </h1>
            </header>

            <!-- Stats Cards -->
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-gradient-to-br from-pink-50 to-rose-50 rounded-2xl shadow-lg border border-pink-100 p-5 text-center">
                    <h3 class="text-sm text-gray-600 mb-2 font-medium">На этой неделе для себя</h3>
                    <p class="text-3xl font-bold text-accent" id="current-week-hours">0 ч</p>
                </div>
                <div class="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-2xl shadow-lg border border-purple-100 p-5 text-center">
                    <h3 class="text-sm text-gray-600 mb-2 font-medium">За все время</h3>
                    <p class="text-3xl font-bold text-accent" id="total-hours">0 ч</p>
                </div>
            </div>

            <!-- Toggle Buttons -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-3">
                <div class="flex bg-gray-100 rounded-lg p-1">
                    <button onclick="setChartPeriod('weeks', event)" class="flex-1 py-2 px-3 text-sm font-medium rounded-md transition-colors chart-period-btn active" data-period="weeks">
                        Недели
                    </button>
                    <button onclick="setChartPeriod('months', event)" class="flex-1 py-2 px-3 text-sm font-medium rounded-md transition-colors chart-period-btn" data-period="months">
                        Месяцы
                    </button>
                </div>
            </div>

            <!-- Chart -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-4">
                <div id="chart-container" class="flex items-end justify-between space-x-1 h-36">
                    <!-- График будет генерироваться динамически -->
                </div>
            </div>

            <!-- Bonus Card -->
            <div class="bg-gradient-to-br from-pink-100 via-purple-50 to-blue-100 rounded-2xl p-6 border border-pink-200 shadow-xl">
                <div class="text-center space-y-4">
                    <div id="wish-inline-container">
                        <button id="wish-button" onclick="showInlineWish()" class="wish-btn inline-flex items-center justify-center rounded-full w-36 h-36 text-white font-bold text-base shadow-lg transition-all duration-150 active:scale-95">
                             Ткни на меня
                         </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Профиль Section -->
        <section id="profile-section" class="section p-3 sm:p-4 space-y-4">
            <!-- Header -->
            <header class="text-center space-y-3">
                <h1 class="text-xl sm:text-2xl font-bold text-text">
                    Профиль
                </h1>
            </header>

            <!-- Profile Form -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-4 space-y-3">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Как тебя зовут?</label>
                        <input type="text" id="profile-name" placeholder="Введите ваше имя" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Обычно сколько дней длится менструация?</label>
                        <input type="number" id="m-length" placeholder="5" min="3" max="7" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Когда начались твои последние месячные?</label>
                        <input type="date" id="cycle-start" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">В среднем твой цикл длится … дней</label>
                        <input type="number" id="cycle-length" placeholder="28" min="21" max="35" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                </div>
                <div class="flex space-x-3 mb-2">
                    <button id="save-profile-btn" onclick="saveProfile()" class="flex-1 btn-primary py-3">Готово</button>
                    <button id="edit-profile-btn" onclick="editProfile()" class="flex-1 bg-gray-300 text-gray-600 font-medium py-3 px-4 rounded-[16px] transition-colors" disabled>Поправить</button>
                </div>
            </div>

            <!-- Email Auth -->
            <div class="hidden bg-gradient-to-br from-pink-50 to-rose-50 rounded-2xl shadow-sm border border-pink-100 p-6 max-w-xl mx-auto space-y-3">
                <h2 class="text-lg font-bold text-text">Вход по почте</h2>
                <p class="text-sm text-gray-600">Мы отправим код на твою почту</p>
                <input id="auth-email" type="email" placeholder="you@example.com" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm" />
                <p class="text-xs text-gray-600 mt-1">Продолжая, вы соглашаетесь с нашей <button type="button" class="underline text-accent" onclick="openPrivacy()">Политикой конфиденциальности</button></p>
                <div class="grid grid-cols-6 gap-2">
                    <input id="code-1" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-2" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-3" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-4" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-5" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-6" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="requestLoginCode()" class="w-full btn-primary py-3">Получить код</button>
                    <button onclick="confirmLoginCode()" class="w-full bg-gray-900 text-white py-3 rounded-[16px]">Войти</button>
                </div>
                <button onclick="logout()" id="logout-btn" class="hidden w-full bg-gray-200 text-text py-2 rounded-[16px]">Выйти</button>
                <p id="auth-status" class="text-center text-sm text-gray-600"></p>
            </div>

            <!-- Phase info удалён из профиля: фаза показывается только на вкладке "Цикл" -->

            <!-- Profile Actions moved above -->
        </section>
    </main>

    <nav class="bottom-nav">
        <div class="flex justify-around items-center max-w-md mx-auto">
            <button onclick="showSection('week')" class="nav-btn active">
                <div class="nav-icon">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M5 3a2 2 0 00-2 2v3h18V5a2 2 0 00-2-2h-1v1a1 1 0 11-2 0V3H8v1a1 1 0 11-2 0V3H5zm16 8H3v7a3 3 0 003 3h12a3 3 0 003-3v-7z"/></svg>
                </div>
                <span class="text-xs text-gray-600">Неделя</span>
            </button>
            <button onclick="showSection('cycle')" class="nav-btn">
                <div class="nav-icon">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2.5C8 7 6 9.5 6 12.5 6 16.64 9.36 20 13.5 20S21 16.64 21 12.5C21 9.5 19 7 12 2.5z"/></svg>
                </div>
                <span class="text-xs text-gray-600">Цикл</span>
            </button>
            <button onclick="showSection('tracker')" class="nav-btn">
                <div class="nav-icon">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><rect x="5" y="11" width="3" height="8" rx="1"/><rect x="10.5" y="8" width="3" height="11" rx="1"/><rect x="16" y="5" width="3" height="14" rx="1"/></svg>
                </div>
                <span class="text-xs text-gray-600">Трекер</span>
            </button>
            <button onclick="showSection('about')" class="nav-btn">
                <div class="nav-icon">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6.01 4.01 4 6.5 4c1.74 0 3.41 1.01 4.13 2.44C11.09 5.01 12.76 4 14.5 4 16.99 4 19 6.01 19 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                </div>
                <span class="text-xs text-gray-600">Миссия</span>
            </button>
        </div>
    </nav>

    <script>
        // ===== НАВИГАЦИЯ =====
        

        // ===== ДАННЫЕ =====
        const SESS_KEY = 'bodyweek-sessions';
        const AUTH_KEY = 'bodyweek-auth';
        let currentPeriod = 'weeks';
        const dayTimes = {
            monday: 0,
            tuesday: 0,
            wednesday: 0,
            thursday: 0,
            friday: 0,
            saturday: 0,
            sunday: 0
        };

        const dayActivities = {
            monday: [],
            tuesday: [],
            wednesday: [],
            thursday: [],
            friday: [],
            saturday: [],
            sunday: []
        };
        const dayOrder = ['monday','tuesday','wednesday','thursday','friday','saturday','sunday'];

        // ===== СОХРАНЕНИЕ ДАННЫХ =====
        function saveData() {
            localStorage.setItem('bodyweek-dayTimes', JSON.stringify(dayTimes));
            localStorage.setItem('bodyweek-dayActivities', JSON.stringify(dayActivities));
            // Синхронизировать текущую неделю в sessions как единственный источник правды
            try {
                const monday = getMondayOfWeek(new Date(currentWeekStart));
                monday.setHours(0,0,0,0);
                const sunday = new Date(monday);
                sunday.setDate(monday.getDate() + 6);
                const from = toYMD(monday);
                const to = toYMD(sunday);
                const existing = getSessions();
                // Удаляем записи за эту неделю
                const kept = existing.filter(s => s.date < from || s.date > to);
                // Добавляем по одному агрегату на день, если минуты > 0
                const dayOrder = ['monday','tuesday','wednesday','thursday','friday','saturday','sunday'];
                dayOrder.forEach((key, idx) => {
                    const minutes = Number(dayTimes[key] || 0);
                    if (minutes > 0) {
                        const d = new Date(monday);
                        d.setDate(monday.getDate() + idx);
                        kept.push({ date: toYMD(d), minutes });
                    }
                });
                localStorage.setItem(SESS_KEY, JSON.stringify(kept));
                // Сохранить активности, привязанные к конкретной дате недели
                const actMap = getActivitiesMap();
                dayOrder.forEach((key, idx) => {
                    const d = new Date(monday);
                    d.setDate(monday.getDate() + idx);
                    const dateKey = toYMD(d);
                    actMap[dateKey] = Array.isArray(dayActivities[key]) ? [...dayActivities[key]] : [];
                });
                localStorage.setItem(ACTIVITIES_KEY, JSON.stringify(actMap));
            } catch (e) {
                console.error('Failed updating sessions', e);
            }
            // Обновить карточки и график
            refreshTrackerUI();
        }

        function loadData() {
            const savedTimes = localStorage.getItem('bodyweek-dayTimes');
            const savedActivities = localStorage.getItem('bodyweek-dayActivities');
            
            if (savedTimes) {
                Object.assign(dayTimes, JSON.parse(savedTimes));
            }
            
            if (savedActivities) {
                Object.assign(dayActivities, JSON.parse(savedActivities));
            }
            
             // Подтянуть фактические минуты этой недели из sessions
             loadWeekFromSessions();
            // Обновляем отображение для всех дней
            Object.keys(dayTimes).forEach(day => {
                updateDayDisplay(day);
                updateActivitiesDisplay(day);
            });
            updateTotal();
            updateTrackerStats();
        }

        // ===== ФУНКЦИИ ВРЕМЕНИ =====
        function addTime(day) {
            dayTimes[day] += 30;
            updateDayDisplay(day);
            updateTotal();
            updateTrackerStats();
            saveData(); // Автоматически сохраняем данные
        }

        function removeTime(day) {
            if (dayTimes[day] >= 30) {
                dayTimes[day] -= 30;
                updateDayDisplay(day);
                updateTotal();
                updateTrackerStats();
                saveData(); // Автоматически сохраняем данные
            }
        }

        function updateDayDisplay(day) {
            const timeElement = document.getElementById(`${day}-time`);
            const hours = dayTimes[day] / 60;
            timeElement.textContent = formatHours(hours);
        }

        // ===== ФУНКЦИИ АКТИВНОСТЕЙ =====
        // Список всех доступных активностей
        const allActivities = [
            '🧘‍♀️ Пилатес',
            '🧘‍♂️ Йога',
            '💃 Барре',
            '💃 Танцы',
            '👟 Шаги 10k',
            '🧘 Медитация',
            '💪 Силовая',
            '😴 Отдых',
            '🏃‍♀️ Бег',
            '❤️ Кардио'
        ];
        
        // Инициализация портала для подсказок один раз
        let suggestionsPortal = document.getElementById('activity-suggestions-portal');
        if (!suggestionsPortal) {
            suggestionsPortal = document.createElement('div');
            suggestionsPortal.id = 'activity-suggestions-portal';
            suggestionsPortal.classList.add('hidden');
            document.body.appendChild(suggestionsPortal);
        }
        
        function toggleActivityInput(day) {
            const inputContainer = document.getElementById(`${day}-activity-input`);
            const allInputs = document.querySelectorAll('[id$="-activity-input"]');
            
            // Закрыть все другие поля ввода
            allInputs.forEach(input => {
                if (input !== inputContainer) {
                    input.classList.add('hidden');
                }
            });
            
            // Переключить текущее поле ввода
            if (inputContainer.classList.contains('hidden')) {
                inputContainer.classList.remove('hidden');
                const inputField = document.getElementById(`${day}-activity-field`);
                inputField.focus();
                inputField.value = '';
                // Показать выпадающий список всех активностей как меню по умолчанию
                filterActivities(day, '');
            } else {
                inputContainer.classList.add('hidden');
                // Прячем портал с подсказками
                const portal = document.getElementById('activity-suggestions-portal');
                if (portal) portal.classList.add('hidden');
            }
        }
        
        function filterActivities(day, query) {
            const portal = document.getElementById('activity-suggestions-portal');
            const button = document.getElementById(`${day}-plus-btn`);
            const rect = button.getBoundingClientRect();
            
            const filteredActivities = query && query.length > 0
                ? allActivities.filter(activity => activity.toLowerCase().includes(query.toLowerCase()))
                : allActivities.slice();
            
            // Позиционируем подсказки-портал относительно кнопки
            const desiredWidth = Math.min(420, Math.max(320, window.innerWidth - 24));
            const left = Math.max(12, Math.min(rect.left, window.innerWidth - desiredWidth - 12));
            portal.style.top = (rect.bottom + 10) + 'px';
            portal.style.left = left + 'px';
            portal.style.width = desiredWidth + 'px';
            portal.style.zIndex = '100000';
            
            if (filteredActivities.length > 0) {
                const itemsHtml = filteredActivities.map(activity => 
                    `<button type=\"button\" class=\"text-left w-full px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm\" 
                          onclick=\"selectActivity('${day}', '${activity}')\">${activity}</button>`
                ).join('');
                const manualHtml = `
                    <div class=\"col-span-2 flex items-center gap-2 px-2 py-2 border-t border-gray-100\">
                        <input id=\"custom-activity-${day}\" type=\"text\" maxlength=\"12\" placeholder=\"Моя активность\" 
                               class=\"flex-1 px-2 py-1 border border-gray-300 rounded text-sm\" 
                               onkeydown=\"if(event.key==='Enter'){addCustomTypedActivity('${day}')}\" />
                        <button type=\"button\" class=\"px-3 py-1 text-sm bg-pink-100 text-pink-800 rounded\" onclick=\"addCustomTypedActivity('${day}')\">Добавить</button>
                    </div>`;
                portal.innerHTML = `<div class=\"grid grid-cols-2 gap-1 p-1\">${itemsHtml}${manualHtml}</div>`;
                portal.classList.remove('hidden');
            } else {
                portal.innerHTML = '';
                portal.classList.add('hidden');
            }
        }
        
        function handleActivityKeydown(day, event) {
            if (event.key === 'Enter') {
                const inputField = document.getElementById(`${day}-activity-field`);
                const value = inputField.value.trim();
                
                if (value) {
                    // Добавить как кастомную активность
                    selectActivity(day, value);
                }
            } else if (event.key === 'Escape') {
                toggleActivityInput(day);
            }
        }

        function selectActivity(day, activity) {
            if (dayActivities[day].length >= 3) {
                alert('Максимум 3 активности на день!');
                return;
            }
            
            dayActivities[day].push(activity);
            
            // Закрываем поле ввода и подсказки
            const inputContainer = document.getElementById(`${day}-activity-input`);
            const portal = document.getElementById('activity-suggestions-portal');
            inputContainer.classList.add('hidden');
            portal.classList.add('hidden');
            
            updateActivitiesDisplay(day);
            
            // Автоматически добавляем 1 час, если активность не "Отдых"
            if (activity !== '😴 Отдых') {
                addTime(day);
                addTime(day); // Добавляем еще 30 минут для полного часа
            }
            // Сохранить выбранные активности сразу
            saveData();
        }

        // Добавление своей активности из поля в портале
        function addCustomTypedActivity(day) {
            const input = document.getElementById(`custom-activity-${day}`);
            if (!input) return;
            const value = (input.value || '').trim().slice(0, 12);
            if (!value) return;
            selectActivity(day, value);
        }

        function updateActivitiesDisplay(day) {
            const activitiesContainer = document.getElementById(`${day}-activities`);
            const activities = dayActivities[day];
            
            if (activities.length === 0) {
                activitiesContainer.innerHTML = '';
                return;
            }
            
            let html = '';
            activities.forEach((activity, index) => {
                html += `
                    <span class="activity-item inline-flex items-center text-sm font-medium text-text mr-3">
                        <span class="truncate max-w-[7rem] sm:max-w-[10rem]">${activity}</span>
                        <button onclick=\"removeActivity('${day}', ${index})\" class="ml-1 text-red-500 hover:text-red-700 font-bold text-base leading-none">×</button>
                    </span>
                `;
            });
            
            activitiesContainer.innerHTML = html;
        }

        function removeActivity(day, index) {
            const removedActivity = dayActivities[day][index];
            dayActivities[day].splice(index, 1);
            
            updateActivitiesDisplay(day);
            
            // Уменьшаем время на 30 минут, но не ниже 0
            dayTimes[day] = Math.max(0, dayTimes[day] - 30);
                updateDayDisplay(day);
                updateTotal();
                updateTrackerStats();
            
            saveData();
        }

        // ===== ПОЛЬЗОВАТЕЛЬСКИЕ АКТИВНОСТИ =====
        function showCustomActivityInput(day) {
            const menu = document.getElementById(`${day}-activity-menu`);
            menu.classList.add('hidden');
            
            const modal = document.createElement('div');
            modal.id = 'custom-activity-modal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4">
                    <h3 class="text-lg font-semibold text-text mb-4">Добавить свою активность</h3>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Выберите эмодзи:</label>
                        <div class="grid grid-cols-6 gap-2 mb-3">
                            <button onclick="selectEmoji('🏊‍♀️')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🏊‍♀️</button>
                            <button onclick="selectEmoji('🚴‍♀️')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🚴‍♀️</button>
                            <button onclick="selectEmoji('🎾')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🎾</button>
                            <button onclick="selectEmoji('🏋️‍♀️')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🏋️‍♀️</button>
                            <button onclick="selectEmoji('🧗‍♀️')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🧗‍♀️</button>
                            <button onclick="selectEmoji('🎯')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🎯</button>
                            <button onclick="selectEmoji('🎨')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🎨</button>
                            <button onclick="selectEmoji('📚')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">📚</button>
                            <button onclick="selectEmoji('🎵')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🎵</button>
                            <button onclick="selectEmoji('🌿')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">🌿</button>
                            <button onclick="selectEmoji('☕')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">☕</button>
                            <button onclick="selectEmoji('✨')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">✨</button>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span id="selected-emoji" class="text-2xl">🏊‍♀️</span>
                            <input type="text" id="custom-activity-text" placeholder="Введите название активности" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="addCustomActivity('${day}')" class="flex-1 bg-primary hover:bg-accent text-white font-medium py-2 px-4 rounded-lg transition-colors">
                            Добавить
                        </button>
                        <button onclick="closeCustomActivityModal()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-text font-medium py-2 px-4 rounded-lg transition-colors">
                            Отмена
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            setTimeout(() => {
                document.getElementById('custom-activity-text').focus();
            }, 100);
        }

        function selectEmoji(emoji) {
            document.getElementById('selected-emoji').textContent = emoji;
        }

        function addCustomActivity(day) {
            const emoji = document.getElementById('selected-emoji').textContent;
            const text = document.getElementById('custom-activity-text').value.trim();
            
            if (!text) {
                alert('Пожалуйста, введите название активности!');
                return;
            }
            
            if (dayActivities[day].length >= 2) {
                alert('Максимум 2 активности на день!');
                return;
            }
            
            const customActivity = `${emoji} ${text}`;
            dayActivities[day].push(customActivity);
            
            closeCustomActivityModal();
            updateActivitiesDisplay(day);
        }

        function closeCustomActivityModal() {
            const modal = document.getElementById('custom-activity-modal');
            if (modal) {
                modal.remove();
            }
        }

        // ===== ОБЩИЕ ФУНКЦИИ =====
        function updateTotal() {
            const totalMinutes = Object.values(dayTimes).reduce((sum, time) => sum + time, 0);
            const totalHours = totalMinutes / 60;
            
            const totalElement = document.getElementById('total-display');
            if (totalElement) {
                totalElement.textContent = `Итого: ${formatHours(totalHours)} ч для себя!`;
            }
        }

        function updateTrackerStats() {
            const { series } = aggregateWeeks(1);
            const weekHours = series[0] || 0;
            const totalHours = Math.round((getSessions().reduce((a,s)=>a + (Number(s.minutes)||0),0)/60)*10)/10;
            document.getElementById('current-week-hours').textContent = `${formatHours(weekHours)} ч`;
            document.getElementById('total-hours').textContent = `${formatHours(totalHours)} ч`;
        }

        // ===== НАСТРОЕНИЕ =====
        function setMood(mood, event) {
            const moodButtons = document.querySelectorAll('button[onclick^="setMood"]');
            moodButtons.forEach(btn => {
                btn.classList.remove('ring-2', 'ring-accent');
            });
            if (event && event.target) {
            event.target.classList.add('ring-2', 'ring-accent');
            }
            localStorage.setItem('currentMood', mood);
        }

        // ===== ТРЕКЕР =====
        function setChartPeriod(period, event) {
            document.querySelectorAll('.chart-period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (event && event.target) { event.target.classList.add('active'); }
            currentPeriod = period;
            
            // Обновить график в зависимости от периода
            updateChart(period);
        }
        
        // Обновить график (с подписями значений и оси X, и подписью диапазона)
        function updateChart(period) {
            const container = document.getElementById('chart-container');
            const agg = (period === 'weeks') ? aggregateWeeks(4) : aggregateMonths(6);
            let { labels, series, rangeLabel } = agg;
            if (!series || series.length === 0) { labels = ['']; series = [0]; }
            const maxVal = Math.max(...series, 1);
            const html = series.map((val, idx) => {
                const heightPct = Math.max(5, Math.round((val / maxVal) * 100));
                const valueLabel = `${formatHours(val)} ч`;
                const xLabel = labels[idx] || '';
                return `
                    <div class=\"flex-1 flex flex-col items-center justify-end space-y-1 h-full\">
                        <div class=\"text-xs text-gray-600 h-4\">${valueLabel}</div>
                        <div class=\"chart-bar w-full rounded-t\" style=\"height: ${heightPct}%; min-height: 8px;\"></div>
                        <div class=\"text-xs text-gray-500 text-center leading-tight mt-1\">${xLabel}</div>
                    </div>
                `;
            }).join('');
            container.innerHTML = html;
        }

        // ===== УТИЛИТЫ СЕССИЙ =====
        function getSessions() {
            try { return JSON.parse(localStorage.getItem(SESS_KEY)) || []; }
            catch { return []; }
        }
        function addSession({ minutes, date = new Date() }) {
            const d = toYMD(date);
            const arr = getSessions();
            arr.push({ date: d, minutes: Number(minutes) || 0 });
            localStorage.setItem(SESS_KEY, JSON.stringify(arr));
        }
        function toYMD(d) {
            const dt = new Date(d);
            dt.setHours(0,0,0,0);
            const y = dt.getFullYear();
            const m = String(dt.getMonth()+1).padStart(2,'0');
            const day = String(dt.getDate()).padStart(2,'0');
            return `${y}-${m}-${day}`;
        }
        function startOfWeek(d) {
            const dt = new Date(d); dt.setHours(0,0,0,0);
            const day = (dt.getDay() + 6) % 7; // 0 = понедельник
            dt.setDate(dt.getDate() - day);
            return dt;
        }
        function formatRange(a,b) {
            const fmt = (x) => x.toLocaleDateString('ru-RU', { day:'2-digit', month:'short'}).replace('.', '');
            return `${fmt(a)} – ${fmt(b)}`;
        }
        function aggregateWeeks(n=4) {
            const sessions = getSessions();
            const today = new Date(); today.setHours(0,0,0,0);
            const end = startOfWeek(today);
            const weeks = [];
            for (let i=n-1;i>=0;i--) {
                const wStart = new Date(end); wStart.setDate(end.getDate() - i*7);
                const wEnd = new Date(wStart); wEnd.setDate(wStart.getDate()+6);
                const keyStart = toYMD(wStart), keyEnd = toYMD(wEnd);
                const sumMin = sessions
                    .filter(s => s.date >= keyStart && s.date <= keyEnd)
                    .reduce((acc,s)=>acc + (Number(s.minutes)||0), 0);
                weeks.push({ label: formatRange(wStart,wEnd), hours: Math.round((sumMin/60)*2)/2 });
            }
            const labels = weeks.map(w=>w.label);
            const series = weeks.map(w=>w.hours);
            const rangeLabel = `Показаны: ${labels[0]} — ${labels[labels.length-1]}`;
            return { labels, series, rangeLabel };
        }
        function aggregateMonths(n=6) {
            const sessions = getSessions();
            const now = new Date(); now.setHours(0,0,0,0);
            const months = [];
            for (let i=n-1;i>=0;i--) {
                const d = new Date(now.getFullYear(), now.getMonth()-i, 1);
                const start = new Date(d.getFullYear(), d.getMonth(), 1);
                const end   = new Date(d.getFullYear(), d.getMonth()+1, 0);
                const keyStart = toYMD(start), keyEnd = toYMD(end);
                const sumMin = sessions
                    .filter(s => s.date >= keyStart && s.date <= keyEnd)
                    .reduce((acc,s)=>acc + (Number(s.minutes)||0), 0);
                months.push({ label: d.toLocaleDateString('ru-RU',{month:'long'}), hours: Math.round((sumMin/60)*2)/2 });
            }
            const labels = months.map(m=>m.label);
            const series = months.map(m=>m.hours);
            const rangeLabel = `Показаны: ${labels[0]} — ${labels[labels.length-1]}`;
            return { labels, series, rangeLabel };
        }
        function refreshTrackerUI() {
            updateTrackerStats();
            updateChart(currentPeriod || 'weeks');
        }

        // Форматирование часов: без лишних .0
        function formatHours(val) {
            const rounded = Math.round(val * 10) / 10; // одна цифра после запятой
            if (Number.isInteger(rounded)) return String(rounded);
            return rounded.toFixed(1);
        }

        // ===== AUTH (email + код) — демо на localStorage =====
        function requestLoginCode() {
            const email = (document.getElementById('auth-email').value || '').trim();
            const status = document.getElementById('auth-status');
            if (!email || !/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) {
                status.textContent = 'Введи корректный email';
                status.style.color = '#b91c1c';
                return;
            }
            const code = String(Math.floor(100000 + Math.random()*900000));
            localStorage.setItem(`${AUTH_KEY}-pending`, JSON.stringify({ email, code, createdAt: Date.now() }));
            status.textContent = `Код отправлен на ${email} (в демо см. localStorage)`;
            status.style.color = '#2563eb';
            // Автозаполнить для демо (не для продакшена)
            const digits = code.split('');
            for (let i=0;i<6;i++){ const el = document.getElementById(`code-${i+1}`); if (el) el.value = digits[i] || ''; }
        }
        function confirmLoginCode() {
            const pending = JSON.parse(localStorage.getItem(`${AUTH_KEY}-pending`) || 'null');
            const status = document.getElementById('auth-status');
            if (!pending) { status.textContent = 'Сначала запроси код'; status.style.color = '#b91c1c'; return; }
            const code = Array.from({length:6},(_,i)=>document.getElementById(`code-${i+1}`)?.value||'').join('');
            if (code !== pending.code) { status.textContent = 'Неверный код'; status.style.color = '#b91c1c'; return; }
            localStorage.setItem(AUTH_KEY, JSON.stringify({ email: pending.email, loggedInAt: Date.now() }));
            localStorage.removeItem(`${AUTH_KEY}-pending`);
            status.textContent = 'Вход выполнен';
            status.style.color = '#16a34a';
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) logoutBtn.classList.remove('hidden');
        }
        function logout() {
            localStorage.removeItem(AUTH_KEY);
            const status = document.getElementById('auth-status');
            if (status) { status.textContent = 'Вы вышли из аккаунта'; status.style.color = '#6B7280'; }
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) logoutBtn.classList.add('hidden');
        }
        
        // Инициализация графика при загрузке страницы
        function initChart() {
            updateChart('weeks');
        }

        // ===== МОТИВАЦИОННЫЕ ФРАЗЫ =====
        const wishes = [
          'ваши родители случайно не коврики от йоги? а то вы так круто на них лежите',
          'кто это там в зеркале? нереальная красотка',
          'тревога боялась её! она регулярно ходила на растяжку..',
          'как же классно, что ты уделяешь время себе!',
          'ваши родители случайно не гантели? а то вы так уверенно держите себя в руках',
          'это что, новая суперсила? спокойно отдыхать и при этом выглядеть на миллион',
          'стресс думал, что победит её… но не знал, что у неё абонемент на йогу',
          'кто так сияет после тренировки? да это же ты, солнышко в зале',
          'ваши родители случайно не коврики-пилатес? а то ты всё время находишь баланс',
          'зеркало спрашивало: это ангел? — нет, просто она сделала растяжку',
          'кто тут умудряется заботиться о себе даже в будни? легенда, не иначе',
          'ты такая красотка, а у меня только сотка',
          'ты как вайфай — рядом с тобой всё ловит',
          'ты как пресс после качалки — на тебя приятно опереться',
          'ты такая гибкая, что йога сама на тебя подписалась',
          'стресс вышел в окно, когда узнал, что у тебя сегодня пилатес',
          'тревога пыталась постучать, но дверь занята твоим чиллом',
          'ты выглядишь так, будто только что выиграла в лотерею сна',
          'энергетик обзавидовался твоей зарядке',
          'ты сияешь ярче, чем экран телефона на максималке',
          'мир такой: «вау, это что, апгрейд?» — нет, это просто ты позанималась',
          'спорт думал, что он тебя прокачает, а оказалось — ты прокачала его',
          'вангую, сегодня ты спала как спящая принцесса',
          'ты отдыхаешь так красиво, что Netflix уже думает снять сериал',
          'твой сон был таким глубоким, что даже мысли не достучались',
          'ты лежала так грациозно, что кровать почувствовала себя диваном из рекламы',
          'отдых у тебя получается лучше, чем у большинства работа',
          'подушка в восторге: говорит, это была лучшая ночь её жизни',
          'ты расслабляешься так, будто это твой олимпийский вид спорта',
          'днём отдыхаешь — ночью сверкаешь, закон сохранения красоты',
          'сегодня твой чилл был мощнее любого энергетика',
          'мир подождал, пока ты спала — и не пожалел',
          'твоё «ничегонеделание» выглядит как искусство'
        ];

        // Открыть печеньку и показать предсказание
        function showInlineWish() {
            const container = document.getElementById('wish-inline-container');
            const button = document.getElementById('wish-button');
            if (!container || !button) return;
            const text = wishes[Math.floor(Math.random() * wishes.length)];
            // Спрятать кнопку, показать текст
            button.classList.add('hidden');
            const textEl = document.createElement('div');
            textEl.id = 'wish-inline-text';
            textEl.className = 'wish-inline-card';
            textEl.textContent = text;
            container.appendChild(textEl);
            // Пустить дождь из сердечек 2 секунды
            try { createHeartAnimationBurst(2000); } catch(e) {}
            // Вернуть кнопку через 4.5 секунды или по тапу
            const restore = () => {
                if (textEl && textEl.parentNode) textEl.parentNode.removeChild(textEl);
                button.classList.remove('hidden');
            };
            clearTimeout(window.__wishInlineTimer);
            window.__wishInlineTimer = setTimeout(restore, 15000);
            textEl.onclick = restore;
        }

        // Короткий «дождь из сердечек» заданной длительности (мс)
        function createHeartAnimationBurst(durationMs=2000) {
            const endAt = Date.now() + durationMs;
            const spawn = () => {
                if (Date.now() > endAt) return;
                    const heart = document.createElement('div');
                    heart.className = 'heart';
                heart.textContent = '💖';
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                heart.style.left = (Math.random() * screenWidth) + 'px';
                heart.style.top = (-50) + 'px';
                heart.style.fontSize = (2 + Math.random() * 2) + 'rem';
                    document.body.appendChild(heart);
                setTimeout(() => { heart.style.transition = 'top 2s ease-in'; heart.style.top = (screenHeight + 100) + 'px'; }, 20);
                setTimeout(() => { if (heart.parentNode) heart.parentNode.removeChild(heart); }, 2300);
                setTimeout(spawn, 100 + Math.random()*120);
            };
            spawn();
        }

        function changeMotivationalPhrase() {
            const phraseElement = document.getElementById('motivational-phrase');
            if (phraseElement) {
                const randomIndex = Math.floor(Math.random() * motivationalPhrases.length);
                phraseElement.textContent = motivationalPhrases[randomIndex];
            }
        }

        // ===== ПРОФИЛЬ =====
        function saveProfile() {
            const name = document.getElementById('profile-name').value;
            const cycleStart = document.getElementById('cycle-start').value;
            const cycleLength = document.getElementById('cycle-length').value;
            const mLength = document.getElementById('m-length').value;
            
            if (!name || !cycleStart || !cycleLength || !mLength) {
                alert('Пожалуйста, заполните все поля!');
                return;
            }
            
            const profile = {
                name,
                cycleStart,
                cycleLength: parseInt(cycleLength),
                mLength: parseInt(mLength)
            };
            
            localStorage.setItem('userProfile', JSON.stringify(profile));
            updateProfileDisplay(profile);
            
            // Обновить фазу цикла после сохранения профиля
            updateCyclePhase();
            
            // Обновим вкладку "Цикл" сразу после сохранения
            updateCyclePhase();
            alert('Профиль сохранен!');
        }

        function updateProfileDisplay(profile) {
            // Переключаем кнопки: Сохранить становится неактивной, Изменить - активной
            const saveBtn = document.getElementById('save-profile-btn');
            const editBtn = document.getElementById('edit-profile-btn');
            
            saveBtn.classList.remove('btn-primary');
            saveBtn.classList.add('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
            saveBtn.disabled = true;
            saveBtn.textContent = 'Сохранено';
            
            editBtn.classList.remove('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
            editBtn.classList.add('btn-primary');
            editBtn.disabled = false;
            editBtn.textContent = 'Поправить';
            
            // Блокируем поля ввода после сохранения
            ['profile-name','cycle-start','cycle-length','m-length'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.disabled = true;
            });
        }

        function editProfile() {
            // Переключаем кнопки: включаем редактирование без очистки полей
            const saveBtn = document.getElementById('save-profile-btn');
            const editBtn = document.getElementById('edit-profile-btn');
            
            saveBtn.classList.remove('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
            saveBtn.classList.add('btn-primary');
            saveBtn.disabled = false;
            saveBtn.textContent = 'Готово';
            
            editBtn.classList.remove('btn-primary');
            editBtn.classList.add('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
            editBtn.disabled = true;
            editBtn.textContent = 'Поправить';
            
            // Разблокируем поля ввода
            ['profile-name','cycle-start','cycle-length','m-length'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.disabled = false;
            });
        }

        function loadProfile() {
            const savedProfile = localStorage.getItem('userProfile');
            if (savedProfile) {
                const profile = JSON.parse(savedProfile);
                
                document.getElementById('profile-name').value = profile.name;
                document.getElementById('cycle-start').value = profile.cycleStart;
                document.getElementById('cycle-length').value = profile.cycleLength;
                document.getElementById('m-length').value = profile.mLength;
                
                updateProfileDisplay(profile);
                
                // Обновить информацию о фазе цикла
                updateCyclePhase();
            } else {
                // Если профиль не загружен, показываем кнопку "Сохранить" активной
                const saveBtn = document.getElementById('save-profile-btn');
                const editBtn = document.getElementById('edit-profile-btn');
                
                saveBtn.classList.add('btn-primary');
                saveBtn.classList.remove('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
                saveBtn.disabled = false;
                saveBtn.textContent = 'Сохранить';
                
                editBtn.classList.add('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
                editBtn.classList.remove('btn-primary');
                editBtn.disabled = true;
                editBtn.textContent = 'Изменить';
            }
        }

        // ===== СОБЫТИЯ =====
        document.addEventListener('click', function(event) {
            if (!event.target.closest('[id$="-activity-menu"]') && !event.target.closest('button[onclick*="toggleActivityMenu"]')) {
                const allMenus = document.querySelectorAll('[id$="-activity-menu"]');
                allMenus.forEach(menu => {
                    menu.classList.add('hidden');
                });
            }
        });

        // ===== НАВИГАЦИЯ НЕДЕЛЬ =====
        let currentWeekStart = new Date();
        
        // Найти понедельник текущей недели
        function getMondayOfWeek(date) {
            const day = date.getDay();
            const diff = date.getDate() - day + (day === 0 ? -6 : 1); // Понедельник = 1
            return new Date(date.setDate(diff));
        }
        
        // Форматирование заголовка недели: "25 — 31 авг" / "31 авг — 6 сен"
        function fmtDay(d){ return new Date(d).toLocaleDateString('ru-RU',{ day:'2-digit' }); }
        function fmtDayMon(d){ return new Date(d).toLocaleDateString('ru-RU',{ day:'numeric', month:'short' }).replace('.', ''); }
        function formatWeekRangeLabel(startDate){
            const s = new Date(startDate); s.setHours(0,0,0,0);
            const e = new Date(s); e.setDate(s.getDate()+6);
            const sameMonth = s.getMonth() === e.getMonth() && s.getFullYear() === e.getFullYear();
            const left  = sameMonth ? fmtDay(s) : fmtDayMon(s);
            const right = fmtDayMon(e);
            return `${left} — ${right}`;
        }
        
        // Обновить отображение недели
        function updateWeekDisplay() {
            const monday = getMondayOfWeek(new Date(currentWeekStart));
            const sunday = new Date(monday);
            sunday.setDate(monday.getDate() + 6);
            
            const weekText = formatWeekRangeLabel(monday);
            const labelEl = document.getElementById('weekLabel');
            if (labelEl) labelEl.textContent = weekText;
            
            // Обновить фазу цикла
            updateCyclePhase();
            // Подтянуть данные по минутам из sessions и обновить UI
            loadWeekFromSessions();
            Object.keys(dayTimes).forEach(day => {
                updateDayDisplay(day);
                updateActivitiesDisplay(day);
            });
            updateTotal();
        }
        
        // Предыдущая неделя
        function previousWeek() {
            currentWeekStart.setDate(currentWeekStart.getDate() - 7);
            updateWeekDisplay();
        }
        
        // Следующая неделя
        function nextWeek() {
            currentWeekStart.setDate(currentWeekStart.getDate() + 7);
            updateWeekDisplay();
        }
        
        // Загрузить минуты выбранной недели из sessions (единый источник данных)
        function loadWeekFromSessions() {
            try {
                const monday = getMondayOfWeek(new Date(currentWeekStart));
                monday.setHours(0,0,0,0);
                const sessions = getSessions();
                const actMap = getActivitiesMap();
                for (let i = 0; i < 7; i++) {
                    const d = new Date(monday);
                    d.setDate(monday.getDate() + i);
                    const key = toYMD(d);
                    const minutes = sessions
                        .filter(s => s.date === key)
                        .reduce((acc, s) => acc + (Number(s.minutes) || 0), 0);
                    dayTimes[dayOrder[i]] = minutes;
                    // Подтянуть активности по дате с безопасным фолбэком на сохранённые dayActivities
                    const fallback = Array.isArray(dayActivities[dayOrder[i]]) ? [...dayActivities[dayOrder[i]]] : [];
                    dayActivities[dayOrder[i]] = Array.isArray(actMap[key]) ? [...actMap[key]] : fallback;
                }
            } catch (e) {
                console.error('loadWeekFromSessions failed', e);
            }
        }
        
        // ===== РАСЧЕТ ФАЗЫ ЦИКЛА =====
        function updateCyclePhase() {
            const profile = JSON.parse(localStorage.getItem('userProfile') || '{}');
            if (!profile.cycleStart || !profile.cycleLength || !profile.mLength) {
                 // Если профиль не заполнен, обновим страницу "Цикл" приглашением
                 const cTitle = document.getElementById('cycle-phase-title');
                 const cInfo = document.getElementById('cycle-phase-info');
                 if (cTitle) cTitle.textContent = 'Перейди в Профиль и заполни информацию о себе, чтобы видеть свою фазу цикла.';
                 if (cInfo) cInfo.innerHTML = '';
                return;
            }
            
            const cycleStart = new Date(profile.cycleStart);
            // Используем текущую выбранную неделю вместо сегодняшней даты
            const selectedWeekDate = new Date(currentWeekStart);
            const daysSinceStart = Math.floor((selectedWeekDate - cycleStart) / (1000 * 60 * 60 * 24));
            const cycleDay = daysSinceStart % profile.cycleLength;
            
            let phaseText = '';
            let phaseIcon = '';
            
            if (cycleDay < profile.mLength) {
                // Менструальная фаза
                phaseText = 'Забота. Отдых. Плавность';
                phaseIcon = '🩸';
            } else if (cycleDay < profile.mLength + Math.round((profile.cycleLength - profile.mLength - 5) / 2)) {
                // Фолликулярная фаза
                phaseText = 'Энергия растёт. Можно усиливаться';
                phaseIcon = '💃';
             } else {
                 // Лютеиновая фаза: делим на две части
                 const lutealStart = profile.mLength + Math.round((profile.cycleLength - profile.mLength - 5) / 2);
                 const daysIntoLuteal = cycleDay - lutealStart;
                 const lutealLength = profile.cycleLength - lutealStart;
                 const firstWeek = daysIntoLuteal < 7; // первая неделя лютеиновой
                 if (firstWeek) {
                     phaseText = 'Силовые идут отлично. Хорошая выносливость';
                phaseIcon = '💪';
            } else {
                phaseText = 'Замедлись. Сфокусируйся на себе';
                phaseIcon = '🧘';
                 }
             }
             
             // Обновить отображение фазы в шапке недели (новый контейнер cycleHint)
             const cycleHintEl = document.getElementById('cycleHint');
             if (cycleHintEl) {
                 cycleHintEl.innerHTML = `
                     <span class="cycle-emoji">${phaseIcon}</span>
                     <span class="cycle-text">${phaseText}</span>
                 `;
             }
             // Обратная совместимость, если остался старый id
             const legacyPhaseElement = document.getElementById('cycle-phase-hint');
             if (legacyPhaseElement) {
                 legacyPhaseElement.innerHTML = `
                    <span class="text-2xl">${phaseIcon}</span>
                    <span class="text-xs sm:text-sm">${phaseText}</span>
                `;
            }
            
             // Сохраним текущую фазу для логики рекомендаций "Как ты сегодня?"
             window.__currentPhaseIcon = phaseIcon;
             
             // Обновляем детальную информацию на вкладке "Цикл"
             const details = getPhaseDetails(phaseIcon);
             const nameEl = document.getElementById('cycle-phase-name');
             const keyEl = document.getElementById('cycle-phase-key');
             const bodyEl = document.getElementById('cycle-body');
             const impactEl = document.getElementById('cycle-impact');
             const actionsEl = document.getElementById('cycle-actions');
             if (nameEl) nameEl.textContent = details.description;
             if (keyEl) keyEl.textContent = phaseText;
             if (bodyEl) bodyEl.textContent = details.bodyChanges;
             if (impactEl) impactEl.textContent = details.impact;
             if (actionsEl) {
                 actionsEl.innerHTML = details.activities.slice(0,6).map(a => {
                     const parts = a.split(' ');
                     const emoji = parts[0];
                     const text = parts.slice(1).join(' ');
                     return `<div class=\"bg-white rounded-xl border border-pink-100 p-2 text-center\"><div class=\"text-lg\">${emoji}</div><div class=\"text-xs text-gray-700\">${text}</div></div>`;
                 }).join('');
             }
        }

        // Обновить детальную информацию о фазе
        function updatePhaseInfo(phaseIcon, phaseText) {
            const phaseInfoElement = document.getElementById('phase-info');
            const phaseTitleElement = document.getElementById('phase-title');
            if (!phaseInfoElement || !phaseTitleElement) return;
            
            const phaseDetails = getPhaseDetails(phaseIcon);
            
            // Обновляем заголовок фазы
            phaseTitleElement.textContent = phaseDetails.description;
            
            // Обновляем детальную информацию
            phaseInfoElement.innerHTML = `
                <div class="space-y-4">
                    <div class="bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl p-5 border border-pink-100">
                        <h4 class="font-bold text-text mb-3 text-lg text-left">Что происходит в теле</h4>
                        <p class="text-sm text-gray-800 leading-relaxed text-left">${phaseDetails.bodyChanges}</p>
                    </div>
                    
                    <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-5 border border-purple-100">
                        <h4 class="font-bold text-text mb-3 text-lg text-left">Как это влияет на тебя</h4>
                        <p class="text-sm text-gray-800 leading-relaxed text-left">${phaseDetails.impact}</p>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-5 border border-blue-100">
                        <h4 class="font-bold text-text mb-3 text-lg text-left">Что с этим делать</h4>
                        <div class="grid grid-cols-2 sm:grid-cols-3 gap-2">
                            ${phaseDetails.activities.slice(0, 5).map(activity => `
                                <div class="bg-white/70 backdrop-blur-sm rounded-lg p-2 border border-blue-200/50 hover:border-blue-300 transition-all duration-300 hover:shadow-md hover:scale-105 group">
                                    <div class="text-center">
                                        <div class="text-lg mb-1">${activity.split(' ')[0]}</div>
                                        <div class="text-xs font-medium text-gray-700 group-hover:text-gray-900 transition-colors leading-tight">
                                            ${activity.split(' ').slice(1).join(' ')}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // Получить детальную информацию о фазе
        function getPhaseDetails(phaseIcon) {
            const phaseData = {
                '🩸': {
                    description: 'Менструальная фаза',
                    bodyChanges: 'Уровень эстрогена и прогестерона находится на минимуме. Матка сокращается для отторжения эндометрия, что может вызывать спазмы. Снижается уровень железа, что влияет на выносливость. Организм тратит много энергии на обновление тканей и восстановление.',
                    impact: 'У тебя понижается уровень энергии, ты можешь чувствовать усталость, раздражительность или наоборот - очень спокойной. Это абсолютно нормально! Твое тело тратит много энергии на обновление, поэтому важно дать ему отдохнуть и восстановиться.',
                    activities: [
                        '🧘‍♀️ Йога',
                        '😴 Сон',
                        '🚶‍♀️ Прогулки',
                        '📚 Чтение',
                        '🛁 Ванны'
                    ]
                },
                '💃': {
                    description: 'Фолликулярная фаза',
                    bodyChanges: 'Уровень эстрогена постепенно повышается, стимулируя рост фолликулов в яичниках. Улучшается кровообращение, повышается чувствительность к инсулину. Организм накапливает энергию и готовится к возможной овуляции. Увеличивается выработка серотонина, что улучшает настроение.',
                    impact: 'У тебя повышается уровень энергии, ты можешь смело больше нагружать себя и идти в большие активности. Ты чувствуешь себя более уверенной, креативной и готовой к новым вызовам. Это идеальное время для планирования, постановки целей и начала новых проектов.',
                    activities: [
                        '💪 Силовые',
                        '🏃‍♀️ Кардио',
                        '💃 Танцы',
                        '🧗‍♀️ Йога',
                        '🎯 Групповые'
                    ]
                },
                '💪': {
                    description: 'Овуляторная фаза',
                    bodyChanges: 'Уровень эстрогена достигает пика, а лютеинизирующий гормон (ЛГ) резко повышается, запуская овуляцию. Увеличивается выработка тестостерона, что улучшает мышечную силу и выносливость. Организм работает на максимальной мощности - улучшается координация, скорость реакции и мышечная сила.',
                    impact: 'У тебя максимальная энергия, выносливость и мотивация. Ты можешь смело идти на рекорды и максимальные нагрузки. Это идеальное время для достижения рекордов, участия в соревнованиях и выполнения сложных задач.',
                    activities: [
                        '🏋️‍♀️ Максимум',
                        '🎾 Игры',
                        '🏃‍♀️ Интервалы',
                        '💪 Кроссфит',
                        '🎯 Соревнования'
                    ]
                },
                '🧘': {
                    description: 'Лютеиновая фаза',
                    bodyChanges: 'Уровень прогестерона высокий, а эстроген начинает снижаться. Прогестерон расслабляет мышцы и может вызывать задержку жидкости. Организм готовится к возможной беременности, тратит много энергии на поддержание эндометрия. Может повышаться базальная температура тела.',
                    impact: 'У тебя может снижаться уровень энергии, появляться усталость, раздражительность, повышенная тревожность и тяга к углеводам. Это нормально! Твой организм готовится к возможной беременности и тратит много энергии.',
                    activities: [
                        '🧘‍♀️ Мягкая йога',
                        '🚶‍♀️ Прогулки',
                        '🏊‍♀️ Плавание',
                        '🎨 Творчество',
                        '😴 Отдых'
                    ]
                }
            };
            
            return phaseData[phaseIcon] || phaseData['🧘'];
        }
        
        // ===== НАВИГАЦИЯ =====
        function showSection(sectionName) {
            // Скрыть все секции
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Показать выбранную секцию
            document.getElementById(`${sectionName}-section`).classList.add('active');
            
            // Обновить активную кнопку навигации
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Найти кнопку по onclick атрибуту и сделать её активной
            const activeButton = document.querySelector(`button[onclick="showSection('${sectionName}')"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }

            // Если открываем раздел "Трекер", перерисуем график под активный период
            if (sectionName === 'tracker') {
                const active = document.querySelector('.chart-period-btn.active');
                const period = (active && active.dataset && active.dataset.period) || 'weeks';
                updateChart(period);
            } else if (sectionName === 'cycle') {
                // При входе во вкладку "Цикл" обновим фазу из профиля
                updateCyclePhase();
            }
        }
        
        // ===== ИНИЦИАЛИЗАЦИЯ =====
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            loadProfile();
            updateTotal();
            updateTrackerStats();
            updateWeekDisplay();
            updateChart('weeks');
            // Навигация неделями
            const prevBtn = document.querySelector('.week-btn.prev');
            const nextBtn = document.querySelector('.week-btn.next');
            if (prevBtn) prevBtn.onclick = () => { currentWeekStart.setDate(currentWeekStart.getDate() - 7); updateWeekDisplay(); };
            if (nextBtn) nextBtn.onclick = () => { currentWeekStart.setDate(currentWeekStart.getDate() + 7); updateWeekDisplay(); };
            // Клик по подсказке фазы — перейти в профиль и прокрутить к блоку
            const hint = document.getElementById('cycleHint');
            if (hint) hint.onclick = () => { showSection('cycle'); };
            // Открыть профиль по иконке в шапке
            const openProfile = document.getElementById('profile-open');
            if (openProfile) openProfile.onclick = () => { showSection('profile'); };
            const fab = document.getElementById('profile-fab');
            if (fab) fab.onclick = () => { showSection('profile'); };
            const savedMood = localStorage.getItem('currentMood');
            if (savedMood) {
                const moodButton = document.querySelector(`button[onclick=\"setMood('${savedMood}', event)\"]`);
                if (moodButton) {
                    moodButton.classList.add('ring-2', 'ring-accent');
                }
            }
            // Закрытие выпадающего списка по клику вне
            document.addEventListener('click', (e) => {
                const portal = document.getElementById('activity-suggestions-portal');
                if (!portal) return;
                const clickedPlus = e.target.closest('button[id$="-plus-btn"]');
                const clickedInsidePortal = portal.contains(e.target);
                if (!clickedPlus && !clickedInsidePortal) {
                    portal.classList.add('hidden');
                }
            });
            // Рендер карусели науки
            try { renderAboutCarousel(); } catch(e) {}
            console.log('BodyWeek мобильное приложение загружено!');
        });
        // О приложении: скроллы и CTA
        document.addEventListener('click', (e) => {
            if (e.target && e.target.id === 'about-scroll') {
                const facts = document.getElementById('about-facts');
                if (facts) facts.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            if (e.target && e.target.id === 'about-cta') {
                showSection('tracker');
                // опционально: прокрутка к началу графика/планирования не требуется
            }
        });

        // Ротация фактов в "Науке"
        const aboutFacts = [
            '10 минут активности в день снижают тревожность и улучшают сон (NHS, Sleep Foundation).',
            'Небольшие движения в течение дня уменьшают риск депрессии (WHO).',
            'Тренировки, синхронизированные с фазами цикла, повышают устойчивость к стрессу (Frontiers in Physiology).',
            'Короткие тренировки в течение дня улучшают настроение так же, как длинные (мета‑анализ).',
            'Умеренная активность повышает когнитивную гибкость и концентрацию (JAMA).',
            'Ежедневная ходьба связана с снижением стресса и улучшением сна (Harvard Health).',
            'Регулярная растяжка снижает мышечное напряжение и тревожность (Scandinavian Journal of Medicine & Science in Sports).',
            'Практики дыхания уменьшают физиологические маркеры стресса за 5–10 минут (PNAS).',
            'Сон улучшается при регулярной умеренной активности даже без изменения веса (Sleep Medicine Reviews).',
            'Даже лёгкая йога повышает вариабельность сердечного ритма — маркер устойчивости к стрессу (Frontiers in Neuroscience).',
            'Активности на природе снижают кортизол заметнее, чем в помещении (Environmental Research).',
            'Мини‑перерывы с движением повышают продуктивность и уменьшают усталость (Occupational Health).',
            'Регулярная активность снижает риск сердечно‑сосудистых событий (Lancet).',
            'Небольшие, но частые упражнения улучшают метаболизм глюкозы (Diabetes Care).',
            'Синхронизация тренировок с циклом может оптимизировать силу и выносливость (Sports Medicine).',
            'Осознанная активность и медитация вместе сильнее снижают стресс (Clinical Psychology Review).'
        ];
        let aboutFactIdx = 0;
        document.addEventListener('click', (e) => {
            if (e.target && e.target.id === 'scienceCard') {
                const card = e.target;
                card.classList.add('fade');
                setTimeout(() => {
                    aboutFactIdx = (aboutFactIdx + 1) % aboutFacts.length;
                    card.textContent = aboutFacts[aboutFactIdx];
                    card.classList.remove('fade');
                }, 180);
            }
        });

        // ===== Как ты сегодня? (мини-диалог) =====
        const TODAY_KEY = 'bodyweek-today';
        let __todayFlow = { mood: null, time: null, extra: {} };

        function loadTodayFromStorage() {
            try {
                const raw = localStorage.getItem(TODAY_KEY);
                if (!raw) return;
                const saved = JSON.parse(raw);
                if (!saved || !saved.mood) return;
                const savedDate = new Date(saved.date);
                const today = new Date();
                savedDate.setHours(0,0,0,0);
                today.setHours(0,0,0,0);
                if (savedDate.getTime() !== today.getTime()) return;
                renderTodayRecommendation(saved.recommendation, saved.mood, saved.suggestedActivity);
            } catch (e) {}
        }

        function startTodayFlow(mood, event) {
             __todayFlow = { mood, time: null, extra: {} };
             localStorage.setItem(TODAY_KEY, JSON.stringify({ mood, date: new Date().toISOString() }));
             // Highlight selected mood button
            document.querySelectorAll('button[onclick^="startTodayFlow"]').forEach(btn => btn.classList.remove('active'));
            if (event && event.currentTarget) event.currentTarget.classList.add('active');
             renderTimeQuestion();
         }

        function renderTimeQuestion() {
             const box = document.getElementById('today-questions');
             const recoBox = document.getElementById('today-reco');
             if (!box) return;
             recoBox?.classList.add('hidden');
             recoBox.innerHTML = '';
             box.classList.remove('hidden');
             box.innerHTML = `
                 <div class=\"bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-2\">
                     <div class=\"text-sm font-semibold text-text\">Сколько у тебя есть времени?</div>
                     <div class=\"flex flex-wrap gap-2\">
                         <button class=\"bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm\" onclick=\"chooseTodayTime('5')\">5 мин</button>
                         <button class=\"bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm\" onclick=\"chooseTodayTime('10-15')\">10–15 мин</button>
                         <button class=\"bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm\" onclick=\"chooseTodayTime('20-30')\">20–30 мин</button>
                         <button class=\"bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm\" onclick=\"chooseTodayTime('60')\">1 час</button>
                     </div>
                 </div>`;
         }

        function chooseTodayTime(val) {
            __todayFlow.time = val;
            const savedRaw = JSON.parse(localStorage.getItem(TODAY_KEY) || '{}');
            localStorage.setItem(TODAY_KEY, JSON.stringify({ ...savedRaw, time: val }));
            // Highlight selected time button
            const container = document.getElementById('today-questions');
            if (container) {
                container.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                const target = Array.from(container.querySelectorAll('button')).find(b => b.textContent.includes(val === '5' ? '5' : (val === '10-15' ? '10' : (val === '60' ? '1 час' : '20'))));
                if (target) target.classList.add('active');
            }
            renderExtraQuestions();
        }

        function renderExtraQuestions() {
            const mood = __todayFlow.mood;
            const box = document.getElementById('today-questions');
            if (!box) return;
            let content = '';
            if (mood === 'bad') {
                content = `
                    <div class="bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-3">
                        <div class="text-sm font-semibold text-text">Как со сном?</div>
                        <div class="flex flex-wrap gap-2">
                            ${['<6ч','6–7ч','7–8ч','>8ч'].map((t,i)=>`<label class=\"inline-flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm cursor-pointer\"><input type=\"radio\" name=\"sleep\" value=\"${t}\" class=\"accent-pink-500\"> ${t}</label>`).join('')}
                        </div>
                        <div class="text-sm font-semibold text-text">Стресс?</div>
                        <div class="flex flex-wrap gap-2">
                            ${['низкий','средний','высокий'].map((t,i)=>`<label class=\"inline-flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm cursor-pointer\"><input type=\"radio\" name=\"stress\" value=\"${t}\" class=\"accent-pink-500\"> ${t}</label>`).join('')}
                        </div>
                        <div class="flex justify-end"><button class="btn-primary py-2 px-4" onclick="finishTodayFlow()">Готово</button></div>
                    </div>`;
            } else if (mood === 'ok') {
                content = `
                    <div class="bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-2">
                        <div class="text-sm font-semibold text-text">Цель на сейчас?</div>
                        <div class="flex flex-wrap gap-2">
                            ${['расслабиться','взбодриться','укрепить тело'].map((t)=>`<label class=\"inline-flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm cursor-pointer\"><input type=\"radio\" name=\"goal\" value=\"${t}\" class=\"accent-pink-500\"> ${t}</label>`).join('')}
                        </div>
                        <div class="flex justify-end"><button class="btn-primary py-2 px-4" onclick="finishTodayFlow()">Готово</button></div>
                    </div>`;
            } else {
                content = `
                    <div class="bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-2">
                        <div class="text-sm font-semibold text-text">Цель на сейчас?</div>
                        <div class="flex flex-wrap gap-2">
                            ${['взбодриться','укрепить тело','мягко закрепить'].map((t)=>`<label class=\"inline-flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm cursor-pointer\"><input type=\"radio\" name=\"goal\" value=\"${t}\" class=\"accent-pink-500\"> ${t}</label>`).join('')}
                        </div>
                        <div class="flex justify-end"><button class="btn-primary py-2 px-4" onclick="finishTodayFlow()">Готово</button></div>
                    </div>`;
            }
            box.innerHTML = content;
        }

        function getPhaseBias() {
            const icon = window.__currentPhaseIcon || '';
            if (icon === '🩸' || icon === '🧘') return 'gentle';
            if (icon === '💃' || icon === '💪') return 'intense';
            return 'neutral';
        }

        function buildTodayRecommendation() {
            const { mood, time } = __todayFlow;
            const goal = document.querySelector('input[name=\"goal\"]:checked')?.value || null;
            const sleep = document.querySelector('input[name=\"sleep\"]:checked')?.value || null;
            const stress = document.querySelector('input[name=\"stress\"]:checked')?.value || null;
            __todayFlow.extra = { goal, sleep, stress };
 
            let suggestedActivity = '🧘 Медитация';
            let text = '';
            const timeText = time === '5' ? '5 минут' : (time === '10-15' ? '10–15 минут' : (time === '60' ? '1 час' : '20–30 минут'));
            const bias = getPhaseBias();
            let suggestions = [];
 
            if (mood === 'bad') {
                if (sleep === '<6ч') {
                    suggestedActivity = '🧘 Медитация';
                    text = `Сегодня мало сна — сделай лёгкое дыхание/медитацию на ${timeText} и постарайся лечь пораньше.`;
                    suggestions = ['🧘 Медитация','🧘‍♀️ Йога','🚶‍♀️ Прогулки'];
                } else if (stress === 'высокий') {
                    suggestedActivity = '🧘‍♀️ Йога';
                    text = `Стресс высокий — мягкая йога/растяжка на ${timeText} поможет разгрузить голову.`;
                    suggestions = ['🧘‍♀️ Йога','🧘 Медитация','🚶‍♀️ Прогулки'];
                } else {
                    suggestedActivity = (time === '20-30' && bias !== 'gentle') ? '🚶‍♀️ Прогулки' : '🧘‍♀️ Йога';
                    text = `Лучше мягко: ${time === '20-30' || time === '60' ? 'прогулка' : 'растяжка'} на ${timeText}.`;
                    suggestions = ['🧘‍♀️ Йога','🚶‍♀️ Прогулки','😴 Отдых'];
                }
            } else if (mood === 'ok') {
                if (goal === 'взбодриться') {
                    suggestedActivity = bias === 'gentle' ? '❤️ Кардио' : '🏃‍♀️ Бег';
                    text = `Добавь немного энергии: ${time === '5' ? 'короткие интервалы' : 'интервалы/бег'} на ${timeText}.`;
                    suggestions = [suggestedActivity,'💃 Танцы','🚶‍♀️ Прогулки'];
                } else if (goal === 'укрепить тело') {
                    suggestedActivity = bias === 'gentle' ? '🧘‍♀️ Пилатес' : (time === '60' ? '💪 Силовая' : '💪 Силовая');
                    text = `Сделай ${time === '5' ? 'миникомплекс' : 'короткую силовую'} на ${timeText} — без перегруза.`;
                    suggestions = [suggestedActivity,'🧘‍♀️ Пилатес','❤️ Кардио'];
                } else {
                    suggestedActivity = '🧘‍♀️ Йога';
                    text = `Лёгкая поддержка: йога/растяжка на ${timeText}.`;
                    suggestions = ['🧘‍♀️ Йога','🧘 Медитация','🚶‍♀️ Прогулки'];
                }
            } else {
                if (goal === 'взбодриться') {
                    suggestedActivity = bias === 'gentle' ? '❤️ Кардио' : '🏃‍♀️ Бег';
                    text = `Бодрое настроение — можно интервалы на ${timeText}.`;
                    suggestions = [suggestedActivity,'💃 Танцы','🚶‍♀️ Прогулки'];
                } else if (goal === 'укрепить тело') {
                    suggestedActivity = bias === 'gentle' ? '🧘‍♀️ Пилатес' : (time === '60' ? '💪 Силовая' : '💪 Силовая');
                    text = `Отличный день для силовой на ${timeText}.`;
                    suggestions = [suggestedActivity,'🧘‍♀️ Пилатес','❤️ Кардио'];
                } else {
                    suggestedActivity = '🧘‍♀️ Пилатес';
                    text = `Мягко закрепить — пилатес/йога на ${timeText}.`;
                    suggestions = ['🧘‍♀️ Пилатес','🧘‍♀️ Йога','🚶‍♀️ Прогулки'];
                }
            }
            if (!suggestions.length) suggestions = [suggestedActivity];
            return { text, suggestedActivity, suggestions };
        }

        function finishTodayFlow() {
            const { text, suggestedActivity, suggestions } = buildTodayRecommendation();
            const payload = { ...__todayFlow, recommendation: text, suggestedActivity, suggestions, date: new Date().toISOString() };
            localStorage.setItem(TODAY_KEY, JSON.stringify(payload));
            renderTodayRecommendation(text, __todayFlow.mood, suggestedActivity, suggestions);
        }

        function renderTodayRecommendation(text, mood, suggestedActivity, suggestions=[]) {
            const q = document.getElementById('today-questions');
            const box = document.getElementById('today-reco');
            if (!box) return;
            q?.classList.add('hidden');
            q.innerHTML = '';
            box.classList.remove('hidden');
            const chips = (suggestions && suggestions.length ? suggestions : [suggestedActivity]).map(a => `
                <button class=\"px-3 py-1.5 bg-gray-50 border border-gray-200 rounded-full text-sm\" onclick=\"goAddToWeek('${a}')\">${a}</button>
            `).join(' ');
            box.innerHTML = `
                <div class="bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-3">
                    <div class="text-sm font-semibold text-text">Рекомендация на сегодня</div>
                    <div class="text-sm text-gray-800">${text}</div>
                    <div class="flex flex-wrap gap-2">${chips}</div>
                    <div class="flex justify-end">
                        <button class="btn-primary py-2 px-4" onclick="goAddToWeek('${(suggestions && suggestions[0]) || suggestedActivity || ''}')">Добавить в неделю</button>
                    </div>
                </div>`;
        }

        function goAddToWeek(suggestedActivity) {
            showSection('week');
            const firstPlus = document.querySelector('[id$="-plus-btn"]');
            if (firstPlus) {
                const btnId = firstPlus.id || '';
                const day = btnId.replace('-plus-btn','');
                firstPlus.scrollIntoView({ behavior: 'smooth', block: 'center' });
                firstPlus.classList.add('ring-2','ring-accent');
                setTimeout(() => firstPlus.classList.remove('ring-2','ring-accent'), 1200);
                // Откроем поле ввода и подставим предложение
                if (day) {
                    toggleActivityInput(day);
                    const inputField = document.getElementById(`${day}-activity-field`);
                    if (inputField && suggestedActivity) {
                        inputField.value = suggestedActivity;
                        inputField.focus();
                    }
                }
            }
        }

        // Карусель фактов "Наука": отрисовать элементы и точки
        function renderAboutCarousel() {
            const wrap = document.getElementById('about-carousel');
            const dots = document.getElementById('about-dots');
            if (!wrap || !dots || !Array.isArray(aboutFacts)) return;
            wrap.innerHTML = '';
            dots.innerHTML = '';
            const items = aboutFacts.slice(0, 8);
            items.forEach((fact, idx) => {
                const el = document.createElement('div');
                el.className = 'about-science-item';
                el.textContent = fact;
                wrap.appendChild(el);
                const dot = document.createElement('span');
                dot.style.width = '6px'; dot.style.height = '6px'; dot.style.borderRadius = '999px';
                dot.style.background = idx === 0 ? '#D14E9E' : '#E5E7EB';
                dot.style.display = 'inline-block';
                dots.appendChild(dot);
            });
            // Обновлять активную точку по скроллу — без сложной логики
            wrap.addEventListener('scroll', () => {
                const children = Array.from(wrap.children);
                const center = wrap.scrollLeft + wrap.clientWidth / 2;
                let active = 0;
                children.forEach((child, i) => {
                    const rectLeft = child.offsetLeft;
                    const rectCenter = rectLeft + child.clientWidth / 2;
                    if (Math.abs(rectCenter - center) < Math.abs((children[active].offsetLeft + children[active].clientWidth/2) - center)) {
                        active = i;
                    }
                });
                Array.from(dots.children).forEach((d, i) => {
                    d.style.background = i === active ? '#D14E9E' : '#E5E7EB';
                });
            });
        }

        // ===== ПОЛИТИКА КОНФИДЕНЦИАЛЬНОСТИ =====
        function openPrivacy() {
            const m = document.getElementById('privacy-modal');
            if (m) m.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }
        function closePrivacy() {
            const m = document.getElementById('privacy-modal');
            if (m) m.classList.add('hidden');
            document.body.style.overflow = '';
        }

        // Карта активностей по датам
        function getActivitiesMap() {
            try { return JSON.parse(localStorage.getItem(ACTIVITIES_KEY)) || {}; }
            catch { return {}; }
        }

        // Автосохранение перед закрытием страницы
        window.addEventListener('beforeunload', () => {
            try { saveData(); } catch(e) {}
        });
    </script>

    <!-- Privacy Policy Modal -->
    <div id="privacy-modal" class="fixed inset-0 bg-black/40 hidden z-[70]">
        <div class="absolute inset-0" onclick="closePrivacy()"></div>
        <div class="relative max-w-2xl w-[92%] sm:w-[600px] max-h-[70vh] bg-white rounded-2xl shadow-xl mx-auto mt-16 overflow-hidden">
            <button class="absolute top-3 right-3 text-gray-500 text-xl" onclick="closePrivacy()">×</button>
            <div class="p-5 overflow-y-auto" style="max-height: calc(70vh - 88px);">
                <h2 class="text-xl font-extrabold text-text mb-3">Политика конфиденциальности</h2>
                <div class="space-y-3 text-sm text-gray-800 leading-relaxed">
                    <p><strong>Политика конфиденциальности и обработки персональных данных</strong></p>
                    <p>Настоящая политика определяет порядок обработки персональных данных пользователями мобильного приложения.</p>
                    <p><strong>1. Оператор</strong><br/>Оператором персональных данных является Кузьмина Валерия Антоновна, e-mail: valeriyacuzmina@gmail.com.</p>
                    <p><strong>2. Обрабатываемые данные</strong><br/>Мы собираем и обрабатываем следующие данные: имя; адрес электронной почты; данные о менструальном цикле (начало последних месячных, длительность менструации, средняя длина цикла).</p>
                    <p><strong>3. Цели обработки</strong><br/>Персональные данные обрабатываются в целях: авторизации пользователя в приложении; предоставления доступа к функционалу приложения; расчёта фаз цикла и предоставления персональных рекомендаций; обратной связи с пользователем.</p>
                    <p><strong>4. Правовое основание</strong><br/>Основанием для обработки данных является согласие пользователя, выраженное при вводе данных в приложении.</p>
                    <p><strong>5. Условия обработки и хранения</strong><br/>Все данные сохраняются локально на устройстве пользователя. Данные не передаются третьим лицам. Пользователь может удалить свои данные в любое время в разделе «Профиль».</p>
                    <p><strong>6. Права пользователя</strong><br/>Пользователь имеет право: получать информацию об обработке своих данных; требовать уточнения, блокирования или уничтожения своих данных; отзывать согласие на обработку данных.</p>
                    <p><strong>7. Контакты</strong><br/>Для вопросов, связанных с обработкой данных, обращайтесь: valeriyacuzmina@gmail.com.</p>
                </div>
            </div>
            <div class="p-4 border-t border-gray-100">
                <button class="w-full btn-primary py-3" onclick="closePrivacy()">Закрыть</button>
            </div>
        </div>
    </div>
</body>
</html>
