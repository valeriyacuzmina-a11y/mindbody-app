<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>BodyWeek - –¢—Ä–µ–∫–µ—Ä –∑–∞–±–æ—Ç—ã –æ —Å–µ–±–µ</title>
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FF7DC2',
                        accent: '#D14E9E',
                        background: '#FAFAFB',
                        text: '#1C1C1E',
                    },
                    fontFamily: {
                        'manrope': ['Manrope', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    
    <!-- –°—Ç–∏–ª—å–Ω—ã–µ —à—Ä–∏—Ñ—Ç—ã -->
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0' stop-color='%23FF7DC2'/%3E%3Cstop offset='1' stop-color='%23D14E9E'/%3E%3C/linearGradient%3E%3C/defs%3E%3Ccircle cx='32' cy='32' r='28' fill='url(%23g)'/%3E%3C/svg%3E" />
    
    <style>
        body {
            font-family: 'Manrope', 'Inter', sans-serif;
            -webkit-tap-highlight-color: transparent;
            overscroll-behavior: none;
            background: linear-gradient(135deg, #FAFAFB 0%, #F8F9FF 50%, #F0F4FF 100%);
            position: relative;
            z-index: 0;
        }
        
        .section {
            display: none;
            position: relative;
            z-index: 1;
        }
        
        .section.active {
            display: block;
        }
        
        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π */
        .section.active {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        /* Main –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        main {
            position: relative;
            z-index: 1;
        }
        
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-out;
        }

        /* –ê–Ω–∏–º–∞—Ü–∏—è –ø–∞–¥–∞—é—â–∏—Ö —Å–µ—Ä–¥–µ—á–µ–∫ */
        .heart {
            position: fixed;
            font-size: 2rem;
            pointer-events: none;
            z-index: 10000;
            transition: top 2s ease-in;
        }


        
        .day-card {
            background: linear-gradient(135deg, #FFFFFF 0%, #FEFEFE 100%);
            border-radius: 0.875rem;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.9);
            padding: 0.375rem;
            transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            backdrop-filter: blur(8px);
            position: relative;
            z-index: 1;
        }
        
        /* –£–±–∏—Ä–∞–µ–º hover-–∞–Ω–∏–º–∞—Ü–∏—é —É –ø–ª–∞—à–µ–∫ –¥–Ω–µ–π */
        /* (hover —ç—Ñ—Ñ–µ–∫—Ç—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã —è–≤–Ω–æ –≤ HTML –∫–ª–∞—Å—Å–∞—Ö) */
        
        .btn-primary {
            background: linear-gradient(135deg, #E7B8D6 0%, #D86CB3 100%);
            color: white;
            font-weight: 600;
            padding: 0.75rem 1.5rem;
            border-radius: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(216, 108, 179, 0.3);
            border: none;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(216, 108, 179, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #F8F9FA 0%, #F1F3F4 100%);
            color: #1C1C1E;
            font-weight: 500;
            padding: 0.75rem 1.5rem;
            border-radius: 1rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #F1F3F4 0%, #E8EAED 100%);
            transform: translateY(-1px);
        }
        
        .chart-bar {
            background: linear-gradient(to top, #FF7DC2, #D14E9E);
            border-radius: 0.5rem 0.5rem 0 0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 2px 8px rgba(216, 108, 179, 0.2);
        }
        
        .chart-bar:hover {
            transform: scaleY(1.05);
            box-shadow: 0 4px 12px rgba(216, 108, 179, 0.3);
        }
        
        

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è –≤–Ω–∏–∑—É */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            z-index: 50;
            padding: 0.5rem 0;
        }
        
        .nav-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0.5rem 0.75rem;
            border-radius: 0.75rem;
            transition: all 0.2s ease;
            cursor: pointer;
            min-width: 4rem;
        }
        
        .nav-btn.active {
            background: linear-gradient(135deg, #FF7DC2 0%, #D14E9E 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(216, 108, 179, 0.3);
        }
        
        .nav-btn.active span {
            color: white;
            font-weight: 600;
        }
        
        .nav-btn.active .nav-icon {
            background: linear-gradient(135deg, #FFFFFF 0%, #F8F9FF 100%);
            transform: scale(1.1);
        }
        
        .nav-btn:not(.active):hover {
            background: rgba(231, 184, 214, 0.1);
            transform: translateY(-1px);
        }
        
        .nav-icon {
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 0.25rem;
            transition: all 0.2s ease;
            background: linear-gradient(135deg, #FFFFFF 0%, #FFE6F2 100%);
            border: 1px solid #FAD3E6;
            box-shadow: 0 2px 6px rgba(209, 78, 158, 0.15);
            color: #D14E9E;
        }
        
        /* –ú–æ–±–∏–ª—å–Ω–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è */
        @media (max-width: 640px) {
            .day-card {
                padding: 0.75rem;
            }
            
            .bottom-nav {
                padding-bottom: max(0.5rem, env(safe-area-inset-bottom));
            }
        }
        
        /* –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞ –¥–ª—è iPhone */
        @supports (padding: max(0px)) {
            .bottom-nav {
                padding-bottom: max(0.5rem, env(safe-area-inset-bottom));
            }
        }
        
        /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –¥–ª—è –ø–ª–∞—à–µ–∫ */
        .activity-plate, .time-plate {
            min-height: 64px !important;
            height: auto !important;
        }
        
        .time-plate {
            min-width: 72px !important;
        }
        
        @media (min-width: 640px) {
            .activity-plate, .time-plate {
                min-height: 72px !important;
                height: auto !important;
            }
            
            .time-plate {
                min-width: 84px !important;
            }
        }

        /* –ù–µ–¥–µ–ª—è: –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Å—Ç—Ä–µ–ª–∫–∞–º–∏ –∏ –º–µ—Ç–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ */
        .week-nav { display:flex; align-items:center; justify-content:center; gap:8px; }
        .week-btn { width:32px; height:32px; border-radius:999px; border:0; background:#fff; box-shadow:0 1px 4px rgba(0,0,0,.08); font-size:20px; line-height:32px; }
        .week-btn:active { transform:scale(.96); }
        .week-label { font-weight:700; font-size:22px; }

        /* –ü–æ–¥—Å–∫–∞–∑–∫–∞ —Ñ–∞–∑—ã: –∫—Ä—É–ø–Ω–µ–µ –∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞—è */
        .cycle-hint { display:flex; align-items:center; gap:8px; padding:10px 12px; border-radius:12px; background:rgba(255,255,255,.7); cursor:pointer; justify-content:center; }
        .cycle-text { font-size:16px; font-weight:600; text-decoration:none; }
        .cycle-hint:hover .cycle-text { text-decoration:underline; }

        /* –ë–æ–ª—å—à–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –æ—Ç—Å—Ç—É–ø–æ–≤ —É –ø–ª–∞—à–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π */
        .activity-plate {
            padding: 0.75rem 1rem !important;
        }

        /* –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: –ø–µ—Ä–µ–Ω–æ—Å –ø–æ —Å—Ç—Ä–æ–∫–∞–º –≤–Ω—É—Ç—Ä–∏ –ø–ª–∞—à–∫–∏ */
        [id$="-activities"] {
            display: flex !important;
            flex-wrap: wrap !important;
            align-items: center !important;
            gap: 0.25rem 0.75rem !important;
        }
        .activity-item { white-space: nowrap !important; font-size: 0.875rem !important; }
        
        /* –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–∏—Ö –º–µ–Ω—é */
        .flex-1.relative {
            position: relative !important;
            z-index: 1 !important;
        }
        
        /* –ü–æ–¥—Å–∫–∞–∑–∫–∏ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–≤–µ—Ä—Ö –≤—Å–µ–≥–æ */
        [id$="-suggestions"] {
            position: fixed !important;
            z-index: 100000 !important;
            background: #fff !important;
            border: 1px solid #E5E7EB !important;
            border-radius: 8px !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
            max-height: 280px !important;
            overflow-y: auto !important;
            transform: translateZ(0) !important;
            will-change: transform !important;
            isolation: isolate !important;
            padding: 4px 0 !important;
        }

        /* –ü–æ—Ä—Ç–∞–ª –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫: —Ä–µ–Ω–¥–µ—Ä–∏–º –≤ <body> –ø–æ–≤–µ—Ä—Ö –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
        #activity-suggestions-portal {
            position: fixed !important;
            z-index: 100000 !important;
            background: #fff !important;
            border: 1px solid #E5E7EB !important;
            border-radius: 8px !important;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15) !important;
            max-height: 280px !important;
            overflow-y: auto !important;
            padding: 4px 0 !important;
        }
        
        
        
        /* Footer –∏ –¥—Ä—É–≥–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –º–µ–Ω—é */
        footer, .space-y-3 > div:last-child {
            position: relative;
            z-index: 1;
        }
        

        
        
        /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ –ø–ª—é—Å/–º–∏–Ω—É—Å */
        button[onclick*="removeTime"], button[onclick*="addTime"] {
            width: 1.25rem !important;
            height: 1.25rem !important;
            border-radius: 50% !important;
            min-width: 1.25rem !important;
            min-height: 1.25rem !important;
            max-width: 1.25rem !important;
            max-height: 1.25rem !important;
        }
        
        @media (min-width: 640px) {
            button[onclick*="removeTime"], button[onclick*="addTime"] {
                width: 1.5rem !important;
                height: 1.5rem !important;
                min-width: 1.5rem !important;
                min-height: 1.5rem !important;
                max-width: 1.5rem !important;
                max-height: 1.5rem !important;
            }
        }
        
        
        
        /* –ö–æ–º–ø–∞–∫—Ç–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–Ω–µ–π */
            .day-card h3 {
                font-size: 1.5rem !important;
                line-height: 2rem !important;
        }
        
        @media (min-width: 640px) {
            .day-card h3 {
                font-size: 1.75rem !important;
                line-height: 2.25rem !important;
            }
        }
        
        
        
        /* –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∫—Ä—É–≥–ª—ã–µ –∫–Ω–æ–ø–∫–∏ */
        button[onclick*="removeTime"], button[onclick*="addTime"] {
            aspect-ratio: 1 / 1 !important;
            flex-shrink: 0 !important;
            flex-grow: 0 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }
        
        /* –£–±–∏—Ä–∞–µ–º –ª—é–±—ã–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–ª–∏—è—Ç—å –Ω–∞ —Ñ–æ—Ä–º—É */
        button[onclick*="removeTime"] *, button[onclick*="addTime"] * {
            border-radius: 0 !important;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–∏–æ–¥–∞ –≥—Ä–∞—Ñ–∏–∫–∞ */
        .chart-period-btn {
            transition: all 0.2s ease;
        }
        
        .chart-period-btn.active {
            background: linear-gradient(135deg, #FF7DC2 0%, #D14E9E 100%);
            color: white;
            font-weight: 600;
        }

        /* ===== –û –ü–†–ò–õ–û–ñ–ï–ù–ò–ò ===== */
        .about-hero {
            position: relative;
            background: linear-gradient(135deg, rgba(255,125,194,0.18), rgba(209,78,158,0.12));
            border-radius: 24px;
            overflow: hidden;
            padding-top: 40px !important;
            padding-bottom: 40px !important;
        }
        /* –£–±–∏—Ä–∞–µ–º —Ñ–æ–Ω-–∞—Ä—Ç-—Å–ª–æ–≤–æ –≤ hero */
        .about-hero::before { content: none !important; }
        /* –î–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –º—è–≥–∫–∏–µ –±–ª–æ–±—ã –≤ hero (–±–µ–∑ JS) */
        .about-blob { position:absolute; border-radius:9999px; filter: blur(30px); opacity:.5; pointer-events:none; }
        .about-blob-1 { width:240px; height:240px; top:-40px; left:-20px; background: radial-gradient(circle at 30% 30%, rgba(255,125,194,.45), rgba(209,78,158,.25)); }
        .about-blob-2 { width:280px; height:280px; right:-30px; bottom:-50px; background: radial-gradient(circle at 70% 50%, rgba(209,78,158,.35), rgba(255,125,194,.25)); }

        /* –ö–∞—Ä—É—Å–µ–ª—å —Ñ–∞–∫—Ç–æ–≤: –ø—Ä–æ—Å—Ç–æ–π –∏ –Ω–∞–¥—ë–∂–Ω—ã–π scroll-snap */
        .about-carousel { display:flex; gap:12px; overflow-x:auto; scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; padding:6px 2px; }
        .about-carousel::-webkit-scrollbar { display:none; }
        .about-carousel { scrollbar-width:none; }
        .about-science-item { flex:0 0 86%; scroll-snap-align:center; background:#fff; border:1px solid rgba(209,78,158,0.12); border-radius:20px; box-shadow:0 8px 18px rgba(0,0,0,0.08); padding:18px; font-size:15px; font-weight:600; line-height:1.35; }
        @media (min-width: 640px){ .about-science-item { flex-basis:70%; font-size:16px; } }

        /* –ï–¥–∏–Ω—ã–π hover –¥–ª—è –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤ */
        .about-principle-card { background:#fff; border:1px solid rgba(209,78,158,0.12); box-shadow:0 6px 16px rgba(0,0,0,0.06); transition: transform .15s ease, box-shadow .15s ease; }
        .about-principle-card:hover { transform: translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,0.09); }
        .about-arrow {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            color: #D14E9E;
            font-weight: 600;
            cursor: pointer;
        }
        .about-card {
            background: #fff;
            border: 1px solid rgba(209,78,158,0.12);
            border-radius: 16px;
            box-shadow: 0 6px 16px rgba(0,0,0,0.06);
            padding: 20px;
        }
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ä–∞–∑–¥–µ–ª–∞ –ø–æ–¥ hero */
        .about-caption { text-transform: uppercase; font-size: 12px; letter-spacing: .04em; color: #6B7280; }

        /* –ü—Ä–∏–Ω—Ü–∏–ø—ã: –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .about-principle-card { aspect-ratio: 1 / 1; display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; border-radius:20px; padding:16px; }

        /* –ò–Ω—Ñ–æ–≥—Ä–∞—Ñ–∏–∫–∞ 3 —à–∞–≥–∞ */
        .about-steps { display: grid; grid-template-columns: 1fr; gap: 20px; }
        @media (min-width: 640px){ .about-steps { grid-template-columns: 1fr 1fr 1fr; } }
        .about-step { display:flex; align-items:center; gap:12px; background:#fff; border-radius:16px; border:1px solid rgba(209,78,158,0.12); box-shadow:0 6px 16px rgba(0,0,0,0.06); padding:16px; }
        .about-step-icon { width:40px; height:40px; border-radius:999px; display:flex; align-items:center; justify-content:center; background:rgba(255,125,194,0.18); color:#D14E9E; font-size:18px; font-weight:700; }
        .about-step-text { font-size:14px; line-height:1.35; font-weight:600; }

        /* –ù–∞—É–∫–∞: –æ–¥–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞ —Å –∫–ª–∏–∫–æ–º */
        .about-science-card { background:#fff; border:1px solid rgba(209,78,158,0.12); border-radius:20px; box-shadow:0 8px 18px rgba(0,0,0,0.08); padding:20px; cursor:pointer; transition:opacity 0.18s ease, transform 0.15s ease; display:flex; align-items:center; justify-content:center; text-align:center; font-size:16px; font-weight:600; min-height: 260px; aspect-ratio: 1 / 1; }
        .about-science-card:hover { transform: translateY(-2px); box-shadow:0 10px 22px rgba(0,0,0,0.09); }
        .about-science-card.fade { opacity:0.15; }

        /* –ì–ª–æ–±–∞–ª—å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è (–≤–∏–¥–Ω–∞ –Ω–∞ –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–∞—Ö) */
        .profile-fab { position: fixed; top: 12px; right: 12px; z-index: 60; width: 40px; height: 40px; border-radius: 999px; display:flex; align-items:center; justify-content:center; background: linear-gradient(135deg, #FF7DC2, #D14E9E); color:#fff; box-shadow: 0 6px 16px rgba(209,78,158,0.35); }

        /* –û–±—ä—ë–º–Ω–∞—è –∫—Ä—É–≥–ª–∞—è –∫–Ω–æ–ø–∫–∞-—Å—é—Ä–ø—Ä–∏–∑ */
        .wish-btn {
            background: radial-gradient(120% 120% at 20% 20%, #FF7DC2 0%, #E15CA8 45%, #D14E9E 100%);
            box-shadow: 0 12px 24px rgba(209, 78, 158, 0.35), inset 0 2px 6px rgba(255,255,255,0.4);
            border: none;
        }

        /* –¢–æ—Å—Ç —Å –ø–æ–∂–µ–ª–∞–Ω–∏–µ–º */
        .wish-toast {
            position: fixed;
            left: 50%;
            bottom: 20px;
            transform: translateX(-50%);
            z-index: 100000;
            background: rgba(255, 255, 255, 0.98);
            color: #1C1C1E;
            border: 1px solid #F3E0EE;
            border-radius: 14px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            padding: 10px 12px;
            max-width: min(92vw, 420px);
            font-size: 13px;
        }

        /* –ö—Ä—É–ø–Ω—ã–π –±–ª–æ–∫ –ø–æ–∂–µ–ª–∞–Ω–∏—è –¥–ª—è —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ */
        .wish-inline-card {
            background: #fff;
            color: #1C1C1E;
            border: 1px solid #F3E0EE;
            border-radius: 16px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.10);
            padding: 16px 18px;
            margin: 0 auto;
            max-width: 92%;
            font-size: 18px;
            line-height: 1.5;
            text-align: center;
        }
        @media (min-width: 640px) {
            .wish-inline-card {
                font-size: 20px;
                padding: 18px 22px;
                max-width: 560px;
            }
        }

        /* Design system tokens */
        :root { --radius-card:16px; --radius-button:16px; --icon-size:20px; --chip-padding:8px 12px; }
        .rounded-card { border-radius: var(--radius-card); }
        .rounded-button { border-radius: var(--radius-button); }
        .icon-md { width: var(--icon-size); height: var(--icon-size); }
        .chip { padding: var(--chip-padding); border-radius: 999px; border:1px solid #E5E7EB; background:#F9FAFB; font-size: 14px; line-height:1.2; }
        .chip.active { border-color: #FAD3E6; box-shadow: 0 2px 8px rgba(209, 78, 158, 0.15); background:#FFF; }
        .btn-primary { border-radius: var(--radius-button); }
        .about-card, .about-principle-card, .about-science-item { border-radius: var(--radius-card); }
        .nav-icon svg { width: var(--icon-size); height: var(--icon-size); }
        .nav-icon { color:#D14E9E; }
        .bottom-nav .nav-btn span { font-size: 12px; }
        /* Equal height for principle tiles */
        #about-facts .about-principle-card { min-height: 160px; }
        /* Carousel padding */
        .about-carousel { padding-left: 12px; padding-right: 12px; }
        #about-dots span { width:8px !important; height:8px !important; border-radius:999px; }
        /* Chart labels */
        #chart-container { padding-top: 6px; }
        /* Activity items wrap */
        [id$="-activities"] { overflow-x: visible !important; white-space: normal !important; }
        /* Larger touch targets for plus/minus */
        button[onclick*="removeTime"], button[onclick*="addTime"] { width: 40px !important; height: 40px !important; }
        /* FAB safe-area */
        .profile-fab { top: max(12px, env(safe-area-inset-top)); right: max(12px, env(safe-area-inset-right)); }
    </style>
</head>
<body class="bg-background text-text min-h-screen">


    <!-- Main Content -->
    <main class="pt-4 pb-20">
        <!-- Floating Profile Button visible everywhere -->
        <button id="profile-fab" class="profile-fab" aria-label="–ü—Ä–æ—Ñ–∏–ª—å">
            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="#FFFFFF" xmlns="http://www.w3.org/2000/svg">
                <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-3.31 0-8 1.66-8 5v1h16v-1c0-3.34-4.69-5-8-5z"/>
            </svg>
        </button>
        
        <!-- –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ Section -->
        <section id="about-section" class="section p-3 sm:p-4 space-y-8">
            <!-- Hero -->
            <div class="about-hero p-6 sm:p-8 relative">
                <div class="about-blob about-blob-1"></div>
                <div class="about-blob about-blob-2"></div>
                <div class="max-w-xl mx-auto text-left">
                    <p class="text-2xl sm:text-3xl font-extrabold text-text leading-[1.35] mb-4">—Ç—ã –∑–∞–¥—É–º—ã–≤–∞–ª–∞—Å—å, —Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤ —É–¥–µ–ª—è–µ—à—å —Ä–∞–±–æ—Ç–µ, –∞ —Å–∫–æ–ª—å–∫–æ —Å–≤–æ–µ–º—É —Ç–µ–ª—É?</p>
                    <p class="text-base sm:text-lg text-text leading-[1.35]">–ü–ª–∞–Ω–∏—Ä—É–π —á–∞—Å—ã —Ç–µ–ª–µ—Å–Ω–æ—Å—Ç–∏, –∏ –Ω–∞–±–ª—é–¥–∞–π, —Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —Ç—ã –ø–æ–¥–∞—Ä–∏–ª–∞ —Å–µ–±–µ</p>
                </div>
            </div>

            <!-- –§–∞–∫—Ç—ã -->
            <div class="max-w-xl mx-auto text-left">
                <h2 class="text-xl sm:text-2xl font-extrabold text-text mt-2">–ú–µ–Ω—è–µ–º –ø–æ–¥—Ö–æ–¥</h2>
            </div>
            
            <div id="about-facts" class="grid grid-cols-2 sm:grid-cols-2 gap-4">
                <div class="about-card about-principle-card">
                    <h3 class="font-semibold text-text mb-2 text-[18px]">–ì–ª–∞–≤–Ω–æ–µ ‚Äî –¥–≤–∏–≥–∞—Ç—å—Å—è</h3>
                    <p class="text-[14px] text-gray-700">–ö–∞–∂–¥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ –≤–∞–∂–Ω–µ–µ —Ü–∏—Ñ—Ä. –î–∞–∂–µ 30 –º–∏–Ω—É—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ‚Äî —ç—Ç–æ —É–∂–µ —Ç–≤–æ–∏ 30 –º–∏–Ω—É—Ç.</p>
                </div>
                <div class="about-card about-principle-card">
                    <h3 class="font-semibold text-text mb-2 text-[18px]">–†–æ—Å—Ç –∏ —Å–ø–∞–¥ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ</h3>
                    <p class="text-[14px] text-gray-700">–¢—ã –Ω–µ –æ–±—è–∑–∞–Ω–∞ —Ä–∞—Å—Ç–∏ –ø–æ —ç–∫—Å–ø–æ–Ω–µ–Ω—Ç–µ. –ì–ª–∞–≤–Ω–æ–µ ‚Äî –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å.</p>
                </div>
                <div class="about-card about-principle-card">
                    <h3 class="font-semibold text-text mb-2 text-[18px]">–¶–∏—Ñ—Ä—ã –æ—Ç–≤–ª–µ–∫–∞—é—Ç</h3>
                    <p class="text-[14px] text-gray-700">–ì–ª–∞–≤–Ω–æ–µ –Ω–µ —Ü–∏—Ñ—Ä—ã, –∞ —Ç–≤–æ—ë —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å.</p>
                </div>
                <div class="about-card about-principle-card">
                    <h3 class="font-semibold text-text mb-2 text-[18px]">–§–∞–∑–∞ —Ü–∏–∫–ª–∞ ‚Äî —á–∞—Å—Ç—å –∏–≥—Ä—ã</h3>
                    <p class="text-[14px] text-gray-700">–ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∏—Ç–º —Ü–∏–∫–ª–∞, –∞ –Ω–µ –ø–æ–¥—á–∏–Ω—è–µ–º—Å—è –µ–≥–æ –ø—Ä–∞–≤–∏–ª–∞–º.</p>
                </div>
            </div>

            <!-- –ß—Ç–æ –¥–µ–ª–∞—Ç—å –∑–¥–µ—Å—å -->
            

            <!-- –ù–∞—É–∫–∞: –ø—Ä–æ—Å—Ç–∞—è –∫–∞—Ä—É—Å–µ–ª—å -->
            <div class="space-y-3">
                <h2 class="text-xl sm:text-2xl font-extrabold text-text mt-2">–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –Ω–∞—É–∫–∞?</h2>
                <div class="about-carousel" id="about-carousel">
                    <!-- items will be injected from aboutFacts on DOMContentLoaded -->
                </div>
                <div id="about-dots" class="flex justify-center gap-2 mt-1"></div>
            </div>

            <!-- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ -->
            <div class="text-center">
                <button id="about-cta" class="wish-btn inline-flex items-center justify-center rounded-full px-7 py-4 text-white font-bold text-base shadow-lg transition-all duration-150 active:scale-95">–°–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–≤—É—é –Ω–µ–¥–µ–ª—é</button>
            </div>
        </section>
        <!-- –¢–≤–æ—è –Ω–µ–¥–µ–ª—è Section -->
        <section id="week-section" class="section active p-3 sm:p-4 space-y-3">
            <!-- Header -->
            <header class="text-center space-y-2 relative">
                <div class="week-nav">
                    <button class="week-btn prev" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è">‚Äπ</button>
                    <span id="weekLabel" class="week-label">19 ‚Äì 25 –∞–≤–≥</span>
                    <button class="week-btn next" aria-label="–°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è">‚Ä∫</button>
                </div>
                
                
                <!-- Phase Hint -->
                <div id="cycleHint" class="cycle-hint">
                    <span class="cycle-emoji">ü©∏</span>
                    <span class="cycle-text">–ó–∞–±–æ—Ç–∞. –û—Ç–¥—ã—Ö. –ü–ª–∞–≤–Ω–æ—Å—Ç—å</span>
                </div>
            </header>

            <!-- Day Cards -->
            <div class="space-y-2 sm:space-y-3">
                <!-- –ü–ù -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <!-- –°–ª–µ–≤–∞: –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ -->
                        <div class="flex-shrink-0">
                            <h3 class="text-xl sm:text-2xl font-bold text-text">–ü–ù</h3>
                        </div>
                        
                        <!-- –ü–æ —Ü–µ–Ω—Ç—Ä—É: –ü–ª–∞—à–∫–∞ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—è–º–∏ -->
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-1.5 sm:p-2 border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <!-- –ü–ª—é—Å –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
                                    <button id="monday-plus-btn" onclick="toggleActivityInput('monday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">
                                        +
                                    </button>
                                    
                                    <!-- –í—ã–±—Ä–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ -->
                                    <div id="monday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide">
                                        <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —Å—é–¥–∞ -->
                                    </div>
                                </div>
                                
                                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º -->
                                <div id="monday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="monday-activity-field" 
                                           placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('monday', this.value)"
                                           onkeydown="handleActivityKeydown('monday', event)">
                                    <div id="monday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- –°–ø—Ä–∞–≤–∞: –ü–ª–∞—à–∫–∞ —Å –≤—Ä–µ–º–µ–Ω–µ–º -->
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="monday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">—á</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('monday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">
                                        ‚àí
                                    </button>
                                    <button onclick="addTime('monday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">
                                        +
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –í–¢ -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">–í–¢</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="tuesday-plus-btn" onclick="toggleActivityInput('tuesday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">
                                        +
                                    </button>
                                    <div id="tuesday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º -->
                                <div id="tuesday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="tuesday-activity-field" 
                                           placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('tuesday', this.value)"
                                           onkeydown="handleActivityKeydown('tuesday', event)">
                                    <div id="tuesday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="tuesday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">—á</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('tuesday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">‚àí</button>
                                    <button onclick="addTime('tuesday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –°–† -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">–°–†</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="wednesday-plus-btn" onclick="toggleActivityInput('wednesday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="wednesday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º -->
                                <div id="wednesday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="wednesday-activity-field" 
                                           placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('wednesday', this.value)"
                                           onkeydown="handleActivityKeydown('wednesday', event)">
                                    <div id="wednesday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="wednesday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">—á</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('wednesday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">‚àí</button>
                                    <button onclick="addTime('wednesday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ß–¢ -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">–ß–¢</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="thursday-plus-btn" onclick="toggleActivityInput('thursday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="thursday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º -->
                                <div id="thursday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="thursday-activity-field" 
                                           placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('thursday', this.value)"
                                           onkeydown="handleActivityKeydown('thursday', event)">
                                    <div id="thursday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="thursday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">—á</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('thursday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">‚àí</button>
                                    <button onclick="addTime('thursday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ü–¢ -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">–ü–¢</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="friday-plus-btn" onclick="toggleActivityInput('friday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="friday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º -->
                                <div id="friday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="friday-activity-field" 
                                           placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('friday', this.value)"
                                           onkeydown="handleActivityKeydown('friday', event)">
                                    <div id="friday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="friday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">—á</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('friday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">‚àí</button>
                                    <button onclick="addTime('friday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –°–ë -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">–°–ë</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="saturday-plus-btn" onclick="toggleActivityInput('saturday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="saturday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º -->
                                <div id="saturday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="saturday-activity-field" 
                                           placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('saturday', this.value)"
                                           onkeydown="handleActivityKeydown('saturday', event)">
                                    <div id="saturday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="saturday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">—á</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('saturday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">‚àí</button>
                                    <button onclick="addTime('saturday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –í–° -->
                <div class="day-card">
                    <div class="flex items-center space-x-3">
                        <div class="flex-shrink-0">
                            <h3 class="text-2xl sm:text-3xl font-bold text-text">–í–°</h3>
                        </div>
                        <div class="flex-1 relative">
                            <div class="bg-gray-50 rounded-xl p-2 sm:p-3 min-h-[70px] sm:min-h-[80px] border-2 border-primary activity-plate">
                                <div class="flex items-center space-x-2 sm:space-x-3">
                                    <button id="sunday-plus-btn" onclick="toggleActivityInput('sunday')" class="w-12 h-12 sm:w-14 sm:h-14 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-2xl sm:text-3xl font-bold transition-colors flex-shrink-0">+</button>
                                    <div id="sunday-activities" class="flex items-center space-x-2 overflow-x-auto whitespace-nowrap scrollbar-hide"></div>
                                </div>
                                <!-- –ü–æ–ª–µ –≤–≤–æ–¥–∞ —Å –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ–º -->
                                <div id="sunday-activity-input" class="hidden mt-2">
                                    <input type="text" 
                                           id="sunday-activity-field" 
                                           placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å..." 
                                           class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                                           oninput="filterActivities('sunday', this.value)"
                                           onkeydown="handleActivityKeydown('sunday', event)">
                                    <div id="sunday-suggestions" class="mt-1 max-h-32 overflow-y-auto bg-white border border-gray-200 rounded-lg shadow-lg hidden">
                                        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="flex-shrink-0">
                            <div class="bg-accent/10 rounded-xl p-2 sm:p-3 border-2 border-accent min-w-[70px] sm:min-w-[80px] text-center time-plate">
                                <div class="flex items-center justify-center space-x-1 mb-1">
                                    <div class="text-xl sm:text-2xl font-bold text-accent" id="sunday-time">0</div>
                                    <div class="text-xs sm:text-sm text-accent">—á</div>
                                </div>
                                <div class="flex items-center justify-center space-x-1 sm:space-x-2">
                                    <button onclick="removeTime('sunday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-gray-400 hover:bg-gray-500 text-white rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">‚àí</button>
                                    <button onclick="addTime('sunday')" class="w-7 h-7 sm:w-8 sm:h-8 bg-pink-200 hover:bg-pink-300 text-pink-800 rounded-full flex items-center justify-center text-sm sm:text-lg font-bold transition-colors">+</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <div class="space-y-3">
                            <!-- –ò—Ç–æ–≥–æ -->
                            <div class="bg-gradient-to-r from-pink-50 to-purple-50 rounded-2xl shadow-lg border border-pink-100 p-4 text-center">
                <h3 class="text-xl font-bold text-accent" id="total-display">
                    –ò—Ç–æ–≥–æ: 0 —á –¥–ª—è —Å–µ–±—è!
                </h3>
            </div>

                <!-- –ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ -->
                <div class="bg-gradient-to-br from-white to-blue-50 rounded-2xl shadow-lg border border-blue-100 p-4">
                    <h3 class="text-lg font-semibold text-text mb-3 text-center">–ö–∞–∫ —Ç—ã —Å–µ–≥–æ–¥–Ω—è?</h3>
                    <div class="flex justify-center space-x-3">
                        <button onclick="startTodayFlow('excellent', event)" class="flex-1 chip">
                            üòÄ –û—Ç–ª–∏—á–Ω–æ
                        </button>
                        <button onclick="startTodayFlow('ok', event)" class="flex-1 chip">
                            üôÇ –ù–æ—Ä–º–∞–ª—å–Ω–æ
                        </button>
                        <button onclick="startTodayFlow('bad', event)" class="flex-1 chip">
                            üôÅ –ù–µ –æ—á–µ–Ω—å
                        </button>
                    </div>
                    <div id="today-questions" class="mt-4 hidden"></div>
                    <div id="today-reco" class="mt-3 hidden"></div>
                </div>


            </div>
        </section>

        <!-- –¶–∏–∫–ª Section -->
        <section id="cycle-section" class="section p-3 sm:p-4 space-y-4">
            <header class="text-center space-y-2">
                <h1 class="text-xl sm:text-2xl font-bold text-text">–¶–∏–∫–ª</h1>
            </header>
            <div class="bg-gradient-to-br from-white to-pink-50 rounded-2xl p-6 border border-pink-100 shadow-lg max-w-xl mx-auto space-y-5">
                <div class="text-left space-y-1">
                    <div class="text-sm uppercase tracking-wide text-gray-500">—Ç–≤–æ—è —Ñ–∞–∑–∞ —Ü–∏–∫–ª–∞</div>
                    <div id="cycle-phase-name" class="text-2xl font-extrabold text-accent">‚Äì</div>
                    <div id="cycle-phase-key" class="text-base font-semibold text-text">–ü–µ—Ä–µ–π–¥–∏ –≤ –ü—Ä–æ—Ñ–∏–ª—å –∏ –∑–∞–ø–æ–ª–Ω–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Å–≤–æ—é —Ñ–∞–∑—É —Ü–∏–∫–ª–∞.</div>
                </div>
                <div class="text-left space-y-3">
                    <h3 class="text-lg font-bold text-text">–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ç–µ–ª–µ?</h3>
                    <div id="cycle-body" class="text-sm text-gray-800 leading-relaxed">‚Äì</div>
                </div>
                <div class="text-left space-y-3">
                    <h3 class="text-lg font-bold text-text">–ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–µ–±—è?</h3>
                    <div id="cycle-impact" class="text-sm text-gray-800 leading-relaxed">‚Äì</div>
                </div>
                <div class="text-left space-y-3">
                    <h3 class="text-lg font-bold text-text">–ß—Ç–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞—Ç—å</h3>
                    <div id="cycle-actions" class="grid grid-cols-2 gap-2"></div>
                </div>
            </div>
        </section>

        <!-- –¢—Ä–µ–∫–µ—Ä –∑–∞–±–æ—Ç—ã Section -->
        <section id="tracker-section" class="section p-3 sm:p-4 space-y-4">
            <!-- Header -->
            <header class="text-center space-y-3 mt-2">
                <h1 class="text-2xl sm:text-3xl font-extrabold text-text leading-tight">
                    –°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ —Ç—ã<br>–ø–æ–¥–∞—Ä–∏–ª–∞ —Å–µ–±–µ
                </h1>
            </header>

            <!-- Stats Cards -->
            <div class="grid grid-cols-2 gap-4">
                <div class="bg-gradient-to-br from-pink-50 to-rose-50 rounded-2xl shadow-lg border border-pink-100 p-5 text-center">
                    <h3 class="text-sm text-gray-600 mb-2 font-medium">–ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ –¥–ª—è —Å–µ–±—è</h3>
                    <p class="text-3xl font-bold text-accent" id="current-week-hours">0 —á</p>
                </div>
                <div class="bg-gradient-to-br from-purple-50 to-indigo-50 rounded-2xl shadow-lg border border-purple-100 p-5 text-center">
                    <h3 class="text-sm text-gray-600 mb-2 font-medium">–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è</h3>
                    <p class="text-3xl font-bold text-accent" id="total-hours">0 —á</p>
                </div>
            </div>

            <!-- Toggle Buttons -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-3">
                <div class="flex bg-gray-100 rounded-lg p-1">
                    <button onclick="setChartPeriod('weeks', event)" class="flex-1 py-2 px-3 text-sm font-medium rounded-md transition-colors chart-period-btn active" data-period="weeks">
                        –ù–µ–¥–µ–ª–∏
                    </button>
                    <button onclick="setChartPeriod('months', event)" class="flex-1 py-2 px-3 text-sm font-medium rounded-md transition-colors chart-period-btn" data-period="months">
                        –ú–µ—Å—è—Ü—ã
                    </button>
                </div>
            </div>

            <!-- Chart -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-4">
                <div id="chart-container" class="flex items-end justify-between space-x-1 h-36">
                    <!-- –ì—Ä–∞—Ñ–∏–∫ –±—É–¥–µ—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
            </div>

            <!-- Bonus Card -->
            <div class="bg-gradient-to-br from-pink-100 via-purple-50 to-blue-100 rounded-2xl p-6 border border-pink-200 shadow-xl">
                <div class="text-center space-y-4">
                    <div id="wish-inline-container">
                        <button id="wish-button" onclick="showInlineWish()" class="wish-btn inline-flex items-center justify-center rounded-full w-36 h-36 text-white font-bold text-base shadow-lg transition-all duration-150 active:scale-95">
                             –¢–∫–Ω–∏ –Ω–∞ –º–µ–Ω—è
                         </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- –ü—Ä–æ—Ñ–∏–ª—å Section -->
        <section id="profile-section" class="section p-3 sm:p-4 space-y-4">
            <!-- Header -->
            <header class="text-center space-y-3">
                <h1 class="text-xl sm:text-2xl font-bold text-text">
                    –ü—Ä–æ—Ñ–∏–ª—å
                </h1>
            </header>

            <!-- Profile Form -->
            <div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-4 space-y-3">
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?</label>
                        <input type="text" id="profile-name" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">–û–±—ã—á–Ω–æ —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –¥–ª–∏—Ç—Å—è –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏—è?</label>
                        <input type="number" id="m-length" placeholder="5" min="3" max="7" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">–ö–æ–≥–¥–∞ –Ω–∞—á–∞–ª–∏—Å—å —Ç–≤–æ–∏ –ø–æ—Å–ª–µ–¥–Ω–∏–µ –º–µ—Å—è—á–Ω—ã–µ?</label>
                        <input type="date" id="cycle-start" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">–í —Å—Ä–µ–¥–Ω–µ–º —Ç–≤–æ–π —Ü–∏–∫–ª –¥–ª–∏—Ç—Å—è ‚Ä¶ –¥–Ω–µ–π</label>
                        <input type="number" id="cycle-length" placeholder="28" min="21" max="35" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm">
                    </div>
                </div>
                <div class="flex space-x-3 mb-2">
                    <button id="save-profile-btn" onclick="saveProfile()" class="flex-1 btn-primary py-3">–ì–æ—Ç–æ–≤–æ</button>
                    <button id="edit-profile-btn" onclick="editProfile()" class="flex-1 bg-gray-300 text-gray-600 font-medium py-3 px-4 rounded-[16px] transition-colors" disabled>–ü–æ–ø—Ä–∞–≤–∏—Ç—å</button>
                </div>
            </div>

            <!-- Email Auth -->
            <div class="hidden bg-gradient-to-br from-pink-50 to-rose-50 rounded-2xl shadow-sm border border-pink-100 p-6 max-w-xl mx-auto space-y-3">
                <h2 class="text-lg font-bold text-text">–í—Ö–æ–¥ –ø–æ –ø–æ—á—Ç–µ</h2>
                <p class="text-sm text-gray-600">–ú—ã –æ—Ç–ø—Ä–∞–≤–∏–º –∫–æ–¥ –Ω–∞ —Ç–≤–æ—é –ø–æ—á—Ç—É</p>
                <input id="auth-email" type="email" placeholder="you@example.com" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent text-sm" />
                <p class="text-xs text-gray-600 mt-1">–ü—Ä–æ–¥–æ–ª–∂–∞—è, –≤—ã —Å–æ–≥–ª–∞—à–∞–µ—Ç–µ—Å—å —Å –Ω–∞—à–µ–π <button type="button" class="underline text-accent" onclick="openPrivacy()">–ü–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</button></p>
                <div class="grid grid-cols-6 gap-2">
                    <input id="code-1" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-2" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-3" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-4" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-5" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                    <input id="code-6" maxlength="1" class="text-center border border-gray-300 rounded-lg py-2" />
                </div>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="requestLoginCode()" class="w-full btn-primary py-3">–ü–æ–ª—É—á–∏—Ç—å –∫–æ–¥</button>
                    <button onclick="confirmLoginCode()" class="w-full bg-gray-900 text-white py-3 rounded-[16px]">–í–æ–π—Ç–∏</button>
                </div>
                <button onclick="logout()" id="logout-btn" class="hidden w-full bg-gray-200 text-text py-2 rounded-[16px]">–í—ã–π—Ç–∏</button>
                <p id="auth-status" class="text-center text-sm text-gray-600"></p>
            </div>

            <!-- Phase info —É–¥–∞–ª—ë–Ω –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è: —Ñ–∞–∑–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–¶–∏–∫–ª" -->

            <!-- Profile Actions moved above -->
        </section>
    </main>

    <nav class="bottom-nav">
        <div class="flex justify-around items-center max-w-md mx-auto">
            <button onclick="showSection('week')" class="nav-btn active">
                <div class="nav-icon">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M5 3a2 2 0 00-2 2v3h18V5a2 2 0 00-2-2h-1v1a1 1 0 11-2 0V3H8v1a1 1 0 11-2 0V3H5zm16 8H3v7a3 3 0 003 3h12a3 3 0 003-3v-7z"/></svg>
                </div>
                <span class="text-xs text-gray-600">–ù–µ–¥–µ–ª—è</span>
            </button>
            <button onclick="showSection('cycle')" class="nav-btn">
                <div class="nav-icon">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 2.5C8 7 6 9.5 6 12.5 6 16.64 9.36 20 13.5 20S21 16.64 21 12.5C21 9.5 19 7 12 2.5z"/></svg>
                </div>
                <span class="text-xs text-gray-600">–¶–∏–∫–ª</span>
            </button>
            <button onclick="showSection('tracker')" class="nav-btn">
                <div class="nav-icon">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><rect x="5" y="11" width="3" height="8" rx="1"/><rect x="10.5" y="8" width="3" height="11" rx="1"/><rect x="16" y="5" width="3" height="14" rx="1"/></svg>
                </div>
                <span class="text-xs text-gray-600">–¢—Ä–µ–∫–µ—Ä</span>
            </button>
            <button onclick="showSection('about')" class="nav-btn">
                <div class="nav-icon">
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 6.01 4.01 4 6.5 4c1.74 0 3.41 1.01 4.13 2.44C11.09 5.01 12.76 4 14.5 4 16.99 4 19 6.01 19 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/></svg>
                </div>
                <span class="text-xs text-gray-600">–ú–∏—Å—Å–∏—è</span>
            </button>
        </div>
    </nav>

    <script>
        // ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø =====
        

        // ===== –î–ê–ù–ù–´–ï =====
        const SESS_KEY = 'bodyweek-sessions';
        const AUTH_KEY = 'bodyweek-auth';
        let currentPeriod = 'weeks';
        const dayTimes = {
            monday: 0,
            tuesday: 0,
            wednesday: 0,
            thursday: 0,
            friday: 0,
            saturday: 0,
            sunday: 0
        };

        const dayActivities = {
            monday: [],
            tuesday: [],
            wednesday: [],
            thursday: [],
            friday: [],
            saturday: [],
            sunday: []
        };
        const dayOrder = ['monday','tuesday','wednesday','thursday','friday','saturday','sunday'];

        // ===== –°–û–•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–• =====
        function saveData() {
            localStorage.setItem('bodyweek-dayTimes', JSON.stringify(dayTimes));
            localStorage.setItem('bodyweek-dayActivities', JSON.stringify(dayActivities));
            // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –Ω–µ–¥–µ–ª—é –≤ sessions –∫–∞–∫ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã
            try {
                const monday = getMondayOfWeek(new Date(currentWeekStart));
                monday.setHours(0,0,0,0);
                const sunday = new Date(monday);
                sunday.setDate(monday.getDate() + 6);
                const from = toYMD(monday);
                const to = toYMD(sunday);
                const existing = getSessions();
                // –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å–∏ –∑–∞ —ç—Ç—É –Ω–µ–¥–µ–ª—é
                const kept = existing.filter(s => s.date < from || s.date > to);
                // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ –æ–¥–Ω–æ–º—É –∞–≥—Ä–µ–≥–∞—Ç—É –Ω–∞ –¥–µ–Ω—å, –µ—Å–ª–∏ –º–∏–Ω—É—Ç—ã > 0
                const dayOrder = ['monday','tuesday','wednesday','thursday','friday','saturday','sunday'];
                dayOrder.forEach((key, idx) => {
                    const minutes = Number(dayTimes[key] || 0);
                    if (minutes > 0) {
                        const d = new Date(monday);
                        d.setDate(monday.getDate() + idx);
                        kept.push({ date: toYMD(d), minutes });
                    }
                });
                localStorage.setItem(SESS_KEY, JSON.stringify(kept));
                // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–∞—Ç–µ –Ω–µ–¥–µ–ª–∏
                const actMap = getActivitiesMap();
                dayOrder.forEach((key, idx) => {
                    const d = new Date(monday);
                    d.setDate(monday.getDate() + idx);
                    const dateKey = toYMD(d);
                    actMap[dateKey] = Array.isArray(dayActivities[key]) ? [...dayActivities[key]] : [];
                });
                localStorage.setItem(ACTIVITIES_KEY, JSON.stringify(actMap));
            } catch (e) {
                console.error('Failed updating sessions', e);
            }
            // –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ä—Ç–æ—á–∫–∏ –∏ –≥—Ä–∞—Ñ–∏–∫
            refreshTrackerUI();
        }

        function loadData() {
            const savedTimes = localStorage.getItem('bodyweek-dayTimes');
            const savedActivities = localStorage.getItem('bodyweek-dayActivities');
            
            if (savedTimes) {
                Object.assign(dayTimes, JSON.parse(savedTimes));
            }
            
            if (savedActivities) {
                Object.assign(dayActivities, JSON.parse(savedActivities));
            }
            
             // –ü–æ–¥—Ç—è–Ω—É—Ç—å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–Ω—É—Ç—ã —ç—Ç–æ–π –Ω–µ–¥–µ–ª–∏ –∏–∑ sessions
             loadWeekFromSessions();
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –¥–Ω–µ–π
            Object.keys(dayTimes).forEach(day => {
                updateDayDisplay(day);
                updateActivitiesDisplay(day);
            });
            updateTotal();
            updateTrackerStats();
        }

        // ===== –§–£–ù–ö–¶–ò–ò –í–†–ï–ú–ï–ù–ò =====
        function addTime(day) {
            dayTimes[day] += 30;
            updateDayDisplay(day);
            updateTotal();
            updateTrackerStats();
            saveData(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
        }

        function removeTime(day) {
            if (dayTimes[day] >= 30) {
                dayTimes[day] -= 30;
                updateDayDisplay(day);
                updateTotal();
                updateTrackerStats();
                saveData(); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ
            }
        }

        function updateDayDisplay(day) {
            const timeElement = document.getElementById(`${day}-time`);
            const hours = dayTimes[day] / 60;
            timeElement.textContent = formatHours(hours);
        }

        // ===== –§–£–ù–ö–¶–ò–ò –ê–ö–¢–ò–í–ù–û–°–¢–ï–ô =====
        // –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π
        const allActivities = [
            'üßò‚Äç‚ôÄÔ∏è –ü–∏–ª–∞—Ç–µ—Å',
            'üßò‚Äç‚ôÇÔ∏è –ô–æ–≥–∞',
            'üíÉ –ë–∞—Ä—Ä–µ',
            'üíÉ –¢–∞–Ω—Ü—ã',
            'üëü –®–∞–≥–∏ 10k',
            'üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è',
            'üí™ –°–∏–ª–æ–≤–∞—è',
            'üò¥ –û—Ç–¥—ã—Ö',
            'üèÉ‚Äç‚ôÄÔ∏è –ë–µ–≥',
            '‚ù§Ô∏è –ö–∞—Ä–¥–∏–æ'
        ];
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç–∞–ª–∞ –¥–ª—è –ø–æ–¥—Å–∫–∞–∑–æ–∫ –æ–¥–∏–Ω —Ä–∞–∑
        let suggestionsPortal = document.getElementById('activity-suggestions-portal');
        if (!suggestionsPortal) {
            suggestionsPortal = document.createElement('div');
            suggestionsPortal.id = 'activity-suggestions-portal';
            suggestionsPortal.classList.add('hidden');
            document.body.appendChild(suggestionsPortal);
        }
        
        function toggleActivityInput(day) {
            const inputContainer = document.getElementById(`${day}-activity-input`);
            const allInputs = document.querySelectorAll('[id$="-activity-input"]');
            
            // –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –¥—Ä—É–≥–∏–µ –ø–æ–ª—è –≤–≤–æ–¥–∞
            allInputs.forEach(input => {
                if (input !== inputContainer) {
                    input.classList.add('hidden');
                }
            });
            
            // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –ø–æ–ª–µ –≤–≤–æ–¥–∞
            if (inputContainer.classList.contains('hidden')) {
                inputContainer.classList.remove('hidden');
                const inputField = document.getElementById(`${day}-activity-field`);
                inputField.focus();
                inputField.value = '';
                // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π –∫–∞–∫ –º–µ–Ω—é –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                filterActivities(day, '');
            } else {
                inputContainer.classList.add('hidden');
                // –ü—Ä—è—á–µ–º –ø–æ—Ä—Ç–∞–ª —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏
                const portal = document.getElementById('activity-suggestions-portal');
                if (portal) portal.classList.add('hidden');
            }
        }
        
        function filterActivities(day, query) {
            const portal = document.getElementById('activity-suggestions-portal');
            const button = document.getElementById(`${day}-plus-btn`);
            const rect = button.getBoundingClientRect();
            
            const filteredActivities = query && query.length > 0
                ? allActivities.filter(activity => activity.toLowerCase().includes(query.toLowerCase()))
                : allActivities.slice();
            
            // –ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏-–ø–æ—Ä—Ç–∞–ª –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–Ω–æ–ø–∫–∏
            const desiredWidth = Math.min(420, Math.max(320, window.innerWidth - 24));
            const left = Math.max(12, Math.min(rect.left, window.innerWidth - desiredWidth - 12));
            portal.style.top = (rect.bottom + 10) + 'px';
            portal.style.left = left + 'px';
            portal.style.width = desiredWidth + 'px';
            portal.style.zIndex = '100000';
            
            if (filteredActivities.length > 0) {
                const itemsHtml = filteredActivities.map(activity => 
                    `<button type=\"button\" class=\"text-left w-full px-3 py-2 hover:bg-gray-100 cursor-pointer text-sm\" 
                          onclick=\"selectActivity('${day}', '${activity}')\">${activity}</button>`
                ).join('');
                const manualHtml = `
                    <div class=\"col-span-2 flex items-center gap-2 px-2 py-2 border-t border-gray-100\">
                        <input id=\"custom-activity-${day}\" type=\"text\" maxlength=\"12\" placeholder=\"–ú–æ—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å\" 
                               class=\"flex-1 px-2 py-1 border border-gray-300 rounded text-sm\" 
                               onkeydown=\"if(event.key==='Enter'){addCustomTypedActivity('${day}')}\" />
                        <button type=\"button\" class=\"px-3 py-1 text-sm bg-pink-100 text-pink-800 rounded\" onclick=\"addCustomTypedActivity('${day}')\">–î–æ–±–∞–≤–∏—Ç—å</button>
                    </div>`;
                portal.innerHTML = `<div class=\"grid grid-cols-2 gap-1 p-1\">${itemsHtml}${manualHtml}</div>`;
                portal.classList.remove('hidden');
            } else {
                portal.innerHTML = '';
                portal.classList.add('hidden');
            }
        }
        
        function handleActivityKeydown(day, event) {
            if (event.key === 'Enter') {
                const inputField = document.getElementById(`${day}-activity-field`);
                const value = inputField.value.trim();
                
                if (value) {
                    // –î–æ–±–∞–≤–∏—Ç—å –∫–∞–∫ –∫–∞—Å—Ç–æ–º–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                    selectActivity(day, value);
                }
            } else if (event.key === 'Escape') {
                toggleActivityInput(day);
            }
        }

        function selectActivity(day, activity) {
            if (dayActivities[day].length >= 3) {
                alert('–ú–∞–∫—Å–∏–º—É–º 3 –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ –¥–µ–Ω—å!');
                return;
            }
            
            dayActivities[day].push(activity);
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∏ –ø–æ–¥—Å–∫–∞–∑–∫–∏
            const inputContainer = document.getElementById(`${day}-activity-input`);
            const portal = document.getElementById('activity-suggestions-portal');
            inputContainer.classList.add('hidden');
            portal.classList.add('hidden');
            
            updateActivitiesDisplay(day);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ–º 1 —á–∞—Å, –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–µ "–û—Ç–¥—ã—Ö"
            if (activity !== 'üò¥ –û—Ç–¥—ã—Ö') {
                addTime(day);
                addTime(day); // –î–æ–±–∞–≤–ª—è–µ–º –µ—â–µ 30 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —á–∞—Å–∞
            }
            // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ —Å—Ä–∞–∑—É
            saveData();
        }

        // –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–æ–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏–∑ –ø–æ–ª—è –≤ –ø–æ—Ä—Ç–∞–ª–µ
        function addCustomTypedActivity(day) {
            const input = document.getElementById(`custom-activity-${day}`);
            if (!input) return;
            const value = (input.value || '').trim().slice(0, 12);
            if (!value) return;
            selectActivity(day, value);
        }

        function updateActivitiesDisplay(day) {
            const activitiesContainer = document.getElementById(`${day}-activities`);
            const activities = dayActivities[day];
            
            if (activities.length === 0) {
                activitiesContainer.innerHTML = '';
                return;
            }
            
            let html = '';
            activities.forEach((activity, index) => {
                html += `
                    <span class="activity-item inline-flex items-center text-sm font-medium text-text mr-3">
                        <span class="truncate max-w-[7rem] sm:max-w-[10rem]">${activity}</span>
                        <button onclick=\"removeActivity('${day}', ${index})\" class="ml-1 text-red-500 hover:text-red-700 font-bold text-base leading-none">√ó</button>
                    </span>
                `;
            });
            
            activitiesContainer.innerHTML = html;
        }

        function removeActivity(day, index) {
            const removedActivity = dayActivities[day][index];
            dayActivities[day].splice(index, 1);
            
            updateActivitiesDisplay(day);
            
            // –£–º–µ–Ω—å—à–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ 30 –º–∏–Ω—É—Ç, –Ω–æ –Ω–µ –Ω–∏–∂–µ 0
            dayTimes[day] = Math.max(0, dayTimes[day] - 30);
                updateDayDisplay(day);
                updateTotal();
                updateTrackerStats();
            
            saveData();
        }

        // ===== –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–ò–ï –ê–ö–¢–ò–í–ù–û–°–¢–ò =====
        function showCustomActivityInput(day) {
            const menu = document.getElementById(`${day}-activity-menu`);
            menu.classList.add('hidden');
            
            const modal = document.createElement('div');
            modal.id = 'custom-activity-modal';
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            modal.innerHTML = `
                <div class="bg-white rounded-2xl p-6 max-w-md w-full mx-4">
                    <h3 class="text-lg font-semibold text-text mb-4">–î–æ–±–∞–≤–∏—Ç—å —Å–≤–æ—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">–í—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ–¥–∑–∏:</label>
                        <div class="grid grid-cols-6 gap-2 mb-3">
                            <button onclick="selectEmoji('üèä‚Äç‚ôÄÔ∏è')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üèä‚Äç‚ôÄÔ∏è</button>
                            <button onclick="selectEmoji('üö¥‚Äç‚ôÄÔ∏è')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üö¥‚Äç‚ôÄÔ∏è</button>
                            <button onclick="selectEmoji('üéæ')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üéæ</button>
                            <button onclick="selectEmoji('üèãÔ∏è‚Äç‚ôÄÔ∏è')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üèãÔ∏è‚Äç‚ôÄÔ∏è</button>
                            <button onclick="selectEmoji('üßó‚Äç‚ôÄÔ∏è')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üßó‚Äç‚ôÄÔ∏è</button>
                            <button onclick="selectEmoji('üéØ')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üéØ</button>
                            <button onclick="selectEmoji('üé®')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üé®</button>
                            <button onclick="selectEmoji('üìö')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üìö</button>
                            <button onclick="selectEmoji('üéµ')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üéµ</button>
                            <button onclick="selectEmoji('üåø')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">üåø</button>
                            <button onclick="selectEmoji('‚òï')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">‚òï</button>
                            <button onclick="selectEmoji('‚ú®')" class="text-2xl hover:scale-110 transition-transform p-2 rounded-lg hover:bg-gray-100">‚ú®</button>
                        </div>
                        <div class="flex items-center space-x-2">
                            <span id="selected-emoji" class="text-2xl">üèä‚Äç‚ôÄÔ∏è</span>
                            <input type="text" id="custom-activity-text" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent">
                        </div>
                    </div>
                    <div class="flex space-x-3">
                        <button onclick="addCustomActivity('${day}')" class="flex-1 bg-primary hover:bg-accent text-white font-medium py-2 px-4 rounded-lg transition-colors">
                            –î–æ–±–∞–≤–∏—Ç—å
                        </button>
                        <button onclick="closeCustomActivityModal()" class="flex-1 bg-gray-200 hover:bg-gray-300 text-text font-medium py-2 px-4 rounded-lg transition-colors">
                            –û—Ç–º–µ–Ω–∞
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
            
            setTimeout(() => {
                document.getElementById('custom-activity-text').focus();
            }, 100);
        }

        function selectEmoji(emoji) {
            document.getElementById('selected-emoji').textContent = emoji;
        }

        function addCustomActivity(day) {
            const emoji = document.getElementById('selected-emoji').textContent;
            const text = document.getElementById('custom-activity-text').value.trim();
            
            if (!text) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏!');
                return;
            }
            
            if (dayActivities[day].length >= 2) {
                alert('–ú–∞–∫—Å–∏–º—É–º 2 –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ –¥–µ–Ω—å!');
                return;
            }
            
            const customActivity = `${emoji} ${text}`;
            dayActivities[day].push(customActivity);
            
            closeCustomActivityModal();
            updateActivitiesDisplay(day);
        }

        function closeCustomActivityModal() {
            const modal = document.getElementById('custom-activity-modal');
            if (modal) {
                modal.remove();
            }
        }

        // ===== –û–ë–©–ò–ï –§–£–ù–ö–¶–ò–ò =====
        function updateTotal() {
            const totalMinutes = Object.values(dayTimes).reduce((sum, time) => sum + time, 0);
            const totalHours = totalMinutes / 60;
            
            const totalElement = document.getElementById('total-display');
            if (totalElement) {
                totalElement.textContent = `–ò—Ç–æ–≥–æ: ${formatHours(totalHours)} —á –¥–ª—è —Å–µ–±—è!`;
            }
        }

        function updateTrackerStats() {
            const { series } = aggregateWeeks(1);
            const weekHours = series[0] || 0;
            const totalHours = Math.round((getSessions().reduce((a,s)=>a + (Number(s.minutes)||0),0)/60)*10)/10;
            document.getElementById('current-week-hours').textContent = `${formatHours(weekHours)} —á`;
            document.getElementById('total-hours').textContent = `${formatHours(totalHours)} —á`;
        }

        // ===== –ù–ê–°–¢–†–û–ï–ù–ò–ï =====
        function setMood(mood, event) {
            const moodButtons = document.querySelectorAll('button[onclick^="setMood"]');
            moodButtons.forEach(btn => {
                btn.classList.remove('ring-2', 'ring-accent');
            });
            if (event && event.target) {
            event.target.classList.add('ring-2', 'ring-accent');
            }
            localStorage.setItem('currentMood', mood);
        }

        // ===== –¢–†–ï–ö–ï–† =====
        function setChartPeriod(period, event) {
            document.querySelectorAll('.chart-period-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (event && event.target) { event.target.classList.add('active'); }
            currentPeriod = period;
            
            // –û–±–Ω–æ–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–µ—Ä–∏–æ–¥–∞
            updateChart(period);
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ (—Å –ø–æ–¥–ø–∏—Å—è–º–∏ –∑–Ω–∞—á–µ–Ω–∏–π –∏ –æ—Å–∏ X, –∏ –ø–æ–¥–ø–∏—Å—å—é –¥–∏–∞–ø–∞–∑–æ–Ω–∞)
        function updateChart(period) {
            const container = document.getElementById('chart-container');
            const agg = (period === 'weeks') ? aggregateWeeks(4) : aggregateMonths(6);
            let { labels, series, rangeLabel } = agg;
            if (!series || series.length === 0) { labels = ['']; series = [0]; }
            const maxVal = Math.max(...series, 1);
            const html = series.map((val, idx) => {
                const heightPct = Math.max(5, Math.round((val / maxVal) * 100));
                const valueLabel = `${formatHours(val)} —á`;
                const xLabel = labels[idx] || '';
                return `
                    <div class=\"flex-1 flex flex-col items-center justify-end space-y-1 h-full\">
                        <div class=\"text-xs text-gray-600 h-4\">${valueLabel}</div>
                        <div class=\"chart-bar w-full rounded-t\" style=\"height: ${heightPct}%; min-height: 8px;\"></div>
                        <div class=\"text-xs text-gray-500 text-center leading-tight mt-1\">${xLabel}</div>
                    </div>
                `;
            }).join('');
            container.innerHTML = html;
        }

        // ===== –£–¢–ò–õ–ò–¢–´ –°–ï–°–°–ò–ô =====
        function getSessions() {
            try { return JSON.parse(localStorage.getItem(SESS_KEY)) || []; }
            catch { return []; }
        }
        function addSession({ minutes, date = new Date() }) {
            const d = toYMD(date);
            const arr = getSessions();
            arr.push({ date: d, minutes: Number(minutes) || 0 });
            localStorage.setItem(SESS_KEY, JSON.stringify(arr));
        }
        function toYMD(d) {
            const dt = new Date(d);
            dt.setHours(0,0,0,0);
            const y = dt.getFullYear();
            const m = String(dt.getMonth()+1).padStart(2,'0');
            const day = String(dt.getDate()).padStart(2,'0');
            return `${y}-${m}-${day}`;
        }
        function startOfWeek(d) {
            const dt = new Date(d); dt.setHours(0,0,0,0);
            const day = (dt.getDay() + 6) % 7; // 0 = –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫
            dt.setDate(dt.getDate() - day);
            return dt;
        }
        function formatRange(a,b) {
            const fmt = (x) => x.toLocaleDateString('ru-RU', { day:'2-digit', month:'short'}).replace('.', '');
            return `${fmt(a)} ‚Äì ${fmt(b)}`;
        }
        function aggregateWeeks(n=4) {
            const sessions = getSessions();
            const today = new Date(); today.setHours(0,0,0,0);
            const end = startOfWeek(today);
            const weeks = [];
            for (let i=n-1;i>=0;i--) {
                const wStart = new Date(end); wStart.setDate(end.getDate() - i*7);
                const wEnd = new Date(wStart); wEnd.setDate(wStart.getDate()+6);
                const keyStart = toYMD(wStart), keyEnd = toYMD(wEnd);
                const sumMin = sessions
                    .filter(s => s.date >= keyStart && s.date <= keyEnd)
                    .reduce((acc,s)=>acc + (Number(s.minutes)||0), 0);
                weeks.push({ label: formatRange(wStart,wEnd), hours: Math.round((sumMin/60)*2)/2 });
            }
            const labels = weeks.map(w=>w.label);
            const series = weeks.map(w=>w.hours);
            const rangeLabel = `–ü–æ–∫–∞–∑–∞–Ω—ã: ${labels[0]} ‚Äî ${labels[labels.length-1]}`;
            return { labels, series, rangeLabel };
        }
        function aggregateMonths(n=6) {
            const sessions = getSessions();
            const now = new Date(); now.setHours(0,0,0,0);
            const months = [];
            for (let i=n-1;i>=0;i--) {
                const d = new Date(now.getFullYear(), now.getMonth()-i, 1);
                const start = new Date(d.getFullYear(), d.getMonth(), 1);
                const end   = new Date(d.getFullYear(), d.getMonth()+1, 0);
                const keyStart = toYMD(start), keyEnd = toYMD(end);
                const sumMin = sessions
                    .filter(s => s.date >= keyStart && s.date <= keyEnd)
                    .reduce((acc,s)=>acc + (Number(s.minutes)||0), 0);
                months.push({ label: d.toLocaleDateString('ru-RU',{month:'long'}), hours: Math.round((sumMin/60)*2)/2 });
            }
            const labels = months.map(m=>m.label);
            const series = months.map(m=>m.hours);
            const rangeLabel = `–ü–æ–∫–∞–∑–∞–Ω—ã: ${labels[0]} ‚Äî ${labels[labels.length-1]}`;
            return { labels, series, rangeLabel };
        }
        function refreshTrackerUI() {
            updateTrackerStats();
            updateChart(currentPeriod || 'weeks');
        }

        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å–æ–≤: –±–µ–∑ –ª–∏—à–Ω–∏—Ö .0
        function formatHours(val) {
            const rounded = Math.round(val * 10) / 10; // –æ–¥–Ω–∞ —Ü–∏—Ñ—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π
            if (Number.isInteger(rounded)) return String(rounded);
            return rounded.toFixed(1);
        }

        // ===== AUTH (email + –∫–æ–¥) ‚Äî –¥–µ–º–æ –Ω–∞ localStorage =====
        function requestLoginCode() {
            const email = (document.getElementById('auth-email').value || '').trim();
            const status = document.getElementById('auth-status');
            if (!email || !/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) {
                status.textContent = '–í–≤–µ–¥–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π email';
                status.style.color = '#b91c1c';
                return;
            }
            const code = String(Math.floor(100000 + Math.random()*900000));
            localStorage.setItem(`${AUTH_KEY}-pending`, JSON.stringify({ email, code, createdAt: Date.now() }));
            status.textContent = `–ö–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ ${email} (–≤ –¥–µ–º–æ —Å–º. localStorage)`;
            status.style.color = '#2563eb';
            // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–∏—Ç—å –¥–ª—è –¥–µ–º–æ (–Ω–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
            const digits = code.split('');
            for (let i=0;i<6;i++){ const el = document.getElementById(`code-${i+1}`); if (el) el.value = digits[i] || ''; }
        }
        function confirmLoginCode() {
            const pending = JSON.parse(localStorage.getItem(`${AUTH_KEY}-pending`) || 'null');
            const status = document.getElementById('auth-status');
            if (!pending) { status.textContent = '–°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—Ä–æ—Å–∏ –∫–æ–¥'; status.style.color = '#b91c1c'; return; }
            const code = Array.from({length:6},(_,i)=>document.getElementById(`code-${i+1}`)?.value||'').join('');
            if (code !== pending.code) { status.textContent = '–ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥'; status.style.color = '#b91c1c'; return; }
            localStorage.setItem(AUTH_KEY, JSON.stringify({ email: pending.email, loggedInAt: Date.now() }));
            localStorage.removeItem(`${AUTH_KEY}-pending`);
            status.textContent = '–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω';
            status.style.color = '#16a34a';
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) logoutBtn.classList.remove('hidden');
        }
        function logout() {
            localStorage.removeItem(AUTH_KEY);
            const status = document.getElementById('auth-status');
            if (status) { status.textContent = '–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞'; status.style.color = '#6B7280'; }
            const logoutBtn = document.getElementById('logout-btn');
            if (logoutBtn) logoutBtn.classList.add('hidden');
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        function initChart() {
            updateChart('weeks');
        }

        // ===== –ú–û–¢–ò–í–ê–¶–ò–û–ù–ù–´–ï –§–†–ê–ó–´ =====
        const wishes = [
          '–≤–∞—à–∏ —Ä–æ–¥–∏—Ç–µ–ª–∏ —Å–ª—É—á–∞–π–Ω–æ –Ω–µ –∫–æ–≤—Ä–∏–∫–∏ –æ—Ç –π–æ–≥–∏? –∞ —Ç–æ –≤—ã —Ç–∞–∫ –∫—Ä—É—Ç–æ –Ω–∞ –Ω–∏—Ö –ª–µ–∂–∏—Ç–µ',
          '–∫—Ç–æ —ç—Ç–æ —Ç–∞–º –≤ –∑–µ—Ä–∫–∞–ª–µ? –Ω–µ—Ä–µ–∞–ª—å–Ω–∞—è –∫—Ä–∞—Å–æ—Ç–∫–∞',
          '—Ç—Ä–µ–≤–æ–≥–∞ –±–æ—è–ª–∞—Å—å –µ—ë! –æ–Ω–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ —Ö–æ–¥–∏–ª–∞ –Ω–∞ —Ä–∞—Å—Ç—è–∂–∫—É..',
          '–∫–∞–∫ –∂–µ –∫–ª–∞—Å—Å–Ω–æ, —á—Ç–æ —Ç—ã —É–¥–µ–ª—è–µ—à—å –≤—Ä–µ–º—è —Å–µ–±–µ!',
          '–≤–∞—à–∏ —Ä–æ–¥–∏—Ç–µ–ª–∏ —Å–ª—É—á–∞–π–Ω–æ –Ω–µ –≥–∞–Ω—Ç–µ–ª–∏? –∞ —Ç–æ –≤—ã —Ç–∞–∫ —É–≤–µ—Ä–µ–Ω–Ω–æ –¥–µ—Ä–∂–∏—Ç–µ —Å–µ–±—è –≤ —Ä—É–∫–∞—Ö',
          '—ç—Ç–æ —á—Ç–æ, –Ω–æ–≤–∞—è —Å—É–ø–µ—Ä—Å–∏–ª–∞? —Å–ø–æ–∫–æ–π–Ω–æ –æ—Ç–¥—ã—Ö–∞—Ç—å –∏ –ø—Ä–∏ —ç—Ç–æ–º –≤—ã–≥–ª—è–¥–µ—Ç—å –Ω–∞ –º–∏–ª–ª–∏–æ–Ω',
          '—Å—Ç—Ä–µ—Å—Å –¥—É–º–∞–ª, —á—Ç–æ –ø–æ–±–µ–¥–∏—Ç –µ—ë‚Ä¶ –Ω–æ –Ω–µ –∑–Ω–∞–ª, —á—Ç–æ —É –Ω–µ—ë –∞–±–æ–Ω–µ–º–µ–Ω—Ç –Ω–∞ –π–æ–≥—É',
          '–∫—Ç–æ —Ç–∞–∫ —Å–∏—è–µ—Ç –ø–æ—Å–ª–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏? –¥–∞ —ç—Ç–æ –∂–µ —Ç—ã, —Å–æ–ª–Ω—ã—à–∫–æ –≤ –∑–∞–ª–µ',
          '–≤–∞—à–∏ —Ä–æ–¥–∏—Ç–µ–ª–∏ —Å–ª—É—á–∞–π–Ω–æ –Ω–µ –∫–æ–≤—Ä–∏–∫–∏-–ø–∏–ª–∞—Ç–µ—Å? –∞ —Ç–æ —Ç—ã –≤—Å—ë –≤—Ä–µ–º—è –Ω–∞—Ö–æ–¥–∏—à—å –±–∞–ª–∞–Ω—Å',
          '–∑–µ—Ä–∫–∞–ª–æ —Å–ø—Ä–∞—à–∏–≤–∞–ª–æ: —ç—Ç–æ –∞–Ω–≥–µ–ª? ‚Äî –Ω–µ—Ç, –ø—Ä–æ—Å—Ç–æ –æ–Ω–∞ —Å–¥–µ–ª–∞–ª–∞ —Ä–∞—Å—Ç—è–∂–∫—É',
          '–∫—Ç–æ —Ç—É—Ç —É–º—É–¥—Ä—è–µ—Ç—Å—è –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ —Å–µ–±–µ –¥–∞–∂–µ –≤ –±—É–¥–Ω–∏? –ª–µ–≥–µ–Ω–¥–∞, –Ω–µ –∏–Ω–∞—á–µ',
          '—Ç—ã —Ç–∞–∫–∞—è –∫—Ä–∞—Å–æ—Ç–∫–∞, –∞ —É –º–µ–Ω—è —Ç–æ–ª—å–∫–æ —Å–æ—Ç–∫–∞',
          '—Ç—ã –∫–∞–∫ –≤–∞–π—Ñ–∞–π ‚Äî —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π –≤—Å—ë –ª–æ–≤–∏—Ç',
          '—Ç—ã –∫–∞–∫ –ø—Ä–µ—Å—Å –ø–æ—Å–ª–µ –∫–∞—á–∞–ª–∫–∏ ‚Äî –Ω–∞ —Ç–µ–±—è –ø—Ä–∏—è—Ç–Ω–æ –æ–ø–µ—Ä–µ—Ç—å—Å—è',
          '—Ç—ã —Ç–∞–∫–∞—è –≥–∏–±–∫–∞—è, —á—Ç–æ –π–æ–≥–∞ —Å–∞–º–∞ –Ω–∞ —Ç–µ–±—è –ø–æ–¥–ø–∏—Å–∞–ª–∞—Å—å',
          '—Å—Ç—Ä–µ—Å—Å –≤—ã—à–µ–ª –≤ –æ–∫–Ω–æ, –∫–æ–≥–¥–∞ —É–∑–Ω–∞–ª, —á—Ç–æ —É —Ç–µ–±—è —Å–µ–≥–æ–¥–Ω—è –ø–∏–ª–∞—Ç–µ—Å',
          '—Ç—Ä–µ–≤–æ–≥–∞ –ø—ã—Ç–∞–ª–∞—Å—å –ø–æ—Å—Ç—É—á–∞—Ç—å, –Ω–æ –¥–≤–µ—Ä—å –∑–∞–Ω—è—Ç–∞ —Ç–≤–æ–∏–º —á–∏–ª–ª–æ–º',
          '—Ç—ã –≤—ã–≥–ª—è–¥–∏—à—å —Ç–∞–∫, –±—É–¥—Ç–æ —Ç–æ–ª—å–∫–æ —á—Ç–æ –≤—ã–∏–≥—Ä–∞–ª–∞ –≤ –ª–æ—Ç–µ—Ä–µ—é —Å–Ω–∞',
          '—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫ –æ–±–∑–∞–≤–∏–¥–æ–≤–∞–ª—Å—è —Ç–≤–æ–µ–π –∑–∞—Ä—è–¥–∫–µ',
          '—Ç—ã —Å–∏—è–µ—à—å —è—Ä—á–µ, —á–µ–º —ç–∫—Ä–∞–Ω —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª–∫–µ',
          '–º–∏—Ä —Ç–∞–∫–æ–π: ¬´–≤–∞—É, —ç—Ç–æ —á—Ç–æ, –∞–ø–≥—Ä–µ–π–¥?¬ª ‚Äî –Ω–µ—Ç, —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç—ã –ø–æ–∑–∞–Ω–∏–º–∞–ª–∞—Å—å',
          '—Å–ø–æ—Ä—Ç –¥—É–º–∞–ª, —á—Ç–æ –æ–Ω —Ç–µ–±—è –ø—Ä–æ–∫–∞—á–∞–µ—Ç, –∞ –æ–∫–∞–∑–∞–ª–æ—Å—å ‚Äî —Ç—ã –ø—Ä–æ–∫–∞—á–∞–ª–∞ –µ–≥–æ',
          '–≤–∞–Ω–≥—É—é, —Å–µ–≥–æ–¥–Ω—è —Ç—ã —Å–ø–∞–ª–∞ –∫–∞–∫ —Å–ø—è—â–∞—è –ø—Ä–∏–Ω—Ü–µ—Å—Å–∞',
          '—Ç—ã –æ—Ç–¥—ã—Ö–∞–µ—à—å —Ç–∞–∫ –∫—Ä–∞—Å–∏–≤–æ, —á—Ç–æ Netflix —É–∂–µ –¥—É–º–∞–µ—Ç —Å–Ω—è—Ç—å —Å–µ—Ä–∏–∞–ª',
          '—Ç–≤–æ–π —Å–æ–Ω –±—ã–ª —Ç–∞–∫–∏–º –≥–ª—É–±–æ–∫–∏–º, —á—Ç–æ –¥–∞–∂–µ –º—ã—Å–ª–∏ –Ω–µ –¥–æ—Å—Ç—É—á–∞–ª–∏—Å—å',
          '—Ç—ã –ª–µ–∂–∞–ª–∞ —Ç–∞–∫ –≥—Ä–∞—Ü–∏–æ–∑–Ω–æ, —á—Ç–æ –∫—Ä–æ–≤–∞—Ç—å –ø–æ—á—É–≤—Å—Ç–≤–æ–≤–∞–ª–∞ —Å–µ–±—è –¥–∏–≤–∞–Ω–æ–º –∏–∑ —Ä–µ–∫–ª–∞–º—ã',
          '–æ—Ç–¥—ã—Ö —É —Ç–µ–±—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ª—É—á—à–µ, —á–µ–º —É –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ —Ä–∞–±–æ—Ç–∞',
          '–ø–æ–¥—É—à–∫–∞ –≤ –≤–æ—Å—Ç–æ—Ä–≥–µ: –≥–æ–≤–æ—Ä–∏—Ç, —ç—Ç–æ –±—ã–ª–∞ –ª—É—á—à–∞—è –Ω–æ—á—å –µ—ë –∂–∏–∑–Ω–∏',
          '—Ç—ã —Ä–∞—Å—Å–ª–∞–±–ª—è–µ—à—å—Å—è —Ç–∞–∫, –±—É–¥—Ç–æ —ç—Ç–æ —Ç–≤–æ–π –æ–ª–∏–º–ø–∏–π—Å–∫–∏–π –≤–∏–¥ —Å–ø–æ—Ä—Ç–∞',
          '–¥–Ω—ë–º –æ—Ç–¥—ã—Ö–∞–µ—à—å ‚Äî –Ω–æ—á—å—é —Å–≤–µ—Ä–∫–∞–µ—à—å, –∑–∞–∫–æ–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∞—Å–æ—Ç—ã',
          '—Å–µ–≥–æ–¥–Ω—è —Ç–≤–æ–π —á–∏–ª–ª –±—ã–ª –º–æ—â–Ω–µ–µ –ª—é–±–æ–≥–æ —ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞',
          '–º–∏—Ä –ø–æ–¥–æ–∂–¥–∞–ª, –ø–æ–∫–∞ —Ç—ã —Å–ø–∞–ª–∞ ‚Äî –∏ –Ω–µ –ø–æ–∂–∞–ª–µ–ª',
          '—Ç–≤–æ—ë ¬´–Ω–∏—á–µ–≥–æ–Ω–µ–¥–µ–ª–∞–Ω–∏–µ¬ª –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –∏—Å–∫—É—Å—Å—Ç–≤–æ'
        ];

        // –û—Ç–∫—Ä—ã—Ç—å –ø–µ—á–µ–Ω—å–∫—É –∏ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        function showInlineWish() {
            const container = document.getElementById('wish-inline-container');
            const button = document.getElementById('wish-button');
            if (!container || !button) return;
            const text = wishes[Math.floor(Math.random() * wishes.length)];
            // –°–ø—Ä—è—Ç–∞—Ç—å –∫–Ω–æ–ø–∫—É, –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç
            button.classList.add('hidden');
            const textEl = document.createElement('div');
            textEl.id = 'wish-inline-text';
            textEl.className = 'wish-inline-card';
            textEl.textContent = text;
            container.appendChild(textEl);
            // –ü—É—Å—Ç–∏—Ç—å –¥–æ–∂–¥—å –∏–∑ —Å–µ—Ä–¥–µ—á–µ–∫ 2 —Å–µ–∫—É–Ω–¥—ã
            try { createHeartAnimationBurst(2000); } catch(e) {}
            // –í–µ—Ä–Ω—É—Ç—å –∫–Ω–æ–ø–∫—É —á–µ—Ä–µ–∑ 4.5 —Å–µ–∫—É–Ω–¥—ã –∏–ª–∏ –ø–æ —Ç–∞–ø—É
            const restore = () => {
                if (textEl && textEl.parentNode) textEl.parentNode.removeChild(textEl);
                button.classList.remove('hidden');
            };
            clearTimeout(window.__wishInlineTimer);
            window.__wishInlineTimer = setTimeout(restore, 15000);
            textEl.onclick = restore;
        }

        // –ö–æ—Ä–æ—Ç–∫–∏–π ¬´–¥–æ–∂–¥—å –∏–∑ —Å–µ—Ä–¥–µ—á–µ–∫¬ª –∑–∞–¥–∞–Ω–Ω–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–º—Å)
        function createHeartAnimationBurst(durationMs=2000) {
            const endAt = Date.now() + durationMs;
            const spawn = () => {
                if (Date.now() > endAt) return;
                    const heart = document.createElement('div');
                    heart.className = 'heart';
                heart.textContent = 'üíñ';
                const screenWidth = window.innerWidth;
                const screenHeight = window.innerHeight;
                heart.style.left = (Math.random() * screenWidth) + 'px';
                heart.style.top = (-50) + 'px';
                heart.style.fontSize = (2 + Math.random() * 2) + 'rem';
                    document.body.appendChild(heart);
                setTimeout(() => { heart.style.transition = 'top 2s ease-in'; heart.style.top = (screenHeight + 100) + 'px'; }, 20);
                setTimeout(() => { if (heart.parentNode) heart.parentNode.removeChild(heart); }, 2300);
                setTimeout(spawn, 100 + Math.random()*120);
            };
            spawn();
        }

        function changeMotivationalPhrase() {
            const phraseElement = document.getElementById('motivational-phrase');
            if (phraseElement) {
                const randomIndex = Math.floor(Math.random() * motivationalPhrases.length);
                phraseElement.textContent = motivationalPhrases[randomIndex];
            }
        }

        // ===== –ü–†–û–§–ò–õ–¨ =====
        function saveProfile() {
            const name = document.getElementById('profile-name').value;
            const cycleStart = document.getElementById('cycle-start').value;
            const cycleLength = document.getElementById('cycle-length').value;
            const mLength = document.getElementById('m-length').value;
            
            if (!name || !cycleStart || !cycleLength || !mLength) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!');
                return;
            }
            
            const profile = {
                name,
                cycleStart,
                cycleLength: parseInt(cycleLength),
                mLength: parseInt(mLength)
            };
            
            localStorage.setItem('userProfile', JSON.stringify(profile));
            updateProfileDisplay(profile);
            
            // –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–∑—É —Ü–∏–∫–ª–∞ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è
            updateCyclePhase();
            
            // –û–±–Ω–æ–≤–∏–º –≤–∫–ª–∞–¥–∫—É "–¶–∏–∫–ª" —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            updateCyclePhase();
            alert('–ü—Ä–æ—Ñ–∏–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω!');
        }

        function updateProfileDisplay(profile) {
            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏: –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ–π, –ò–∑–º–µ–Ω–∏—Ç—å - –∞–∫—Ç–∏–≤–Ω–æ–π
            const saveBtn = document.getElementById('save-profile-btn');
            const editBtn = document.getElementById('edit-profile-btn');
            
            saveBtn.classList.remove('btn-primary');
            saveBtn.classList.add('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
            saveBtn.disabled = true;
            saveBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ';
            
            editBtn.classList.remove('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
            editBtn.classList.add('btn-primary');
            editBtn.disabled = false;
            editBtn.textContent = '–ü–æ–ø—Ä–∞–≤–∏—Ç—å';
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞ –ø–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            ['profile-name','cycle-start','cycle-length','m-length'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.disabled = true;
            });
        }

        function editProfile() {
            // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏: –≤–∫–ª—é—á–∞–µ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏ –ø–æ–ª–µ–π
            const saveBtn = document.getElementById('save-profile-btn');
            const editBtn = document.getElementById('edit-profile-btn');
            
            saveBtn.classList.remove('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
            saveBtn.classList.add('btn-primary');
            saveBtn.disabled = false;
            saveBtn.textContent = '–ì–æ—Ç–æ–≤–æ';
            
            editBtn.classList.remove('btn-primary');
            editBtn.classList.add('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
            editBtn.disabled = true;
            editBtn.textContent = '–ü–æ–ø—Ä–∞–≤–∏—Ç—å';
            
            // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø–æ–ª—è –≤–≤–æ–¥–∞
            ['profile-name','cycle-start','cycle-length','m-length'].forEach(id => {
                const el = document.getElementById(id);
                if (el) el.disabled = false;
            });
        }

        function loadProfile() {
            const savedProfile = localStorage.getItem('userProfile');
            if (savedProfile) {
                const profile = JSON.parse(savedProfile);
                
                document.getElementById('profile-name').value = profile.name;
                document.getElementById('cycle-start').value = profile.cycleStart;
                document.getElementById('cycle-length').value = profile.cycleLength;
                document.getElementById('m-length').value = profile.mLength;
                
                updateProfileDisplay(profile);
                
                // –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–∑–µ —Ü–∏–∫–ª–∞
                updateCyclePhase();
            } else {
                // –ï—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –∞–∫—Ç–∏–≤–Ω–æ–π
                const saveBtn = document.getElementById('save-profile-btn');
                const editBtn = document.getElementById('edit-profile-btn');
                
                saveBtn.classList.add('btn-primary');
                saveBtn.classList.remove('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
                saveBtn.disabled = false;
                saveBtn.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
                
                editBtn.classList.add('bg-gray-300', 'text-gray-600', 'cursor-not-allowed');
                editBtn.classList.remove('btn-primary');
                editBtn.disabled = true;
                editBtn.textContent = '–ò–∑–º–µ–Ω–∏—Ç—å';
            }
        }

        // ===== –°–û–ë–´–¢–ò–Ø =====
        document.addEventListener('click', function(event) {
            if (!event.target.closest('[id$="-activity-menu"]') && !event.target.closest('button[onclick*="toggleActivityMenu"]')) {
                const allMenus = document.querySelectorAll('[id$="-activity-menu"]');
                allMenus.forEach(menu => {
                    menu.classList.add('hidden');
                });
            }
        });

        // ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø –ù–ï–î–ï–õ–¨ =====
        let currentWeekStart = new Date();
        
        // –ù–∞–π—Ç–∏ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ —Ç–µ–∫—É—â–µ–π –Ω–µ–¥–µ–ª–∏
        function getMondayOfWeek(date) {
            const day = date.getDay();
            const diff = date.getDate() - day + (day === 0 ? -6 : 1); // –ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ = 1
            return new Date(date.setDate(diff));
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –Ω–µ–¥–µ–ª–∏: "25 ‚Äî 31 –∞–≤–≥" / "31 –∞–≤–≥ ‚Äî 6 —Å–µ–Ω"
        function fmtDay(d){ return new Date(d).toLocaleDateString('ru-RU',{ day:'2-digit' }); }
        function fmtDayMon(d){ return new Date(d).toLocaleDateString('ru-RU',{ day:'numeric', month:'short' }).replace('.', ''); }
        function formatWeekRangeLabel(startDate){
            const s = new Date(startDate); s.setHours(0,0,0,0);
            const e = new Date(s); e.setDate(s.getDate()+6);
            const sameMonth = s.getMonth() === e.getMonth() && s.getFullYear() === e.getFullYear();
            const left  = sameMonth ? fmtDay(s) : fmtDayMon(s);
            const right = fmtDayMon(e);
            return `${left} ‚Äî ${right}`;
        }
        
        // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏
        function updateWeekDisplay() {
            const monday = getMondayOfWeek(new Date(currentWeekStart));
            const sunday = new Date(monday);
            sunday.setDate(monday.getDate() + 6);
            
            const weekText = formatWeekRangeLabel(monday);
            const labelEl = document.getElementById('weekLabel');
            if (labelEl) labelEl.textContent = weekText;
            
            // –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–∑—É —Ü–∏–∫–ª–∞
            updateCyclePhase();
            // –ü–æ–¥—Ç—è–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ –º–∏–Ω—É—Ç–∞–º –∏–∑ sessions –∏ –æ–±–Ω–æ–≤–∏—Ç—å UI
            loadWeekFromSessions();
            Object.keys(dayTimes).forEach(day => {
                updateDayDisplay(day);
                updateActivitiesDisplay(day);
            });
            updateTotal();
        }
        
        // –ü—Ä–µ–¥—ã–¥—É—â–∞—è –Ω–µ–¥–µ–ª—è
        function previousWeek() {
            currentWeekStart.setDate(currentWeekStart.getDate() - 7);
            updateWeekDisplay();
        }
        
        // –°–ª–µ–¥—É—é—â–∞—è –Ω–µ–¥–µ–ª—è
        function nextWeek() {
            currentWeekStart.setDate(currentWeekStart.getDate() + 7);
            updateWeekDisplay();
        }
        
        // –ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∏–Ω—É—Ç—ã –≤—ã–±—Ä–∞–Ω–Ω–æ–π –Ω–µ–¥–µ–ª–∏ –∏–∑ sessions (–µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö)
        function loadWeekFromSessions() {
            try {
                const monday = getMondayOfWeek(new Date(currentWeekStart));
                monday.setHours(0,0,0,0);
                const sessions = getSessions();
                const actMap = getActivitiesMap();
                for (let i = 0; i < 7; i++) {
                    const d = new Date(monday);
                    d.setDate(monday.getDate() + i);
                    const key = toYMD(d);
                    const minutes = sessions
                        .filter(s => s.date === key)
                        .reduce((acc, s) => acc + (Number(s.minutes) || 0), 0);
                    dayTimes[dayOrder[i]] = minutes;
                    // –ü–æ–¥—Ç—è–Ω—É—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ –¥–∞—Ç–µ —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Ñ–æ–ª–±—ç–∫–æ–º –Ω–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ dayActivities
                    const fallback = Array.isArray(dayActivities[dayOrder[i]]) ? [...dayActivities[dayOrder[i]]] : [];
                    dayActivities[dayOrder[i]] = Array.isArray(actMap[key]) ? [...actMap[key]] : fallback;
                }
            } catch (e) {
                console.error('loadWeekFromSessions failed', e);
            }
        }
        
        // ===== –†–ê–°–ß–ï–¢ –§–ê–ó–´ –¶–ò–ö–õ–ê =====
        function updateCyclePhase() {
            const profile = JSON.parse(localStorage.getItem('userProfile') || '{}');
            if (!profile.cycleStart || !profile.cycleLength || !profile.mLength) {
                 // –ï—Å–ª–∏ –ø—Ä–æ—Ñ–∏–ª—å –Ω–µ –∑–∞–ø–æ–ª–Ω–µ–Ω, –æ–±–Ω–æ–≤–∏–º —Å—Ç—Ä–∞–Ω–∏—Ü—É "–¶–∏–∫–ª" –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ–º
                 const cTitle = document.getElementById('cycle-phase-title');
                 const cInfo = document.getElementById('cycle-phase-info');
                 if (cTitle) cTitle.textContent = '–ü–µ—Ä–µ–π–¥–∏ –≤ –ü—Ä–æ—Ñ–∏–ª—å –∏ –∑–∞–ø–æ–ª–Ω–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ, —á—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å —Å–≤–æ—é —Ñ–∞–∑—É —Ü–∏–∫–ª–∞.';
                 if (cInfo) cInfo.innerHTML = '';
                return;
            }
            
            const cycleStart = new Date(profile.cycleStart);
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â—É—é –≤—ã–±—Ä–∞–Ω–Ω—É—é –Ω–µ–¥–µ–ª—é –≤–º–µ—Å—Ç–æ —Å–µ–≥–æ–¥–Ω—è—à–Ω–µ–π –¥–∞—Ç—ã
            const selectedWeekDate = new Date(currentWeekStart);
            const daysSinceStart = Math.floor((selectedWeekDate - cycleStart) / (1000 * 60 * 60 * 24));
            const cycleDay = daysSinceStart % profile.cycleLength;
            
            let phaseText = '';
            let phaseIcon = '';
            
            if (cycleDay < profile.mLength) {
                // –ú–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–∞—è —Ñ–∞–∑–∞
                phaseText = '–ó–∞–±–æ—Ç–∞. –û—Ç–¥—ã—Ö. –ü–ª–∞–≤–Ω–æ—Å—Ç—å';
                phaseIcon = 'ü©∏';
            } else if (cycleDay < profile.mLength + Math.round((profile.cycleLength - profile.mLength - 5) / 2)) {
                // –§–æ–ª–ª–∏–∫—É–ª—è—Ä–Ω–∞—è —Ñ–∞–∑–∞
                phaseText = '–≠–Ω–µ—Ä–≥–∏—è —Ä–∞—Å—Ç—ë—Ç. –ú–æ–∂–Ω–æ —É—Å–∏–ª–∏–≤–∞—Ç—å—Å—è';
                phaseIcon = 'üíÉ';
             } else {
                 // –õ—é—Ç–µ–∏–Ω–æ–≤–∞—è —Ñ–∞–∑–∞: –¥–µ–ª–∏–º –Ω–∞ –¥–≤–µ —á–∞—Å—Ç–∏
                 const lutealStart = profile.mLength + Math.round((profile.cycleLength - profile.mLength - 5) / 2);
                 const daysIntoLuteal = cycleDay - lutealStart;
                 const lutealLength = profile.cycleLength - lutealStart;
                 const firstWeek = daysIntoLuteal < 7; // –ø–µ—Ä–≤–∞—è –Ω–µ–¥–µ–ª—è –ª—é—Ç–µ–∏–Ω–æ–≤–æ–π
                 if (firstWeek) {
                     phaseText = '–°–∏–ª–æ–≤—ã–µ –∏–¥—É—Ç –æ—Ç–ª–∏—á–Ω–æ. –•–æ—Ä–æ—à–∞—è –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å';
                phaseIcon = 'üí™';
            } else {
                phaseText = '–ó–∞–º–µ–¥–ª–∏—Å—å. –°—Ñ–æ–∫—É—Å–∏—Ä—É–π—Å—è –Ω–∞ —Å–µ–±–µ';
                phaseIcon = 'üßò';
                 }
             }
             
             // –û–±–Ω–æ–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–∞–∑—ã –≤ —à–∞–ø–∫–µ –Ω–µ–¥–µ–ª–∏ (–Ω–æ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä cycleHint)
             const cycleHintEl = document.getElementById('cycleHint');
             if (cycleHintEl) {
                 cycleHintEl.innerHTML = `
                     <span class="cycle-emoji">${phaseIcon}</span>
                     <span class="cycle-text">${phaseText}</span>
                 `;
             }
             // –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å, –µ—Å–ª–∏ –æ—Å—Ç–∞–ª—Å—è —Å—Ç–∞—Ä—ã–π id
             const legacyPhaseElement = document.getElementById('cycle-phase-hint');
             if (legacyPhaseElement) {
                 legacyPhaseElement.innerHTML = `
                    <span class="text-2xl">${phaseIcon}</span>
                    <span class="text-xs sm:text-sm">${phaseText}</span>
                `;
            }
            
             // –°–æ—Ö—Ä–∞–Ω–∏–º —Ç–µ–∫—É—â—É—é —Ñ–∞–∑—É –¥–ª—è –ª–æ–≥–∏–∫–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π "–ö–∞–∫ —Ç—ã —Å–µ–≥–æ–¥–Ω—è?"
             window.__currentPhaseIcon = phaseIcon;
             
             // –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –Ω–∞ –≤–∫–ª–∞–¥–∫–µ "–¶–∏–∫–ª"
             const details = getPhaseDetails(phaseIcon);
             const nameEl = document.getElementById('cycle-phase-name');
             const keyEl = document.getElementById('cycle-phase-key');
             const bodyEl = document.getElementById('cycle-body');
             const impactEl = document.getElementById('cycle-impact');
             const actionsEl = document.getElementById('cycle-actions');
             if (nameEl) nameEl.textContent = details.description;
             if (keyEl) keyEl.textContent = phaseText;
             if (bodyEl) bodyEl.textContent = details.bodyChanges;
             if (impactEl) impactEl.textContent = details.impact;
             if (actionsEl) {
                 actionsEl.innerHTML = details.activities.slice(0,6).map(a => {
                     const parts = a.split(' ');
                     const emoji = parts[0];
                     const text = parts.slice(1).join(' ');
                     return `<div class=\"bg-white rounded-xl border border-pink-100 p-2 text-center\"><div class=\"text-lg\">${emoji}</div><div class=\"text-xs text-gray-700\">${text}</div></div>`;
                 }).join('');
             }
        }

        // –û–±–Ω–æ–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–∑–µ
        function updatePhaseInfo(phaseIcon, phaseText) {
            const phaseInfoElement = document.getElementById('phase-info');
            const phaseTitleElement = document.getElementById('phase-title');
            if (!phaseInfoElement || !phaseTitleElement) return;
            
            const phaseDetails = getPhaseDetails(phaseIcon);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Ñ–∞–∑—ã
            phaseTitleElement.textContent = phaseDetails.description;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            phaseInfoElement.innerHTML = `
                <div class="space-y-4">
                    <div class="bg-gradient-to-r from-pink-50 to-purple-50 rounded-xl p-5 border border-pink-100">
                        <h4 class="font-bold text-text mb-3 text-lg text-left">–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ç–µ–ª–µ</h4>
                        <p class="text-sm text-gray-800 leading-relaxed text-left">${phaseDetails.bodyChanges}</p>
                    </div>
                    
                    <div class="bg-gradient-to-r from-purple-50 to-indigo-50 rounded-xl p-5 border border-purple-100">
                        <h4 class="font-bold text-text mb-3 text-lg text-left">–ö–∞–∫ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–µ–±—è</h4>
                        <p class="text-sm text-gray-800 leading-relaxed text-left">${phaseDetails.impact}</p>
                    </div>
                    
                    <div class="bg-gradient-to-r from-blue-50 to-indigo-50 rounded-xl p-5 border border-blue-100">
                        <h4 class="font-bold text-text mb-3 text-lg text-left">–ß—Ç–æ —Å —ç—Ç–∏–º –¥–µ–ª–∞—Ç—å</h4>
                        <div class="grid grid-cols-2 sm:grid-cols-3 gap-2">
                            ${phaseDetails.activities.slice(0, 5).map(activity => `
                                <div class="bg-white/70 backdrop-blur-sm rounded-lg p-2 border border-blue-200/50 hover:border-blue-300 transition-all duration-300 hover:shadow-md hover:scale-105 group">
                                    <div class="text-center">
                                        <div class="text-lg mb-1">${activity.split(' ')[0]}</div>
                                        <div class="text-xs font-medium text-gray-700 group-hover:text-gray-900 transition-colors leading-tight">
                                            ${activity.split(' ').slice(1).join(' ')}
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
        }

        // –ü–æ–ª—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–∞–∑–µ
        function getPhaseDetails(phaseIcon) {
            const phaseData = {
                'ü©∏': {
                    description: '–ú–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–∞—è —Ñ–∞–∑–∞',
                    bodyChanges: '–£—Ä–æ–≤–µ–Ω—å —ç—Å—Ç—Ä–æ–≥–µ–Ω–∞ –∏ –ø—Ä–æ–≥–µ—Å—Ç–µ—Ä–æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –Ω–∞ –º–∏–Ω–∏–º—É–º–µ. –ú–∞—Ç–∫–∞ —Å–æ–∫—Ä–∞—â–∞–µ—Ç—Å—è –¥–ª—è –æ—Ç—Ç–æ—Ä–∂–µ–Ω–∏—è —ç–Ω–¥–æ–º–µ—Ç—Ä–∏—è, —á—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å —Å–ø–∞–∑–º—ã. –°–Ω–∏–∂–∞–µ—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å –∂–µ–ª–µ–∑–∞, —á—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å. –û—Ä–≥–∞–Ω–∏–∑–º —Ç—Ä–∞—Ç–∏—Ç –º–Ω–æ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∫–∞–Ω–µ–π –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ.',
                    impact: '–£ —Ç–µ–±—è –ø–æ–Ω–∏–∂–∞–µ—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏, —Ç—ã –º–æ–∂–µ—à—å —á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å —É—Å—Ç–∞–ª–æ—Å—Ç—å, —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç - –æ—á–µ–Ω—å —Å–ø–æ–∫–æ–π–Ω–æ–π. –≠—Ç–æ –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –¢–≤–æ–µ —Ç–µ–ª–æ —Ç—Ä–∞—Ç–∏—Ç –º–Ω–æ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –ø–æ—ç—Ç–æ–º—É –≤–∞–∂–Ω–æ –¥–∞—Ç—å –µ–º—É –æ—Ç–¥–æ—Ö–Ω—É—Ç—å –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è.',
                    activities: [
                        'üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞',
                        'üò¥ –°–æ–Ω',
                        'üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏',
                        'üìö –ß—Ç–µ–Ω–∏–µ',
                        'üõÅ –í–∞–Ω–Ω—ã'
                    ]
                },
                'üíÉ': {
                    description: '–§–æ–ª–ª–∏–∫—É–ª—è—Ä–Ω–∞—è —Ñ–∞–∑–∞',
                    bodyChanges: '–£—Ä–æ–≤–µ–Ω—å —ç—Å—Ç—Ä–æ–≥–µ–Ω–∞ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø–æ–≤—ã—à–∞–µ—Ç—Å—è, —Å—Ç–∏–º—É–ª–∏—Ä—É—è —Ä–æ—Å—Ç —Ñ–æ–ª–ª–∏–∫—É–ª–æ–≤ –≤ —è–∏—á–Ω–∏–∫–∞—Ö. –£–ª—É—á—à–∞–µ—Ç—Å—è –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏–µ, –ø–æ–≤—ã—à–∞–µ—Ç—Å—è —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –∏–Ω—Å—É–ª–∏–Ω—É. –û—Ä–≥–∞–Ω–∏–∑–º –Ω–∞–∫–∞–ø–ª–∏–≤–∞–µ—Ç —ç–Ω–µ—Ä–≥–∏—é –∏ –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –≤–æ–∑–º–æ–∂–Ω–æ–π –æ–≤—É–ª—è—Ü–∏–∏. –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤—ã—Ä–∞–±–æ—Ç–∫–∞ —Å–µ—Ä–æ—Ç–æ–Ω–∏–Ω–∞, —á—Ç–æ —É–ª—É—á—à–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ.',
                    impact: '–£ —Ç–µ–±—è –ø–æ–≤—ã—à–∞–µ—Ç—Å—è —É—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏, —Ç—ã –º–æ–∂–µ—à—å —Å–º–µ–ª–æ –±–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∂–∞—Ç—å —Å–µ–±—è –∏ –∏–¥—Ç–∏ –≤ –±–æ–ª—å—à–∏–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –¢—ã —á—É–≤—Å—Ç–≤—É–µ—à—å —Å–µ–±—è –±–æ–ª–µ–µ —É–≤–µ—Ä–µ–Ω–Ω–æ–π, –∫—Ä–µ–∞—Ç–∏–≤–Ω–æ–π –∏ –≥–æ—Ç–æ–≤–æ–π –∫ –Ω–æ–≤—ã–º –≤—ã–∑–æ–≤–∞–º. –≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ü–µ–ª–µ–π –∏ –Ω–∞—á–∞–ª–∞ –Ω–æ–≤—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.',
                    activities: [
                        'üí™ –°–∏–ª–æ–≤—ã–µ',
                        'üèÉ‚Äç‚ôÄÔ∏è –ö–∞—Ä–¥–∏–æ',
                        'üíÉ –¢–∞–Ω—Ü—ã',
                        'üßó‚Äç‚ôÄÔ∏è –ô–æ–≥–∞',
                        'üéØ –ì—Ä—É–ø–ø–æ–≤—ã–µ'
                    ]
                },
                'üí™': {
                    description: '–û–≤—É–ª—è—Ç–æ—Ä–Ω–∞—è —Ñ–∞–∑–∞',
                    bodyChanges: '–£—Ä–æ–≤–µ–Ω—å —ç—Å—Ç—Ä–æ–≥–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç –ø–∏–∫–∞, –∞ –ª—é—Ç–µ–∏–Ω–∏–∑–∏—Ä—É—é—â–∏–π –≥–æ—Ä–º–æ–Ω (–õ–ì) —Ä–µ–∑–∫–æ –ø–æ–≤—ã—à–∞–µ—Ç—Å—è, –∑–∞–ø—É—Å–∫–∞—è –æ–≤—É–ª—è—Ü–∏—é. –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤—ã—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ—Å—Ç–æ—Å—Ç–µ—Ä–æ–Ω–∞, —á—Ç–æ —É–ª—É—á—à–∞–µ—Ç –º—ã—à–µ—á–Ω—É—é —Å–∏–ª—É –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å. –û—Ä–≥–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –º–æ—â–Ω–æ—Å—Ç–∏ - —É–ª—É—á—à–∞–µ—Ç—Å—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è, —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ –∏ –º—ã—à–µ—á–Ω–∞—è —Å–∏–ª–∞.',
                    impact: '–£ —Ç–µ–±—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è, –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è. –¢—ã –º–æ–∂–µ—à—å —Å–º–µ–ª–æ –∏–¥—Ç–∏ –Ω–∞ —Ä–µ–∫–æ—Ä–¥—ã –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏. –≠—Ç–æ –∏–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ä–µ–∫–æ—Ä–¥–æ–≤, —É—á–∞—Å—Ç–∏—è –≤ —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è—Ö –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–¥–∞—á.',
                    activities: [
                        'üèãÔ∏è‚Äç‚ôÄÔ∏è –ú–∞–∫—Å–∏–º—É–º',
                        'üéæ –ò–≥—Ä—ã',
                        'üèÉ‚Äç‚ôÄÔ∏è –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã',
                        'üí™ –ö—Ä–æ—Å—Å—Ñ–∏—Ç',
                        'üéØ –°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è'
                    ]
                },
                'üßò': {
                    description: '–õ—é—Ç–µ–∏–Ω–æ–≤–∞—è —Ñ–∞–∑–∞',
                    bodyChanges: '–£—Ä–æ–≤–µ–Ω—å –ø—Ä–æ–≥–µ—Å—Ç–µ—Ä–æ–Ω–∞ –≤—ã—Å–æ–∫–∏–π, –∞ —ç—Å—Ç—Ä–æ–≥–µ–Ω –Ω–∞—á–∏–Ω–∞–µ—Ç —Å–Ω–∏–∂–∞—Ç—å—Å—è. –ü—Ä–æ–≥–µ—Å—Ç–µ—Ä–æ–Ω —Ä–∞—Å—Å–ª–∞–±–ª—è–µ—Ç –º—ã—à—Ü—ã –∏ –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –∂–∏–¥–∫–æ—Å—Ç–∏. –û—Ä–≥–∞–Ω–∏–∑–º –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –≤–æ–∑–º–æ–∂–Ω–æ–π –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏, —Ç—Ä–∞—Ç–∏—Ç –º–Ω–æ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏ –Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ —ç–Ω–¥–æ–º–µ—Ç—Ä–∏—è. –ú–æ–∂–µ—Ç –ø–æ–≤—ã—à–∞—Ç—å—Å—è –±–∞–∑–∞–ª—å–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ —Ç–µ–ª–∞.',
                    impact: '–£ —Ç–µ–±—è –º–æ–∂–µ—Ç —Å–Ω–∏–∂–∞—Ç—å—Å—è —É—Ä–æ–≤–µ–Ω—å —ç–Ω–µ—Ä–≥–∏–∏, –ø–æ—è–≤–ª—è—Ç—å—Å—è —É—Å—Ç–∞–ª–æ—Å—Ç—å, —Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø–æ–≤—ã—à–µ–Ω–Ω–∞—è —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å –∏ —Ç—è–≥–∞ –∫ —É–≥–ª–µ–≤–æ–¥–∞–º. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! –¢–≤–æ–π –æ—Ä–≥–∞–Ω–∏–∑–º –≥–æ—Ç–æ–≤–∏—Ç—Å—è –∫ –≤–æ–∑–º–æ–∂–Ω–æ–π –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–∞—Ç–∏—Ç –º–Ω–æ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏.',
                    activities: [
                        'üßò‚Äç‚ôÄÔ∏è –ú—è–≥–∫–∞—è –π–æ–≥–∞',
                        'üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏',
                        'üèä‚Äç‚ôÄÔ∏è –ü–ª–∞–≤–∞–Ω–∏–µ',
                        'üé® –¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ',
                        'üò¥ –û—Ç–¥—ã—Ö'
                    ]
                }
            };
            
            return phaseData[phaseIcon] || phaseData['üßò'];
        }
        
        // ===== –ù–ê–í–ò–ì–ê–¶–ò–Ø =====
        function showSection(sectionName) {
            // –°–∫—Ä—ã—Ç—å –≤—Å–µ —Å–µ–∫—Ü–∏–∏
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑–∞—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
            document.getElementById(`${sectionName}-section`).classList.add('active');
            
            // –û–±–Ω–æ–≤–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ù–∞–π—Ç–∏ –∫–Ω–æ–ø–∫—É –ø–æ onclick –∞—Ç—Ä–∏–±—É—Ç—É –∏ —Å–¥–µ–ª–∞—Ç—å –µ—ë –∞–∫—Ç–∏–≤–Ω–æ–π
            const activeButton = document.querySelector(`button[onclick="showSection('${sectionName}')"]`);
            if (activeButton) {
                activeButton.classList.add('active');
            }

            // –ï—Å–ª–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ–º —Ä–∞–∑–¥–µ–ª "–¢—Ä–µ–∫–µ—Ä", –ø–µ—Ä–µ—Ä–∏—Å—É–µ–º –≥—Ä–∞—Ñ–∏–∫ –ø–æ–¥ –∞–∫—Ç–∏–≤–Ω—ã–π –ø–µ—Ä–∏–æ–¥
            if (sectionName === 'tracker') {
                const active = document.querySelector('.chart-period-btn.active');
                const period = (active && active.dataset && active.dataset.period) || 'weeks';
                updateChart(period);
            } else if (sectionName === 'cycle') {
                // –ü—Ä–∏ –≤—Ö–æ–¥–µ –≤–æ –≤–∫–ª–∞–¥–∫—É "–¶–∏–∫–ª" –æ–±–Ω–æ–≤–∏–º —Ñ–∞–∑—É –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è
                updateCyclePhase();
            }
        }
        
        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            loadProfile();
            updateTotal();
            updateTrackerStats();
            updateWeekDisplay();
            updateChart('weeks');
            // –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–µ–¥–µ–ª—è–º–∏
            const prevBtn = document.querySelector('.week-btn.prev');
            const nextBtn = document.querySelector('.week-btn.next');
            if (prevBtn) prevBtn.onclick = () => { currentWeekStart.setDate(currentWeekStart.getDate() - 7); updateWeekDisplay(); };
            if (nextBtn) nextBtn.onclick = () => { currentWeekStart.setDate(currentWeekStart.getDate() + 7); updateWeekDisplay(); };
            // –ö–ª–∏–∫ –ø–æ –ø–æ–¥—Å–∫–∞–∑–∫–µ —Ñ–∞–∑—ã ‚Äî –ø–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ—Ñ–∏–ª—å –∏ –ø—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –∫ –±–ª–æ–∫—É
            const hint = document.getElementById('cycleHint');
            if (hint) hint.onclick = () => { showSection('cycle'); };
            // –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –ø–æ –∏–∫–æ–Ω–∫–µ –≤ —à–∞–ø–∫–µ
            const openProfile = document.getElementById('profile-open');
            if (openProfile) openProfile.onclick = () => { showSection('profile'); };
            const fab = document.getElementById('profile-fab');
            if (fab) fab.onclick = () => { showSection('profile'); };
            const savedMood = localStorage.getItem('currentMood');
            if (savedMood) {
                const moodButton = document.querySelector(`button[onclick=\"setMood('${savedMood}', event)\"]`);
                if (moodButton) {
                    moodButton.classList.add('ring-2', 'ring-accent');
                }
            }
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ
            document.addEventListener('click', (e) => {
                const portal = document.getElementById('activity-suggestions-portal');
                if (!portal) return;
                const clickedPlus = e.target.closest('button[id$="-plus-btn"]');
                const clickedInsidePortal = portal.contains(e.target);
                if (!clickedPlus && !clickedInsidePortal) {
                    portal.classList.add('hidden');
                }
            });
            // –†–µ–Ω–¥–µ—Ä –∫–∞—Ä—É—Å–µ–ª–∏ –Ω–∞—É–∫–∏
            try { renderAboutCarousel(); } catch(e) {}
            console.log('BodyWeek –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!');
        });
        // –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏: —Å–∫—Ä–æ–ª–ª—ã –∏ CTA
        document.addEventListener('click', (e) => {
            if (e.target && e.target.id === 'about-scroll') {
                const facts = document.getElementById('about-facts');
                if (facts) facts.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
            if (e.target && e.target.id === 'about-cta') {
                showSection('tracker');
                // –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ –Ω–∞—á–∞–ª—É –≥—Ä–∞—Ñ–∏–∫–∞/–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è
            }
        });

        // –†–æ—Ç–∞—Ü–∏—è —Ñ–∞–∫—Ç–æ–≤ –≤ "–ù–∞—É–∫–µ"
        const aboutFacts = [
            '10 –º–∏–Ω—É—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –¥–µ–Ω—å —Å–Ω–∏–∂–∞—é—Ç —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å –∏ —É–ª—É—á—à–∞—é—Ç —Å–æ–Ω (NHS, Sleep Foundation).',
            '–ù–µ–±–æ–ª—å—à–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è —É–º–µ–Ω—å—à–∞—é—Ç —Ä–∏—Å–∫ –¥–µ–ø—Ä–µ—Å—Å–∏–∏ (WHO).',
            '–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å —Ñ–∞–∑–∞–º–∏ —Ü–∏–∫–ª–∞, –ø–æ–≤—ã—à–∞—é—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ —Å—Ç—Ä–µ—Å—Å—É (Frontiers in Physiology).',
            '–ö–æ—Ä–æ—Ç–∫–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –¥–Ω—è —É–ª—É—á—à–∞—é—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–∞–∫ –∂–µ, –∫–∞–∫ –¥–ª–∏–Ω–Ω—ã–µ (–º–µ—Ç–∞‚Äë–∞–Ω–∞–ª–∏–∑).',
            '–£–º–µ—Ä–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–≤—ã—à–∞–µ—Ç –∫–æ–≥–Ω–∏—Ç–∏–≤–Ω—É—é –≥–∏–±–∫–æ—Å—Ç—å –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—é (JAMA).',
            '–ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ö–æ–¥—å–±–∞ —Å–≤—è–∑–∞–Ω–∞ —Å —Å–Ω–∏–∂–µ–Ω–∏–µ–º —Å—Ç—Ä–µ—Å—Å–∞ –∏ —É–ª—É—á—à–µ–Ω–∏–µ–º —Å–Ω–∞ (Harvard Health).',
            '–†–µ–≥—É–ª—è—Ä–Ω–∞—è —Ä–∞—Å—Ç—è–∂–∫–∞ —Å–Ω–∏–∂–∞–µ—Ç –º—ã—à–µ—á–Ω–æ–µ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –∏ —Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å (Scandinavian Journal of Medicine & Science in Sports).',
            '–ü—Ä–∞–∫—Ç–∏–∫–∏ –¥—ã—Ö–∞–Ω–∏—è —É–º–µ–Ω—å—à–∞—é—Ç —Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –º–∞—Ä–∫–µ—Ä—ã —Å—Ç—Ä–µ—Å—Å–∞ –∑–∞ 5‚Äì10 –º–∏–Ω—É—Ç (PNAS).',
            '–°–æ–Ω —É–ª—É—á—à–∞–µ—Ç—Å—è –ø—Ä–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ–π —É–º–µ—Ä–µ–Ω–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –¥–∞–∂–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–µ—Å–∞ (Sleep Medicine Reviews).',
            '–î–∞–∂–µ –ª—ë–≥–∫–∞—è –π–æ–≥–∞ –ø–æ–≤—ã—à–∞–µ—Ç –≤–∞—Ä–∏–∞–±–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Ä–¥–µ—á–Ω–æ–≥–æ —Ä–∏—Ç–º–∞ ‚Äî –º–∞—Ä–∫–µ—Ä —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ –∫ —Å—Ç—Ä–µ—Å—Å—É (Frontiers in Neuroscience).',
            '–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ –ø—Ä–∏—Ä–æ–¥–µ —Å–Ω–∏–∂–∞—é—Ç –∫–æ—Ä—Ç–∏–∑–æ–ª –∑–∞–º–µ—Ç–Ω–µ–µ, —á–µ–º –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏ (Environmental Research).',
            '–ú–∏–Ω–∏‚Äë–ø–µ—Ä–µ—Ä—ã–≤—ã —Å –¥–≤–∏–∂–µ–Ω–∏–µ–º –ø–æ–≤—ã—à–∞—é—Ç –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ —É–º–µ–Ω—å—à–∞—é—Ç —É—Å—Ç–∞–ª–æ—Å—Ç—å (Occupational Health).',
            '–†–µ–≥—É–ª—è—Ä–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫ —Å–µ—Ä–¥–µ—á–Ω–æ‚Äë—Å–æ—Å—É–¥–∏—Å—Ç—ã—Ö —Å–æ–±—ã—Ç–∏–π (Lancet).',
            '–ù–µ–±–æ–ª—å—à–∏–µ, –Ω–æ —á–∞—Å—Ç—ã–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è —É–ª—É—á—à–∞—é—Ç –º–µ—Ç–∞–±–æ–ª–∏–∑–º –≥–ª—é–∫–æ–∑—ã (Diabetes Care).',
            '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Å —Ü–∏–∫–ª–æ–º –º–æ–∂–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–∏–ª—É –∏ –≤—ã–Ω–æ—Å–ª–∏–≤–æ—Å—Ç—å (Sports Medicine).',
            '–û—Å–æ–∑–Ω–∞–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –º–µ–¥–∏—Ç–∞—Ü–∏—è –≤–º–µ—Å—Ç–µ —Å–∏–ª—å–Ω–µ–µ —Å–Ω–∏–∂–∞—é—Ç —Å—Ç—Ä–µ—Å—Å (Clinical Psychology Review).'
        ];
        let aboutFactIdx = 0;
        document.addEventListener('click', (e) => {
            if (e.target && e.target.id === 'scienceCard') {
                const card = e.target;
                card.classList.add('fade');
                setTimeout(() => {
                    aboutFactIdx = (aboutFactIdx + 1) % aboutFacts.length;
                    card.textContent = aboutFacts[aboutFactIdx];
                    card.classList.remove('fade');
                }, 180);
            }
        });

        // ===== –ö–∞–∫ —Ç—ã —Å–µ–≥–æ–¥–Ω—è? (–º–∏–Ω–∏-–¥–∏–∞–ª–æ–≥) =====
        const TODAY_KEY = 'bodyweek-today';
        let __todayFlow = { mood: null, time: null, extra: {} };

        function loadTodayFromStorage() {
            try {
                const raw = localStorage.getItem(TODAY_KEY);
                if (!raw) return;
                const saved = JSON.parse(raw);
                if (!saved || !saved.mood) return;
                const savedDate = new Date(saved.date);
                const today = new Date();
                savedDate.setHours(0,0,0,0);
                today.setHours(0,0,0,0);
                if (savedDate.getTime() !== today.getTime()) return;
                renderTodayRecommendation(saved.recommendation, saved.mood, saved.suggestedActivity);
            } catch (e) {}
        }

        function startTodayFlow(mood, event) {
             __todayFlow = { mood, time: null, extra: {} };
             localStorage.setItem(TODAY_KEY, JSON.stringify({ mood, date: new Date().toISOString() }));
             // Highlight selected mood button
            document.querySelectorAll('button[onclick^="startTodayFlow"]').forEach(btn => btn.classList.remove('active'));
            if (event && event.currentTarget) event.currentTarget.classList.add('active');
             renderTimeQuestion();
         }

        function renderTimeQuestion() {
             const box = document.getElementById('today-questions');
             const recoBox = document.getElementById('today-reco');
             if (!box) return;
             recoBox?.classList.add('hidden');
             recoBox.innerHTML = '';
             box.classList.remove('hidden');
             box.innerHTML = `
                 <div class=\"bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-2\">
                     <div class=\"text-sm font-semibold text-text\">–°–∫–æ–ª—å–∫–æ —É —Ç–µ–±—è –µ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏?</div>
                     <div class=\"flex flex-wrap gap-2\">
                         <button class=\"bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm\" onclick=\"chooseTodayTime('5')\">5 –º–∏–Ω</button>
                         <button class=\"bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm\" onclick=\"chooseTodayTime('10-15')\">10‚Äì15 –º–∏–Ω</button>
                         <button class=\"bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm\" onclick=\"chooseTodayTime('20-30')\">20‚Äì30 –º–∏–Ω</button>
                         <button class=\"bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm\" onclick=\"chooseTodayTime('60')\">1 —á–∞—Å</button>
                     </div>
                 </div>`;
         }

        function chooseTodayTime(val) {
            __todayFlow.time = val;
            const savedRaw = JSON.parse(localStorage.getItem(TODAY_KEY) || '{}');
            localStorage.setItem(TODAY_KEY, JSON.stringify({ ...savedRaw, time: val }));
            // Highlight selected time button
            const container = document.getElementById('today-questions');
            if (container) {
                container.querySelectorAll('button').forEach(b => b.classList.remove('active'));
                const target = Array.from(container.querySelectorAll('button')).find(b => b.textContent.includes(val === '5' ? '5' : (val === '10-15' ? '10' : (val === '60' ? '1 —á–∞—Å' : '20'))));
                if (target) target.classList.add('active');
            }
            renderExtraQuestions();
        }

        function renderExtraQuestions() {
            const mood = __todayFlow.mood;
            const box = document.getElementById('today-questions');
            if (!box) return;
            let content = '';
            if (mood === 'bad') {
                content = `
                    <div class="bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-3">
                        <div class="text-sm font-semibold text-text">–ö–∞–∫ —Å–æ —Å–Ω–æ–º?</div>
                        <div class="flex flex-wrap gap-2">
                            ${['<6—á','6‚Äì7—á','7‚Äì8—á','>8—á'].map((t,i)=>`<label class=\"inline-flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm cursor-pointer\"><input type=\"radio\" name=\"sleep\" value=\"${t}\" class=\"accent-pink-500\"> ${t}</label>`).join('')}
                        </div>
                        <div class="text-sm font-semibold text-text">–°—Ç—Ä–µ—Å—Å?</div>
                        <div class="flex flex-wrap gap-2">
                            ${['–Ω–∏–∑–∫–∏–π','—Å—Ä–µ–¥–Ω–∏–π','–≤—ã—Å–æ–∫–∏–π'].map((t,i)=>`<label class=\"inline-flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm cursor-pointer\"><input type=\"radio\" name=\"stress\" value=\"${t}\" class=\"accent-pink-500\"> ${t}</label>`).join('')}
                        </div>
                        <div class="flex justify-end"><button class="btn-primary py-2 px-4" onclick="finishTodayFlow()">–ì–æ—Ç–æ–≤–æ</button></div>
                    </div>`;
            } else if (mood === 'ok') {
                content = `
                    <div class="bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-2">
                        <div class="text-sm font-semibold text-text">–¶–µ–ª—å –Ω–∞ —Å–µ–π—á–∞—Å?</div>
                        <div class="flex flex-wrap gap-2">
                            ${['—Ä–∞—Å—Å–ª–∞–±–∏—Ç—å—Å—è','–≤–∑–±–æ–¥—Ä–∏—Ç—å—Å—è','—É–∫—Ä–µ–ø–∏—Ç—å —Ç–µ–ª–æ'].map((t)=>`<label class=\"inline-flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm cursor-pointer\"><input type=\"radio\" name=\"goal\" value=\"${t}\" class=\"accent-pink-500\"> ${t}</label>`).join('')}
                        </div>
                        <div class="flex justify-end"><button class="btn-primary py-2 px-4" onclick="finishTodayFlow()">–ì–æ—Ç–æ–≤–æ</button></div>
                    </div>`;
            } else {
                content = `
                    <div class="bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-2">
                        <div class="text-sm font-semibold text-text">–¶–µ–ª—å –Ω–∞ —Å–µ–π—á–∞—Å?</div>
                        <div class="flex flex-wrap gap-2">
                            ${['–≤–∑–±–æ–¥—Ä–∏—Ç—å—Å—è','—É–∫—Ä–µ–ø–∏—Ç—å —Ç–µ–ª–æ','–º—è–≥–∫–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å'].map((t)=>`<label class=\"inline-flex items-center gap-2 bg-gray-50 px-3 py-2 rounded-xl border border-gray-200 text-sm cursor-pointer\"><input type=\"radio\" name=\"goal\" value=\"${t}\" class=\"accent-pink-500\"> ${t}</label>`).join('')}
                        </div>
                        <div class="flex justify-end"><button class="btn-primary py-2 px-4" onclick="finishTodayFlow()">–ì–æ—Ç–æ–≤–æ</button></div>
                    </div>`;
            }
            box.innerHTML = content;
        }

        function getPhaseBias() {
            const icon = window.__currentPhaseIcon || '';
            if (icon === 'ü©∏' || icon === 'üßò') return 'gentle';
            if (icon === 'üíÉ' || icon === 'üí™') return 'intense';
            return 'neutral';
        }

        function buildTodayRecommendation() {
            const { mood, time } = __todayFlow;
            const goal = document.querySelector('input[name=\"goal\"]:checked')?.value || null;
            const sleep = document.querySelector('input[name=\"sleep\"]:checked')?.value || null;
            const stress = document.querySelector('input[name=\"stress\"]:checked')?.value || null;
            __todayFlow.extra = { goal, sleep, stress };
 
            let suggestedActivity = 'üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è';
            let text = '';
            const timeText = time === '5' ? '5 –º–∏–Ω—É—Ç' : (time === '10-15' ? '10‚Äì15 –º–∏–Ω—É—Ç' : (time === '60' ? '1 —á–∞—Å' : '20‚Äì30 –º–∏–Ω—É—Ç'));
            const bias = getPhaseBias();
            let suggestions = [];
 
            if (mood === 'bad') {
                if (sleep === '<6—á') {
                    suggestedActivity = 'üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è';
                    text = `–°–µ–≥–æ–¥–Ω—è –º–∞–ª–æ —Å–Ω–∞ ‚Äî —Å–¥–µ–ª–∞–π –ª—ë–≥–∫–æ–µ –¥—ã—Ö–∞–Ω–∏–µ/–º–µ–¥–∏—Ç–∞—Ü–∏—é –Ω–∞ ${timeText} –∏ –ø–æ—Å—Ç–∞—Ä–∞–π—Å—è –ª–µ—á—å –ø–æ—Ä–∞–Ω—å—à–µ.`;
                    suggestions = ['üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è','üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞','üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏'];
                } else if (stress === '–≤—ã—Å–æ–∫–∏–π') {
                    suggestedActivity = 'üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞';
                    text = `–°—Ç—Ä–µ—Å—Å –≤—ã—Å–æ–∫–∏–π ‚Äî –º—è–≥–∫–∞—è –π–æ–≥–∞/—Ä–∞—Å—Ç—è–∂–∫–∞ –Ω–∞ ${timeText} –ø–æ–º–æ–∂–µ—Ç —Ä–∞–∑–≥—Ä—É–∑–∏—Ç—å –≥–æ–ª–æ–≤—É.`;
                    suggestions = ['üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞','üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è','üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏'];
                } else {
                    suggestedActivity = (time === '20-30' && bias !== 'gentle') ? 'üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏' : 'üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞';
                    text = `–õ—É—á—à–µ –º—è–≥–∫–æ: ${time === '20-30' || time === '60' ? '–ø—Ä–æ–≥—É–ª–∫–∞' : '—Ä–∞—Å—Ç—è–∂–∫–∞'} –Ω–∞ ${timeText}.`;
                    suggestions = ['üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞','üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏','üò¥ –û—Ç–¥—ã—Ö'];
                }
            } else if (mood === 'ok') {
                if (goal === '–≤–∑–±–æ–¥—Ä–∏—Ç—å—Å—è') {
                    suggestedActivity = bias === 'gentle' ? '‚ù§Ô∏è –ö–∞—Ä–¥–∏–æ' : 'üèÉ‚Äç‚ôÄÔ∏è –ë–µ–≥';
                    text = `–î–æ–±–∞–≤—å –Ω–µ–º–Ω–æ–≥–æ —ç–Ω–µ—Ä–≥–∏–∏: ${time === '5' ? '–∫–æ—Ä–æ—Ç–∫–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã' : '–∏–Ω—Ç–µ—Ä–≤–∞–ª—ã/–±–µ–≥'} –Ω–∞ ${timeText}.`;
                    suggestions = [suggestedActivity,'üíÉ –¢–∞–Ω—Ü—ã','üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏'];
                } else if (goal === '—É–∫—Ä–µ–ø–∏—Ç—å —Ç–µ–ª–æ') {
                    suggestedActivity = bias === 'gentle' ? 'üßò‚Äç‚ôÄÔ∏è –ü–∏–ª–∞—Ç–µ—Å' : (time === '60' ? 'üí™ –°–∏–ª–æ–≤–∞—è' : 'üí™ –°–∏–ª–æ–≤–∞—è');
                    text = `–°–¥–µ–ª–∞–π ${time === '5' ? '–º–∏–Ω–∏–∫–æ–º–ø–ª–µ–∫—Å' : '–∫–æ—Ä–æ—Ç–∫—É—é —Å–∏–ª–æ–≤—É—é'} –Ω–∞ ${timeText} ‚Äî –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∞.`;
                    suggestions = [suggestedActivity,'üßò‚Äç‚ôÄÔ∏è –ü–∏–ª–∞—Ç–µ—Å','‚ù§Ô∏è –ö–∞—Ä–¥–∏–æ'];
                } else {
                    suggestedActivity = 'üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞';
                    text = `–õ—ë–≥–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞: –π–æ–≥–∞/—Ä–∞—Å—Ç—è–∂–∫–∞ –Ω–∞ ${timeText}.`;
                    suggestions = ['üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞','üßò –ú–µ–¥–∏—Ç–∞—Ü–∏—è','üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏'];
                }
            } else {
                if (goal === '–≤–∑–±–æ–¥—Ä–∏—Ç—å—Å—è') {
                    suggestedActivity = bias === 'gentle' ? '‚ù§Ô∏è –ö–∞—Ä–¥–∏–æ' : 'üèÉ‚Äç‚ôÄÔ∏è –ë–µ–≥';
                    text = `–ë–æ–¥—Ä–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ ‚Äî –º–æ–∂–Ω–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –Ω–∞ ${timeText}.`;
                    suggestions = [suggestedActivity,'üíÉ –¢–∞–Ω—Ü—ã','üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏'];
                } else if (goal === '—É–∫—Ä–µ–ø–∏—Ç—å —Ç–µ–ª–æ') {
                    suggestedActivity = bias === 'gentle' ? 'üßò‚Äç‚ôÄÔ∏è –ü–∏–ª–∞—Ç–µ—Å' : (time === '60' ? 'üí™ –°–∏–ª–æ–≤–∞—è' : 'üí™ –°–∏–ª–æ–≤–∞—è');
                    text = `–û—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è —Å–∏–ª–æ–≤–æ–π –Ω–∞ ${timeText}.`;
                    suggestions = [suggestedActivity,'üßò‚Äç‚ôÄÔ∏è –ü–∏–ª–∞—Ç–µ—Å','‚ù§Ô∏è –ö–∞—Ä–¥–∏–æ'];
                } else {
                    suggestedActivity = 'üßò‚Äç‚ôÄÔ∏è –ü–∏–ª–∞—Ç–µ—Å';
                    text = `–ú—è–≥–∫–æ –∑–∞–∫—Ä–µ–ø–∏—Ç—å ‚Äî –ø–∏–ª–∞—Ç–µ—Å/–π–æ–≥–∞ –Ω–∞ ${timeText}.`;
                    suggestions = ['üßò‚Äç‚ôÄÔ∏è –ü–∏–ª–∞—Ç–µ—Å','üßò‚Äç‚ôÄÔ∏è –ô–æ–≥–∞','üö∂‚Äç‚ôÄÔ∏è –ü—Ä–æ–≥—É–ª–∫–∏'];
                }
            }
            if (!suggestions.length) suggestions = [suggestedActivity];
            return { text, suggestedActivity, suggestions };
        }

        function finishTodayFlow() {
            const { text, suggestedActivity, suggestions } = buildTodayRecommendation();
            const payload = { ...__todayFlow, recommendation: text, suggestedActivity, suggestions, date: new Date().toISOString() };
            localStorage.setItem(TODAY_KEY, JSON.stringify(payload));
            renderTodayRecommendation(text, __todayFlow.mood, suggestedActivity, suggestions);
        }

        function renderTodayRecommendation(text, mood, suggestedActivity, suggestions=[]) {
            const q = document.getElementById('today-questions');
            const box = document.getElementById('today-reco');
            if (!box) return;
            q?.classList.add('hidden');
            q.innerHTML = '';
            box.classList.remove('hidden');
            const chips = (suggestions && suggestions.length ? suggestions : [suggestedActivity]).map(a => `
                <button class=\"px-3 py-1.5 bg-gray-50 border border-gray-200 rounded-full text-sm\" onclick=\"goAddToWeek('${a}')\">${a}</button>
            `).join(' ');
            box.innerHTML = `
                <div class="bg-white border border-gray-100 rounded-2xl p-3 shadow-sm space-y-3">
                    <div class="text-sm font-semibold text-text">–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</div>
                    <div class="text-sm text-gray-800">${text}</div>
                    <div class="flex flex-wrap gap-2">${chips}</div>
                    <div class="flex justify-end">
                        <button class="btn-primary py-2 px-4" onclick="goAddToWeek('${(suggestions && suggestions[0]) || suggestedActivity || ''}')">–î–æ–±–∞–≤–∏—Ç—å –≤ –Ω–µ–¥–µ–ª—é</button>
                    </div>
                </div>`;
        }

        function goAddToWeek(suggestedActivity) {
            showSection('week');
            const firstPlus = document.querySelector('[id$="-plus-btn"]');
            if (firstPlus) {
                const btnId = firstPlus.id || '';
                const day = btnId.replace('-plus-btn','');
                firstPlus.scrollIntoView({ behavior: 'smooth', block: 'center' });
                firstPlus.classList.add('ring-2','ring-accent');
                setTimeout(() => firstPlus.classList.remove('ring-2','ring-accent'), 1200);
                // –û—Ç–∫—Ä–æ–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –∏ –ø–æ–¥—Å—Ç–∞–≤–∏–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
                if (day) {
                    toggleActivityInput(day);
                    const inputField = document.getElementById(`${day}-activity-field`);
                    if (inputField && suggestedActivity) {
                        inputField.value = suggestedActivity;
                        inputField.focus();
                    }
                }
            }
        }

        // –ö–∞—Ä—É—Å–µ–ª—å —Ñ–∞–∫—Ç–æ–≤ "–ù–∞—É–∫–∞": –æ—Ç—Ä–∏—Å–æ–≤–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∏ —Ç–æ—á–∫–∏
        function renderAboutCarousel() {
            const wrap = document.getElementById('about-carousel');
            const dots = document.getElementById('about-dots');
            if (!wrap || !dots || !Array.isArray(aboutFacts)) return;
            wrap.innerHTML = '';
            dots.innerHTML = '';
            const items = aboutFacts.slice(0, 8);
            items.forEach((fact, idx) => {
                const el = document.createElement('div');
                el.className = 'about-science-item';
                el.textContent = fact;
                wrap.appendChild(el);
                const dot = document.createElement('span');
                dot.style.width = '6px'; dot.style.height = '6px'; dot.style.borderRadius = '999px';
                dot.style.background = idx === 0 ? '#D14E9E' : '#E5E7EB';
                dot.style.display = 'inline-block';
                dots.appendChild(dot);
            });
            // –û–±–Ω–æ–≤–ª—è—Ç—å –∞–∫—Ç–∏–≤–Ω—É—é —Ç–æ—á–∫—É –ø–æ —Å–∫—Ä–æ–ª–ª—É ‚Äî –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏
            wrap.addEventListener('scroll', () => {
                const children = Array.from(wrap.children);
                const center = wrap.scrollLeft + wrap.clientWidth / 2;
                let active = 0;
                children.forEach((child, i) => {
                    const rectLeft = child.offsetLeft;
                    const rectCenter = rectLeft + child.clientWidth / 2;
                    if (Math.abs(rectCenter - center) < Math.abs((children[active].offsetLeft + children[active].clientWidth/2) - center)) {
                        active = i;
                    }
                });
                Array.from(dots.children).forEach((d, i) => {
                    d.style.background = i === active ? '#D14E9E' : '#E5E7EB';
                });
            });
        }

        // ===== –ü–û–õ–ò–¢–ò–ö–ê –ö–û–ù–§–ò–î–ï–ù–¶–ò–ê–õ–¨–ù–û–°–¢–ò =====
        function openPrivacy() {
            const m = document.getElementById('privacy-modal');
            if (m) m.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }
        function closePrivacy() {
            const m = document.getElementById('privacy-modal');
            if (m) m.classList.add('hidden');
            document.body.style.overflow = '';
        }

        // –ö–∞—Ä—Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π –ø–æ –¥–∞—Ç–∞–º
        function getActivitiesMap() {
            try { return JSON.parse(localStorage.getItem(ACTIVITIES_KEY)) || {}; }
            catch { return {}; }
        }

        // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            try { saveData(); } catch(e) {}
        });
    </script>

    <!-- Privacy Policy Modal -->
    <div id="privacy-modal" class="fixed inset-0 bg-black/40 hidden z-[70]">
        <div class="absolute inset-0" onclick="closePrivacy()"></div>
        <div class="relative max-w-2xl w-[92%] sm:w-[600px] max-h-[70vh] bg-white rounded-2xl shadow-xl mx-auto mt-16 overflow-hidden">
            <button class="absolute top-3 right-3 text-gray-500 text-xl" onclick="closePrivacy()">√ó</button>
            <div class="p-5 overflow-y-auto" style="max-height: calc(70vh - 88px);">
                <h2 class="text-xl font-extrabold text-text mb-3">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</h2>
                <div class="space-y-3 text-sm text-gray-800 leading-relaxed">
                    <p><strong>–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</strong></p>
                    <p>–ù–∞—Å—Ç–æ—è—â–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
                    <p><strong>1. –û–ø–µ—Ä–∞—Ç–æ—Ä</strong><br/>–û–ø–µ—Ä–∞—Ç–æ—Ä–æ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —è–≤–ª—è–µ—Ç—Å—è –ö—É–∑—å–º–∏–Ω–∞ –í–∞–ª–µ—Ä–∏—è –ê–Ω—Ç–æ–Ω–æ–≤–Ω–∞, e-mail: valeriyacuzmina@gmail.com.</p>
                    <p><strong>2. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ</strong><br/>–ú—ã —Å–æ–±–∏—Ä–∞–µ–º –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º —Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ: –∏–º—è; –∞–¥—Ä–µ—Å —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–π –ø–æ—á—Ç—ã; –¥–∞–Ω–Ω—ã–µ –æ –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–æ–º —Ü–∏–∫–ª–µ (–Ω–∞—á–∞–ª–æ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –º–µ—Å—è—á–Ω—ã—Ö, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –º–µ–Ω—Å—Ç—Ä—É–∞—Ü–∏–∏, —Å—Ä–µ–¥–Ω—è—è –¥–ª–∏–Ω–∞ —Ü–∏–∫–ª–∞).</p>
                    <p><strong>3. –¶–µ–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏</strong><br/>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ —Ü–µ–ª—è—Ö: –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏; –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è; —Ä–∞—Å—á—ë—Ç–∞ —Ñ–∞–∑ —Ü–∏–∫–ª–∞ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π; –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.</p>
                    <p><strong>4. –ü—Ä–∞–≤–æ–≤–æ–µ –æ—Å–Ω–æ–≤–∞–Ω–∏–µ</strong><br/>–û—Å–Ω–æ–≤–∞–Ω–∏–µ–º –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö —è–≤–ª—è–µ—Ç—Å—è —Å–æ–≥–ª–∞—Å–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–µ –ø—Ä–∏ –≤–≤–æ–¥–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.</p>
                    <p><strong>5. –£—Å–ª–æ–≤–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è</strong><br/>–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –î–∞–Ω–Ω—ã–µ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–¥–∞–ª–∏—Ç—å —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è –≤ —Ä–∞–∑–¥–µ–ª–µ ¬´–ü—Ä–æ—Ñ–∏–ª—å¬ª.</p>
                    <p><strong>6. –ü—Ä–∞–≤–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</strong><br/>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ: –ø–æ–ª—É—á–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö; —Ç—Ä–µ–±–æ–≤–∞—Ç—å —É—Ç–æ—á–Ω–µ–Ω–∏—è, –±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏—è —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö; –æ—Ç–∑—ã–≤–∞—Ç—å —Å–æ–≥–ª–∞—Å–∏–µ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö.</p>
                    <p><strong>7. –ö–æ–Ω—Ç–∞–∫—Ç—ã</strong><br/>–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –¥–∞–Ω–Ω—ã—Ö, –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å: valeriyacuzmina@gmail.com.</p>
                </div>
            </div>
            <div class="p-4 border-t border-gray-100">
                <button class="w-full btn-primary py-3" onclick="closePrivacy()">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</body>
</html>
